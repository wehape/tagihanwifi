/*!
 * JavaScript for PHPMaker v2024.3.0
 * Copyright (c) e.World Technology Limited. All rights reserved.
 */
!function(e,t,n){"use strict";let a=n.DateTime;var i={__proto__:null,between:function(e){let n,a;return e.id.startsWith("y_")?(n=document.getElementById(e.id.replace(/^y_/,"x_")),a=document.getElementById(e.id.replace(/^y_/,"z_"))):e.id.endsWith("_value_1")&&(n=document.getElementById(e.id.replace(/_value_1$/,"_value_0")),a=document.getElementById(e.id.replace(/_value_1$/,"_operator"))),!(!ew.hasValue(n)||"BETWEEN"!=t(a).val().toUpperCase()||ew.hasValue(e))&&{between:ew.language.phrase("EnterValue2")}},captcha:function(e){return!(!e||ew.hasValue(e))&&{captcha:ew.language.phrase("EnterValidateCode")}},creditCard:function(e){let t=ew.getValue(e);return!ew.checkCreditCard(t)&&{creditCard:ew.language.phrase("IncorrectCreditCard")}},custom:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return function(t){if("function"==typeof e){let a=ew.getValue(t);if(e(a,...n))return{custom:ew.language.phrase("IncorrectField")}}return!1}},datetime:function(e){return function(t){let n=ew.getValue(t);return!ew.checkDate(n,e)&&{datetime:ew.language.phrase("IncorrectDate").replace(/%s/g,e)}}},email:function(e){let t=ew.getValue(e);return!ew.checkEmail(t)&&{email:ew.language.phrase("IncorrectEmail")}},emails:function(e,t){return function(n){let a=ew.getValue(n);return!ew.checkEmails(a,e)&&{emails:t}}},fileRequired:function(e){return function(t){let n=document.getElementById("fn_"+t.id);return!(!n||ew.hasValue(n))&&{fileRequired:ew.language.phrase("EnterRequiredField").replace("%s",e)}}},float:function(e){let t=ew.getValue(e);return!ew.checkNumber(t)&&{float:ew.language.phrase("IncorrectFloat")}},guid:function(e){let t=ew.getValue(e);return!ew.checkGuid(t)&&{guid:ew.language.phrase("IncorrectGUID")}},integer:function(e){let t=ew.getValue(e);return!ew.checkInteger(t)&&{integer:ew.language.phrase("IncorrectInteger")}},max:function(e){return function(t){let n,a=ew.parseNumber(ew.getValue(t));return(e="function"==typeof e?e():e)instanceof HTMLElement?n=ew.parseNumber(ew.getValue(e)):"string"==typeof e?n=ew.parseNumber(e):"number"==typeof e&&(n=e),"number"==typeof a&&"number"==typeof n&&a>n&&{max:ew.language.phrase("IncorrectMax").replace("%s",n)}}},maxDate:function(e){return function(t){let n,i=ew.getValue(t),r=t.dataset.formatPattern;if((e="function"==typeof e?e():e)instanceof HTMLElement){let t=e.value,a=e.dataset.formatPattern;e.value&&e.dataset.formatPattern&&(n=ew.parseDate(t,a))}else e instanceof Date?n=a.fromJSDate(e,{zone:"utc"}):e instanceof a&&(n=e);if(i&&r&&n){if(ew.parseDate(i,r)>n)return{maxDate:ew.language.phrase("IncorrectMaxDate").replace("%s",ew.formatDateTime(n,ew.DATE_FORMAT+" "+ew.TIME_FORMAT))}}return!1}},min:function(e){return function(t){let n,a=ew.parseNumber(ew.getValue(t));return(e="function"==typeof e?e():e)instanceof HTMLElement?n=ew.parseNumber(ew.getValue(e)):"string"==typeof e?n=ew.parseNumber(e):"number"==typeof e&&(n=e),"number"==typeof a&&"number"==typeof n&&a<n&&{min:ew.language.phrase("IncorrectMin").replace("%s",n)}}},minDate:function(e){return function(t){let n,i=ew.getValue(t),r=t.dataset.formatPattern;if((e="function"==typeof e?e():e)instanceof HTMLElement){let t=e.value,a=e.dataset.formatPattern;e.value&&e.dataset.formatPattern&&(n=ew.parseDate(t,a))}else e instanceof Date?n=a.fromJSDate(e,{zone:"utc"}):e instanceof a&&(n=e);if(i&&r&&n){if(ew.parseDate(i,r)<n)return{minDate:ew.language.phrase("IncorrectMinDate").replace("%s",ew.formatDateTime(n,ew.DATE_FORMAT+" "+ew.TIME_FORMAT))}}return!1}},mismatchPassword:function(e){let t;e.id.startsWith("c_")?t=e.id.replace(/^c_/,"x_"):"cpwd"==e.id&&(t="npwd");let n=document.getElementById(t);return e.value!==n.value&&{mismatchPassword:ew.language.phrase("MismatchPassword")}},password:function(e){return function(t){return!(e||ew.ENCRYPTED_PASSWORD||!t.value.match(new RegExp("["+ew.escapeRegExChars(ew.INVALID_PASSWORD_CHARACTERS)+"]")))&&{password:ew.language.phrase("InvalidPasswordChars")}}},passwordStrength:function(e){let n=t(e);return!(ew.isMaskedPassword(e)||!n.hasClass("ew-password-strength")||n.data("validated"))&&{passwordStrength:ew.language.phrase("PasswordTooSimple")}},phone:function(e){let t=ew.getValue(e);return!ew.checkPhone(t)&&{phone:ew.language.phrase("IncorrectPhone")}},range:function(e,t){return function(n){let a=ew.getValue(n);return!ew.checkRange(a,e,t)&&{range:ew.language.phrase("IncorrectRange").replace("%1",e).replace("%2",t)}}},recaptcha:function(e){var t;return!(!e||ew.hasValue(e)||""!==(null==(t=grecaptcha)?void 0:t.getResponse(e.dataset.id)))&&{recaptcha:ew.language.phrase("ClickReCaptcha")}},regex:function(e){return function(t){let n=ew.getValue(t);return!ew.checkByRegEx(n,e)&&{regex:ew.language.phrase("IncorrectField")}}},required:function(e){return function(n){var a;let i=t(n),r=i.closest("#r_"+(null==(a=i.data("field"))?void 0:a.substring(2)));return r[0]||(r=i.closest("[id^=el]")),"none"!=r.css("display")&&(!(!n||ew.hasValue(n))&&{required:ew.language.phrase("EnterRequiredField").replace("%s",e)})}},ssn:function(e){let t=ew.getValue(e);return!ew.checkSsn(t)&&{ssn:ew.language.phrase("IncorrectSSN")}},time:function(e){return function(t){let n=ew.getValue(t);return!ew.checkTime(n,e)&&{time:ew.language.phrase("IncorrectTime").replace(/%s/g,e)}}},url:function(e){let t=ew.getValue(e);return!ew.checkUrl(t)&&{url:ew.language.phrase("IncorrectUrl")}},userLevelId:function(e){return e&&!ew.checkInteger(e.value)?{userLevelId:ew.language.phrase("UserLevelIDInteger")}:parseInt(e.value,10)<1&&{userLevelId:ew.language.phrase("UserLevelIDIncorrect")}},userLevelName:function(e){return function(t){let n=document.getElementById("x_"+e);if(n&&t){let e=t.value.trim(),a=parseInt(n.value.trim(),10);if(0===a&&!ew.sameText(e,"Default"))return{userLevelName:ew.language.phrase("UserLevelDefaultName")};if(-1===a&&!ew.sameText(e,"Administrator"))return{userLevelName:ew.language.phrase("UserLevelAdministratorName")};if(-2===a&&!ew.sameText(e,"Anonymous"))return{userLevelName:ew.language.phrase("UserLevelAnonymousName")};if(a>0&&["anonymous","administrator","default"].includes(e.toLowerCase()))return{userLevelName:ew.language.phrase("UserLevelNameIncorrect")}}return!1}},username:function(e){return function(t){return!(e||!t.value.match(new RegExp("["+ew.escapeRegExChars(ew.INVALID_USERNAME_CHARACTERS)+"]")))&&{username:ew.language.phrase("InvalidUsernameChars")}}},zip:function(e){let t=ew.getValue(e);return!ew.checkZip(t)&&{zip:ew.language.phrase("IncorrectZip")}}};function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function l(e){var t=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!==r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===r(t)?t:String(t)}function o(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,l(a.key),a)}}function s(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function u(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,c(e,t)}function p(e,t,n){return(t=l(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}t.batchSettings={type:"POST",contentType:"application/json",processData:!1,dataType:"json",toJSON:JSON.stringify,parse:e=>e},t.batchSetup=function(e){return t.extend(t.batchSettings,e)};var f=t.batch=function(e,n){return this instanceof f?("object"==typeof e&&(n=e,e=void 0),this.options=t.extend({},t.batchSettings,n),this.parent=t.ajaxSetup()._batch,this.requests=[],e&&this.add(e),this):new f(e,n)};t.extend(f.prototype,{add:function(e){var n;return t.ajaxSetup({_batch:this.parent||this}),null!=(n=e.name)&&n.startsWith("bound ")?e():e.call(t.ajaxSetup()._batch),this.parent||t.ajaxSetup({_batch:null}),this},clear:function(){this.requests=[]},send:function(e){e=e||{};var n=this;if(this.parent&&e.success){var a=this.parent.options.success;this.parent.options.success=function(t,n,i){e.success(t,n,i),a&&a(t,n,i)}}else if(this.requests.length){var i=t.map(this.requests,(function(e){return e.settings.data})),r=e.success,l=this.options.success;return e.success=function(e,t,a){n._deliver.call(n,e,t),l&&l(e,t,a),r&&r(e,t,a)},(e=t.extend({},this.options,e)).data||(e.data=t.batchSettings.toJSON(i)),t.ajax(e)}},_addRequest:function(e,t){this.requests.push({xhr:e,settings:t})},_deliver:function(n,a){var i,r,l=this,o=t.batchSettings.parse(n);null!=o&&null!=(i=o.error)&&i.description?e.alert(null==o||null==(r=o.error)?void 0:r.description):t.each(o,(function(e,t){var n;if(l.requests[e]){var i,r=l.requests[e];if(r.xhr.statusText=a,"success"===a)null==(i=r.settings.success)||i.call(r.xhr,t,a);null==(n=r.settings.complete)||n.call(r.xhr,a)}}))}});var h=t.ajax;function g(e,n){let a=this,i=t(a);this._initiated=!1,this.id=e,this.element=document.getElementById(e),this.$element=t(this.element),this.pageId=n,this.htmlForm=null,this.initSearchPanel=!1,this.modified=!1,this.emptyRow=null,this.multiPage=null,this.autoSuggests={},this.lists={},this.batch=new f,this.formKeyCountName="",this.submitWithFetch=!1,this.enableOnInit=!1,this.filterList=null,this.disableForm=function(){document.body.style.cursor="wait";let e=this.getForm();t(e.elements).filter(":submit:not(.dropdown-toggle), .ew-submit").prop("disabled",!0).addClass("disabled"),this.trigger("disabled")},this.enableForm=function(){let e=this.getForm(),n=t(e.elements);n.filter(".ew-disabled-element").removeClass("ew-disabled-element").prop("disabled",!1),n.filter(".ew-enabled-element").removeClass("ew-enabled-element").prop("disabled",!0),n.filter(":submit:not(.dropdown-toggle), .ew-submit").not(".ew-disabled").prop("disabled",!1).removeClass("disabled"),this.trigger("enabled"),document.body.style.cursor="default"},this.appendHidden=function(e){var n=this.getForm(),a=t(n),i=t(e).closest(".ew-form"),r=i.attr("id")+"$"+e.name;if(!a.find("input:hidden[name='"+r+"']")[0]){var l=i.find('[name="'+e.name+'"]').serializeArray();l.length?l.forEach((function(e,n){t('<input type="hidden" name="'+r+'">').val(e.value).appendTo(a)})):t('<input type="hidden" name="'+r+'">').val("").appendTo(a)}},this.canSubmit=async function(e){var n,i,r=this.getForm(),l=t(r);if(this.disableForm(),this.updateTextArea(),null!=(n=await(null==(i=this.validate)?void 0:i.call(this,e)))&&!n||l.find(".is-invalid")[0])this.enableForm();else{l.find("input[name^=sv_], input[name^=p_], [name*=_query_builder_rule_], .ew-template input, .ew-custom-option").prop("disabled",!0).addClass("ew-disabled-element"),l.find("[data-readonly=1][disabled]").prop("disabled",!1).addClass("ew-enabled-element");var o=l.find("input[name=detailpage]").map((function(e,t){return l.find("#"+t.value)[0]}));o.length>1&&o.each((function(e,n){t(n).find(":input").each((function(e,t){if(/^(fn_)?(x|o)\d*_/.test(t.name)){var i=o.not(n).find(":input[name='"+t.name+"']");i.length&&(a.appendHidden(t),i.each((function(){a.appendHidden(this)})))}}))}));let n={form:r,result:!0},i=t.Event("beforesubmit",{originalEvent:e});l.trigger(i,[n]);let s=await n.result;if(!i.isDefaultPrevented()&&(!0===s||t.isObject(s)&&s.value))return!0}return!1},this.submit=async function(e){var n;let a=this.getForm(),i=null==e||null==(n=e.originalEvent)||null==(n=n.submitter)?void 0:n.formAction;if(i&&(i=ew.parseUrl(i).pathname,a.setAttribute("action",i)),await this.canSubmit(e)){if(this.submitWithFetch){let e=a.getAttribute("action"),n=a.method.toUpperCase(),i=t(a).serialize();return ew.fetch(e,{method:n,body:i}).finally((()=>this.enableForm()))}a.submit()}else this.enableForm()},this.getList=function(e){var n;if(t.isObject(e)){let t=e;(e=t.name||t.id||"").includes("query_builder_rule")&&(e=t.dataset.field)}if(e=e.replace(/^(sv_)?[xy](\d*|\$rowindex\$)_|\[\]$/g,""),this.lists[e])return this.lists[e];let a=null==(n=this.getElement(e))||null==(n=n.dataset.field)?void 0:n.replace(/^x_|\[\]$/g,"");return a?this.lists[a]:{}},this.compileTemplates=function(){let e=Object.values(this.lists);for(let n of e)n.template&&t.isString(n.template)&&(n.template=t.templates(n.template))},this.getOptionTemplate=function(e){return e.template&&t.isString(e.template)&&(e.template=t.templates(e.template)),e.template},this.getForm=function(){var e,t;this.htmlForm||("FORM"==(null==(e=this.element)?void 0:e.tagName)?this.htmlForm=this.element:"DIV"==(null==(t=this.element)?void 0:t.tagName)&&(this.htmlForm=this.element.closest("form")));return this.htmlForm},this.getElement=function(e){return e?ew.getElement(e,this.$element):this.$element[0]},this.getElements=function(e){return ew.getElements(e,this.$element)},this.fixId=function(e,n,a){let i="",r=e.split(" ");r.length>1&&(i=r[0],a="",e=r[1]);let l=t.isNumber(a)?"x"+a+"_":"x_";return e=e.startsWith("x_")?e.replace(/^x_/,l):l+e,n&&!e.endsWith("[]")&&(e+="[]"),i?i+" "+e:e},this.updateList=function(e,n,a,i){var r;null!=n||(n=t.isString(e)?null==(r=Object.entries(this.lists).find((t=>t[0]==e.replace(/^x_/,""))))?void 0:r[1]:this.getList(e)),n.template&&t.isString(n.template)&&(n.template=t.templates(n.template));let l=this.element,o=n.parentFields.slice().map((e=>this.fixId(e,!1,a))),s=n.ajax&&!n.lookupOptions.length;return e=t.isString(e)?this.fixId(e,n.multiple,a):e,!s||i?ew.updateOptions.call(this,e,o,s,!1):[e,o.map((e=>ew.getOptionValues(e,l))),s,!1]},this.updateLists=function(e,n){var i;if(null===e)return;if("grid"==this.pageId&&!t.isNumber(e)&&!t.isUndefined(e))return;let r=this.getForm();if("confirm"==(null==r||null==(i=r.querySelector("input#confirm"))?void 0:i.value))return;let l=Object.entries(this.lists).map((t=>{let[n,a]=t;return"[name='"+this.fixId(n,a.multiple,e)+"']"})).join();if(l&&this.element.querySelector(l)&&Object.entries(this.lists).map((t=>{let[n,a]=t;return this.updateList(n,a,e)})).filter((e=>Array.isArray(e))).forEach((e=>this.batch.add(ew.updateOptions.bind(this,...e)))),this.batch.requests.length){if(void 0===e||n){let e=[],n=ew.ajaxBatchSize>0?ew.ajaxBatchSize:1;for(;this.batch.requests.length>n;){let t=new f;t.requests=this.batch.requests.splice(0,n),e.push(t.send({url:ew.getApiUrl(ew.API_LOOKUP_ACTION)}))}this.batch.requests.length>0&&e.push(this.batch.send({url:ew.getApiUrl(ew.API_LOOKUP_ACTION)})),t.when(...e).then((()=>t(document).trigger("updatedone",[{source:a,target:r}]))).fail((e=>console.log(e))).always((()=>this.batch.clear()))}}else t(document).trigger("updatedone",[{source:a,target:r}])},this.createAutoSuggest=function(e){var t=Object.assign({limit:ew.AUTO_SUGGEST_MAX_ENTRIES,form:this},ew.autoSuggestSettings,e);a.autoSuggests[e.id]=new ew.AutoSuggest(t)},this.initEditors=function(){var e=this.getForm();t(e.elements).filter("textarea.editor").each((function(e,n){var a=t(n).data("editor");!a||a.active||a.name.includes("$rowindex$")||a.create()}))},this.updateTextArea=function(e){var n=this.getForm();t(n.elements).filter("textarea.editor").each((function(n,a){var i=t(a).data("editor");return!(i&&(!e||i.name==e))||(i.save(),!e&&void 0)}))},this.destroyEditor=function(e){var n=this.getForm();t(n.elements).filter("textarea.editor").each((function(n,a){var i=t(a).data("editor");return!(i&&(!e||i.name==e))||(i.destroy(),!e&&void 0)}))},this.onError=function(e,t){return ew.onError(this,e,t)},this.initUpload=function(){var e=this.getForm();t(e.elements).filter("input:file:not([name*='$rowindex$'])").each((function(e){t.later(ew.AJAX_DELAY*e,null,ew.upload,this)}))},this.setupFilters=function(e,n){let i=this.id,r=this.filterList?this.filterList.data:null,l=t(".ew-save-filter[data-form="+i+"]").toggleClass("disabled",!r),o=t(".ew-delete-filter[data-form="+i+"]").toggleClass("disabled",!n.length).toggleClass("dropdown-toggle",!!n.length),s=o.parent("li").toggleClass("dropdown-submenu dropdown-hover",!!n.length).toggleClass("disabled",!n.length),d=l.parent("li").toggleClass("disabled",!r),c=function(e,n){ew.CLIENT_SEARCH_FILTER?localStorage.setItem(ew.PROJECT_NAME+"_"+e+"_filters",JSON.stringify(n)):ew.SERVER_SEARCH_FILTER&&(document.body.style.cursor="wait",t.ajax(ew.currentPage(),{type:"POST",dataType:"json",data:{ajax:"savefilters",filters:JSON.stringify(n)}}).done((function(e){var t;null!=(t=e[0])&&t.success&&(a.filterList.filters=n)})).always((function(){document.body.style.cursor="default"})))};if(d.off("click.ew").on("click.ew",(function(e){if(d.hasClass("disabled"))return!1;ew.prompt({input:"text",html:ew.language.phrase("EnterFilterName")},(e=>{(e=ew.sanitize(e))&&(n.push([e,r]),c(i,n))}),!0)})).prevAll().remove(),o.next("ul.dropdown-menu").remove(),n.length){let e=t('<ul class="dropdown-menu"></ul>');n.forEach(((a,r,l)=>{t('<li><a class="dropdown-item" data-index="'+r+'" data-ew-action="none">'+a[0]+"</a></li>").on("click",(function(e){let t=this.querySelector("a[data-index]").dataset.index;ew.prompt(ew.language.phrase("DeleteFilterConfirm").replace("%s",a[0]),(e=>{e&&(l.splice(t,1),c(i,n))}))})).appendTo(e),t('<li><a class="dropdown-item ew-reset-filter-list" data-index="'+r+'" data-ew-action="none">'+a[0]+"</a></li>").insertBefore(d).on("click",(function(e){if("calendar"==currentPageID)t("<form>").attr({method:"post",action:ew.currentPage()}).append(t("<input type='hidden'>").attr({name:"cmd",value:"resetfilter"}),t("<input type='hidden'>").attr({name:ew.TOKEN_NAME_KEY,value:ew.TOKEN_NAME}),t("<input type='hidden'>").attr({name:ew.ANTIFORGERY_TOKEN_KEY,value:ew.ANTIFORGERY_TOKEN}),t("<input type='hidden'>").attr({name:"filter",value:JSON.stringify(a[1])})).appendTo("body").trigger("submit");else{let e={cmd:"resetfilter",filter:JSON.stringify(a[1])};ew.refresh(ew.fetch(ew.setLayout(ew.currentPage(),!1),{method:"POST",body:e}))}}))})),t('<li class="dropdown-divider"></li>').insertBefore(d),s.append(e)}},this.on=function(){i.on(...arguments)},this.one=function(){i.one(...arguments)},this.off=function(){i.off(...arguments)},this.trigger=function(){i.trigger(...arguments)},this.init=function(){if(!this._initiated){var e=this.getForm();if(e){var n=t(e);this.compileTemplates(),/s(ea)?rch$/.test(this.id)&&(this.initSearchPanel&&!ew.hasFormData(e)&&t("#"+this.id+"_search_panel").removeClass("show"),t(".ew-table .ew-search-operator").text().trim()||t(".ew-table .ew-search-operator").parent("td").hide(),n.find("select[id^=z_]").each((function(){"BETWEEN"!=t(this).trigger("change").val()&&n.find("#w_"+this.id.substring(2)).trigger("change")}))),this.multiPage&&this.multiPage.render(),loadjs.ready(["editor"],(()=>setTimeout(this.initEditors.bind(this),0))),this.updateLists(),this.initUpload(),this.$element.is("form")&&(this.$element.find(".ew-detail-pages .ew-nav a[data-bs-toggle=tab]").on("shown.bs.tab",(function(e){var n=t(e.target.getAttribute("href")),a=n.find(".table-responsive.ew-grid-middle-panel"),i=n.closest(".container-fluid");a.width()>=i.width()?a.width(i.width()+"px"):a.width("auto")})),n.off("submit.ew").on("submit.ew",(function(n){let i={form:e,result:a.submit(n)},r=t.Event("aftersubmit",{originalEvent:n});return a.trigger(r,[i]),!1})),n.find("[data-field], .ew-priv").on("change",(function(){ew.CONFIRM_CANCEL&&(a.modified=!0)})),n.find("#btn-cancel[data-href]").on("click",(function(){a.updateTextArea();var t=this.dataset.href;a.modified&&ew.hasFormData(e)?ew.prompt(ew.language.phrase("ConfirmCancel"),(e=>{e&&(n.find("#btn-action").prop("disabled",!0),window.location=t)})):(n.find("#btn-action").prop("disabled",!0),window.location=t)}))),this._initiated=!0,this.$element.data("form",this),(this.enableOnInit||Array.from(e.elements).find((e=>e.matches("button.disabled.enable-on-init"))))&&this.enableForm(),this.trigger("initiated")}}},ew.forms.add(this)}t.ajax=function(e,t){"object"==typeof e&&(t=e,e=void 0);var n=(t=t||{}).beforeSend;return t.beforeSend=function(e,t){if(n){var a=n(e,t);if(!1===a)return a}if(t._batch)return t._batch._addRequest(e,t),!1},h.call(this,e,t)};let m=function(){function e(e,t,n){if(p(this,"name",""),p(this,"validators",[]),p(this,"_validate",!0),this.name=e,Array.isArray(t))for(let e of t)this.addValidator(e);else"function"==typeof t&&this.addValidator(t);this.invalid=n}var t=e.prototype;return t.addValidator=function(e){"function"==typeof e&&this.validators.push(e)},t.addError=function(e){if(e){var t;let n=null!=(t=this._error)?t:{};this._error={...n,...e},this.invalid=!0}},t.clearErrors=function(){this._error=null,this.invalid=!1},t.clearValidators=function(){this.validators=[]},t.validate=function(){let e=!0;if(this.clearErrors(),this._element&&this.shouldValidate&&Array.isArray(this.validators)){for(let t of this.validators){let n=t(this._element);!1!==n&&(this.addError(n),e=!1)}this.updateFeedback()}return e},t.resetInvalid=function(){var e,t;this.clearErrors(),null!=(e=this._element)&&null!=(e=e.classList)&&e.contains("is-invalid")&&!this._error&&this.addError({server:null==(t=this._element.closest(ew.fieldContainerSelector))||null==(t=t.querySelector(".invalid-feedback"))?void 0:t.innerHTML})},t.updateFeedback=function(){let e=this.errorMessage;if(this._element&&e){var t;let n=null==(t=this._element.closest(ew.fieldContainerSelector))?void 0:t.querySelector(".invalid-feedback");n&&(n.innerHTML=e),ew.setInvalid(this._element)}},t.focus=function(e){this._element&&ew.setFocus(this._element,e)},t.canFocus=function(){var e,t;let n=this._element;return n&&!(n.hidden&&"SELECTION-LIST"==!n.tagName||n.readonly||n.disabled||"hidden"==n.type||"none"==(null==(e=n.style)?void 0:e.display)||null!=(t=n.classList)&&t.contains("d-none"))},s(e,[{key:"error",get:function(){return this._error}},{key:"errorMessage",get:function(){return this._error?Array.from(Object.values(this._error)).join("<br>"):""}},{key:"shouldValidate",get:function(){return!this._checkbox||this._checkbox.checked}},{key:"element",get:function(){return this._element},set:function(e){var t;this._element=e,this._checkbox=null!=(t=this._element)&&null!=(t=t.id)&&t.match(/^[xy]_/)?document.getElementById(this._element.id.replace(/^[xy]_/,"u_").replace(/\[\]$/,"")):null}},{key:"value",get:function(){return this._element?ew.getValue(this._element):""}},{key:"focused",get:function(){return this._element&&this._element==document.activeElement}}]),e}(),w=function(e){function t(t,n){var a;return p(d(a=e.call(this,t,n)||this),"row",{}),p(d(a),"fields",{}),p(d(a),"validateRequired",!0),p(d(a),"autoFocus",!0),p(d(a),"autoFocusPreventScroll",!0),a.on("initiated",(function(){this.getForm().classList.contains("ew-wait")?this.one("enabled",(function(){this.setInvalid(),this.tryFocus()})):(this.setInvalid(),this.tryFocus())})),a}u(t,e);var n=t.prototype;return n.addField=function(e,t,n){e in this.fields||(this.fields[e]=new m(e,t,n))},n.getField=function(e){return this.fields[e]},n.addFields=function(e){if(Array.isArray(e))for(let t of e)Array.isArray(t)&&this.addField.apply(this,t)},n.addError=function(e,t){var n;t&&(this._error=null!=(n=this._error)?n:{},this._error[e]=t)},n.addCustomError=function(e,t,n){if(e in this.fields){let a=this.fields[e],i={custom:t};a.addError(i),this.setFieldElement(e,n),a.updateFeedback(),this.addError(e,i)}return!1},n.setFocus=function(e){let n=this.makeVisible(e)?t.focusDelay:0;if(e&&e!=document.activeElement&&e.focus){let a=!e.closest(".modal-body")&&t.autoFocusPreventScroll&&this.autoFocusPreventScroll;setTimeout((()=>{e.focus({preventScroll:a})}),n),this._focused=!0}},n.focus=function(){if(this.canFocus())for(let[t,n]of Object.entries(this.fields)){var e;if((n.invalid||null!=(e=this._error)&&e[t])&&(this.getFocusable(n),n.canFocus())){this.setFocus(n.element);break}}},n.getFocusable=function(e){null!=e.element||(e.element=this.getFieldElements(e.name)),e.canFocus()||(e.element=this.getFieldElements(e.name,0)),e.canFocus()||(e.element=this.getFieldElements(e.name,1))},n.tryFocus=function(e){if(!this.canFocus())return;if(!e&&(!t.autoFocus||!this.autoFocus||this._focused))return;if(!e&&this.invalid)return void this.focus();if(["add","edit"].includes(this.pageId)){let e=this.getForm(),t=Array.from(e.querySelectorAll("input[name=detailpage]")).find((e=>{var t;return null==(t=ew.forms.get(e.value))?void 0:t.invalid}));if(t)return void t.focus()}for(let[t,n]of Object.entries(this.fields))if(("string"!=typeof e||e===t)&&(n.element=null,this.getFocusable(n),n.canFocus()))return void this.setFocus(n.element);let n=this.element[ew.TABLE_BASIC_SEARCH];this.id.endsWith("srch")&&n&&n!=document.activeElement&&(n.focus({preventScroll:t.autoFocusPreventScroll&&this.autoFocusPreventScroll}),this._focused=!0)},n.canFocus=function(){var e,t;let n=this.element;return n&&!(n.hidden||"hidden"==n.type||"none"==(null==(e=n.style)?void 0:e.display)||null!=(t=n.classList)&&t.contains("d-none"))},n.makeVisible=function(e){if(this.multiPage)return this.multiPage.gotoPageByElement(e),!0;if(this.$element.is("div")){let e=this.$element.closest(".tab-pane");if(e[0]&&!e.hasClass("active"))return e.closest(".ew-nav").find("a[data-bs-toggle=tab][href='#"+e.attr("id")+"']").trigger("click"),!0}return!1},n.validateFields=function(e){null!=e||(e=this.getCurrentRowIndex()),e<2&&(this.value=null),this.row={},this._error=null;let t=!0;for(let n of Object.values(this.fields))n.element=this.getFieldElements(n.name,e),this.row[n.name]=n.value,n.element&&!n.validate()&&(this.addError(n.name,n.error),t=!1);if(this.value){Array.isArray(this.value)||(this.value=[this.value]);let t=parseInt(e,10)||0;t=t>1?t-1:0,this.value[t]={...this.row}}else this.value={...this.row};return this.focus(),t},n.validate=async function(e){var t,n,a,i;if(!this.validateRequired)return!0;let r=this.getForm();if("confirm"==(null==(t=r.querySelector("#confirm"))?void 0:t.value))return!0;if("update"==this.pageId&&!ew.updateSelected(r))return ew.alert(ew.language.phrase("NoFieldSelected")),!1;let l=0,o=r.querySelector(".ew-inline-insert"),s=(null==(n=r.querySelector("#action"))?void 0:n.value)||(null==(a=null!=(i=null==e?void 0:e.currentTarget)?i:o)?void 0:a.dataset.action),d=o?0:this.keyCount,c="gridinsert"==s||["insert","confirm"].includes(s)&&d,u=o?0:d||1;for(let e=o?0:1;e<=u;e++){var p,f;let t=d>=0?String(e):"";if(r.dataset.rowindex=t,["list","grid"].includes(this.pageId)){if(c&&this.emptyRow(t))continue;l++}if(!this.validateFields(t))return!1;if(null!=(p=await(null==(f=this.customValidate)?void 0:f.call(this,r)))&&!p)return this.focus(),!1}if(delete r.dataset.rowindex,"list"==this.pageId&&c&&0==l)return ew.alert({html:ew.language.phrase("NoAddRecord"),returnFocus:!1}),this.tryFocus(!0),!1;if(["add","edit"].includes(this.pageId)){let t=r.querySelectorAll("input[name=detailpage]");for(let n of t){var h;let t=ew.forms.get(n.value);if(null!=(h=await(null==t||null==t.validate?void 0:t.validate(e)))&&!h)return!1}}return!0},n.getCurrentRowIndex=function(){var e;return null!=(e=this.getForm().dataset.rowindex)?e:""},n.getValue=function(e){null!=e||(e=this.getCurrentRowIndex());let t={};for(let n of Object.values(this.fields)){null!=n.element||(n.element=this.getFieldElements(n.name,e)),t[n.name]=n.value}return t},n.getFieldValue=function(e,t){let n=this.getField(e);return n?(null!=t||(t=this.getCurrentRowIndex()),null!=n.element||(n.element=this.getFieldElements(n.name,t)),n.value):null},n.getFieldElements=function(e,t){return null!=t||(t=this.getCurrentRowIndex()),this.getElements("x"+t+"_"+e)||this.getElements("x"+t+"_"+e+"[]")||this.getElements(e)},n.setFieldElement=function(e,t){let n=this.getField(e);return n&&(n.element=this.getFieldElements(n.name,t)),null==n?void 0:n.element},n.setInvalid=function(e){let t=this.getForm();if("undefined"==typeof e&&this.formKeyCountName){let e=t.querySelector(".ew-inline-insert"),n=e?0:this.keyCount,a=e?0:n||1;for(let t=e?0:1;t<=a;t++){let e=n>=0?String(t):"";this.setInvalid(e)}}else{null!=e||(e="");for(let t of Object.values(this.fields))t.element=this.getFieldElements(t.name,e),e&&t.resetInvalid(),t.invalid&&(this.addError(t.name,t.error),this._focused||this.focus(),ew.setInvalid(t.element));["add","edit"].includes(this.pageId)&&t.querySelectorAll("input[name=detailpage]").forEach((e=>{var t;return null==(t=ew.forms.get(e.value))?void 0:t.setInvalid()}))}},s(t,[{key:"error",get:function(){return this._error}},{key:"invalid",get:function(){return this._error||Object.values(this.fields).some((e=>e.invalid))}},{key:"keyCount",get:function(){var e;let t=this.formKeyCountName?null==(e=this.getForm().querySelector("#"+this.formKeyCountName))?void 0:e.value:void 0;return parseInt(t,10)}}]),t}(g);p(w,"autoFocus",!0),p(w,"autoFocusPreventScroll",!0),p(w,"focusDelay",200);let v=function(){function e(){p(this,"lists",{}),p(this,"fields",[]),p(this,"validateRequired",!1),p(this,"multiPage",!1),p(this,"submitWithFetch",!1),p(this,"initSearchPanel",!1),p(this,"enableOnInit",!1)}var t=e.prototype;return t.setId=function(e){return this.id=e,this},t.setPageId=function(e){return this.pageId=e,this},t.setLists=function(e){return e&&"object"==typeof e&&!Array.isArray(e)&&(this.lists=e),this},t.setQueryBuilderLists=function(e){if(e&&"object"==typeof e&&!Array.isArray(e)){for(let[t,n]of Object.entries(e))e[t]={...n,autoFillTargetFields:[],childFields:[],filterFieldVars:[],filterFields:[],parentFields:[]};this.lists=e}return this},t.addList=function(e,t){return this.lists[e]=t,this},t.setFields=function(e){return Array.isArray(e)&&(this.fields=e),this},t.addField=function(e,t,n){return this.fields.find((t=>t[0]==e))||this.fields.push([e,t,n]),this},t.addFields=function(e){return Array.isArray(e)&&(this.fields=[...this.fields,...e]),this},t.setValidate=function(e){return this.validate=e,this},t.setCustomValidate=function(e){return this.customValidate=e,this},t.setValidateRequired=function(e){return this.validateRequired=e,this},t.setSubmit=function(e){return this.submit=e,this},t.setFormKeyCountName=function(e){return this.formKeyCountName=e,this},t.setEmptyRow=function(e){return this.emptyRow=e,this},t.setMultiPage=function(e){return this.multiPage=e,this},t.setSubmitWithFetch=function(e){return this.submitWithFetch=e,this},t.setFilterList=function(e){return this.filterList=e,this},t.setInitSearchPanel=function(e){return this.initSearchPanel=e,this},t.setEnableOnInit=function(e){return this.enableOnInit=e,this},t.build=function(){let e=new ew.Form(this.id,this.pageId);return Array.isArray(this.fields)&&e.addFields(this.fields),"function"==typeof this.validate&&(e.validate=this.validate),"function"==typeof this.customValidate&&(e.customValidate=this.customValidate),"function"==typeof this.emptyRow&&(e.emptyRow=this.emptyRow),"function"==typeof this.submit&&(e.submit=this.submit),this.formKeyCountName&&(e.formKeyCountName=this.formKeyCountName),this.multiPage&&(e.multiPage=new ew.MultiPage(this.id)),this.enableOnInit&&(e.enableOnInit=!0),this.submitWithFetch&&(e.submitWithFetch=!0,e.on("aftersubmit",((e,t)=>ew.refresh(null==t?void 0:t.result,null==t?void 0:t.context)))),this.filterList&&(e.filterList=this.filterList),this.lists&&(e.lists=this.lists),e.validateRequired=!!this.validateRequired,e.initSearchPanel=!!this.initSearchPanel,e.lists=this.lists,e},e}(),b=function(){function e(e){var n,a;if(p(this,"_isAutoSuggest",null),this.elementId=e.id,this.form=e.form,t.isString(this.form)&&(this.form=ew.forms.get(this.form)),this.element=this.form.getElement(this.elementId),!this.element)return;this.formElement=this.form.getElement(),this.list=this.form.getList(this.element);let i=this.elementId.match(/^[xy](\d*|\$rowindex\$)_/),r=i?i[1]:"";this.parentFields=null!=(n=null==(a=this.list.parentFields)?void 0:a.slice().map((e=>1==e.split(" ").length?e.replace(/^x_/,"x"+r+"_"):e)))?n:[],this.limit=e.limit,this.debounce=e.debounce,this.data=e.data,this.recordCount=0,this.action=e.action||"autosuggest"}var n=e.prototype;return n.formatResult=function(e){return this.form.compileTemplates(),this.list.template&&!this.isAutoSuggest?this.list.template.render(e,ew.jsRenderHelpers):ew.displayValue(e,this.element)||e[0]},n.generateRequest=function(){var e=Object.assign({},this.data,{name:this.element.name,page:this.list.page,field:this.list.field,language:ew.LANGUAGE_ID},ew.getUserParams("#p_"+this.elementId,this.formElement));return null!=e.ajax||(e.ajax=this.action),this.parentFields.length>0&&this.parentFields.forEach(((t,n)=>e["v"+(n+1)]=ew.getOptionValue(t,this.formElement))),e},n.getUrl=function(e,n){let a=new URLSearchParams({q:e||"",n:this.limit,rnd:ew.random(),start:t.isNumber(n)?n:-1});return ew.getApiUrl(ew.API_LOOKUP_ACTION,a.toString())},n.prepare=function(e,t){return{url:this.getUrl(e,t),type:"POST",dataType:"json",data:this.generateRequest()}},n.transform=function(e){let t=[];return"OK"==(null==e?void 0:e.result)&&(this.recordCount=e.totalRecordCount,t=e.records),t},n.toSelect2Data=function(e){if(Array.isArray(e)){if(e.every((e=>e.hasOwnProperty("gf")))){return[...new Set(e.map((e=>e.gf)))].map((t=>({text:t,children:e.filter((e=>e.gf==t)).map((e=>({id:e.lf,text:this.formatResult({lf:e.lf,df:e.df,df2:e.df2,df3:e.df3,df4:e.df4})})))})))}return e.map((e=>({id:e.lf,text:this.formatResult({lf:e.lf,df:e.df,df2:e.df2,df3:e.df3,df4:e.df4})})))}return e},s(e,[{key:"isAutoSuggest",get:function(){return null!=this._isAutoSuggest||(this._isAutoSuggest=ew.isAutoSuggest(this.element)),this._isAutoSuggest}},{key:"options",get:function(){return this.list.lookupOptions}}]),e}(),y=function(e){function n(n){var a;if(!(a=e.call(this,n)||this).element)return d(a);if(a.input=a.form.getElement("sv_"+a.elementId),!a.input||a.elementId.includes("$rowindex$"))return d(a);let i=d(a),r=t(a.input),l=t(a.element);a.minWidth=n.minWidth,a.maxHeight=n.maxHeight,a.highlight=n.highlight,a.hint=n.hint,a.minLength=n.minLength,a.templates=Object.assign({},n.templates),a.classNames=Object.assign({},n.classNames),a.delay=n.delay,a.debounce=n.debounce,a.display=n.display||"text",a.forceSelection=n.forceSelect,a.lineHeight=n.lineHeight,a.paddingY=n.paddingY,a.lookupAllDisplayFields=n.lookupAllDisplayFields,a.$input=r,a.$element=l,l.data("autosuggest",d(a)),r.val()&&l.val()&&a.element.add(l.val(),r.val(),!0),r.on("typeahead:select",((e,t)=>{i.setValue(t[i.display])})).on("change",(()=>{let e=r.data("tt-typeahead");if(null!=e&&e.isOpen()&&!e.menu.empty()){let t=e.menu.getActiveSelectable();if(t){let e=t.index(),n=i.element.options[e].text;r.typeahead("val",n)}}i.setValue()})).on("blur",(()=>{let e=r.data("tt-typeahead");null!=e&&e.isOpen()&&e.menu.close()})).on("focus",(()=>{r.attr("placeholder",r.data("placeholder")).removeClass("is-invalid"),l.removeClass("is-invalid")}));let o,s=!a.options.length,c=!1,u=i.list.template||i.templates.suggestion;u&&t.isString(u)&&(u=t.templates(u)),u&&(i.templates.suggestion=u.render.bind(u)),s&&!i.templates.footer&&(i.templates.footer='<div class="tt-footer dropdown-item"><div class="spinner-border spinner-border-sm text-primary" role="status"><span class="visually-hidden">'+ew.language.phrase("LoadingMore")+"</span></div></div>");let p=(e,n,i)=>{if(s)o&&o.cancel(),o=t.later(a.debounce,null,(()=>{a.recordCount=0,t.ajax(a.prepare(e)).done((e=>i(a.transform(e))))}));else{let t=a.getSyncResults(e);n(a.transform({result:"OK",totalRecordCount:t.length,records:t}))}};return t((function(){let e=[{highlight:i.highlight,minLength:i.minLength,hint:i.hint,classNames:i.classNames},{name:i.form.id+"-"+i.elementId,source:p,async:s,templates:i.templates,display:i.display,limit:s?i.limit:1/0}];l.trigger("typeahead",[e]),i.typeahead=r.typeahead.apply(r,e).off("blur.tt").data("tt-typeahead");let n=i.typeahead.menu.$node,a=n.find(".tt-dataset"),o=()=>n.find(".tt-suggestion").outerHeight(!1);if(i.minWidth&&n.css("min-width",i.minWidth),r.on("typeahead:rendered",((e,t)=>{let r=t.length,l=i.count;if(l>=i.limit){let e=o();e&&a.css("max-height",e*i.limit)}r>0&&a.scrollTop(o()*(l-r)),s&&n.find(".tt-footer").toggle(i.recordCount>l)})),s){let e;a.on("scroll",(()=>{var r;null==(r=e)||r.cancel(),e=t.later(i.delay,null,(()=>{let t=n.find(".tt-footer");if(!t.is(":hidden")&&!c){var r;if(a.offset().top+a.outerHeight(!1)+20>t.offset().top+t.outerHeight(!1))c=!0,i.getMore().always((()=>c=!1));else null==(r=e)||r.cancel()}}))}))}})),a}u(n,e);var a=n.prototype;return a.setValue=function(e){e||(e=this.$input.val());let t=this.element.options.findIndex((t=>t.text==e));if(t<0){if(this.forceSelection&&e)return this.$input.typeahead("val","").addClass("is-invalid"),this.$element.next(".invalid-feedback").html(ew.language.phrase("ValueNotExist")),void this.$element.addClass("is-invalid").val("").trigger("change")}else this.element.options[t].selected=!0,/s(ea)?rch$/.test(this.formElement.id)&&!this.forceSelection||(e=this.element.options[t].value);e!==this.$element.attr("value")&&this.$element.attr("value",e).trigger("change")},a.transform=function(t){let n=e.prototype.transform.call(this,t).map((t=>Object.assign({},t,{text:e.prototype.formatResult.call(this,t)})));return this.element.options=n.map((e=>new ew.SelectionListOption(e.text,e.lf||e[0]))),n},a.getSyncResults=function(e){if(this.options.length){let t=this.options.filter((t=>{if(this.lookupAllDisplayFields){let n=[t.df,t.df2,t.df3,t.df4].map((e=>String(e).toLowerCase())).join(" ");return e.toLowerCase().split(" ").filter((e=>""!==e)).every((e=>n.includes(e)))}return String(t.df).toLowerCase().startsWith(e)}));return this.recordCount=t.length,t}return[]},a.getMore=function(){let e=this.typeahead.menu,n=this.count,a=this.prepare(e.query,n);return t.ajax(a).done((t=>e.datasets[0]._append(e.query,this.transform(t))))},s(n,[{key:"count",get:function(){return this.typeahead.menu.$node.find(".tt-suggestion.tt-selectable").length||0}}]),n}(b),_=function(){function e(){p(this,"_forms",{})}var n=e.prototype;return n.get=function(e){var n;if(!e)return null;let a=t.isString(e)?e:null==(n=ew.getForm(e))?void 0:n.id;return this._forms[a]},n.add=function(e){this._forms[e.id]&&this._forms[e.id]!==e&&delete this._forms[e.id],this._forms[e.id]=e},n.ids=function(){return Object.keys(this._forms)},e}(),E=ew.language.phrase("select2");var A={errorLoading:function(){return E.errorLoading},inputTooLong:function(e){var t=e.input.length-e.maximum;return E.inputTooLong.replace("%s",t)},inputTooShort:function(e){var t=e.minimum-e.input.length;return E.inputTooShort.replace("%s",t)},loadingMore:function(){return'<div class="spinner-border spinner-border-sm text-primary" role="status"><span class="visually-hidden">'+E.loadingMore+"</span></div>"},maximumSelected:function(e){return E.maximumSelected.replace("%s",e.maximum)},noResults:function(){return E.noResults},searching:function(){return'<div class="spinner-border spinner-border-sm text-primary" role="status"><span class="visually-hidden">'+E.searching+"</span></div>"},removeAllItems:function(){return E.removeAllItems},removeItem:function(){return E.removeItem},search:function(){return E.search}};let S=t.fn.select2.amd.require._defined["select2/utils"],T=function(){function e(){}var n=e.prototype;return n.render=function(e){var n=t('<div class="select2-results__options '+this.options.get("containerClass")+'" role="listbox"></div>');return this.options.get("multiple")&&n.attr("aria-multiselectable","true"),this.$results=n,n},n.displayMessage=function(e,n){var a=this.options.get("escapeMarkup");this.clear(),this.hideLoading();var i=t('<div role="alert" aria-live="assertive" class="select2-results__option"></div>');if(n.message.includes("<")&&n.message.includes(">"))i.append(n.message);else{var r=this.options.get("translations").get(n.message);i.append(a(r(n.args)))}i[0].className+=" select2-results__message",this.$results.append(i)},n.append=function(e,n){if(this.hideLoading(),null!=n.results&&0!==n.results.length){n.results=this.sort(n.results);for(var a=this.options.get("columns"),i=n.results.length,r=this.$results.find("."+this.options.get("rowClass")).last(),l=0;l<n.results.length;l++){var o=n.results[l],s=this.option(o);if(r.length&&r.children().length!=a||(r=t('<div class="'+this.options.get("rowClass")+'"></div>'),this.$results.append(r)),r.append(s),l==i-1)for(var d=a-r.children().length,c=0;c<d;c++)r.append('<div class="'+this.options.get("cellClass")+'"></div>')}}else 0===this.$results.children().length&&(this.$element.data("updating")&&n.pagination.more?(this.trigger("results:message",{message:'<div class="spinner-border spinner-border-sm text-primary ew-select-spinner" role="status"><span class="visually-hidden">'+ew.language.phrase("Loading")+"</span></div> "+ew.language.phrase("Loading")}),this.$element.one("updated",(()=>this.$element.select2("close").select2("open")))):this.trigger("results:message",{message:"noResults"}))},n.option=function(e,t){var n=document.createElement("div");n.classList.add("select2-results__option"),n.classList.add("select2-results__option--selectable"),this.options.get("cellClass").split(" ").forEach((e=>n.classList.add(e)));var a={role:"option","aria-selected":"false"},i=window.Element.prototype.matches||window.Element.prototype.msMatchesSelector||window.Element.prototype.webkitMatchesSelector;for(var r in(null!=t.element&&i.call(t.element,":disabled")||null==t.element&&t.disabled)&&(a["aria-disabled"]="true",n.classList.remove("select2-results__option--selectable"),n.classList.add("select2-results__option--disabled")),null==t.id&&n.classList.remove("select2-results__option--selectable"),null!=t._resultId&&(n.id=t._resultId),t.title&&(n.title=t.title),a){var l=a[r];n.setAttribute(r,l)}return this.template(t,n),S.StoreData(n,"data",t),n},e}(),O=t.fn.select2.amd.require._defined["select2/utils"],x=function(){function e(){}return e.prototype.bind=function(e,n,a){var i,r=this;e.call(this,n,a),null==(i=n.listeners["results:select"])||i.pop(),this.$results.off("mouseup"),n.on("results:select",(function(e){var t=r.getHighlightedResults();if(0!==t.length){var n=O.GetData(t[0],"data");t.hasClass("select2-results__option--selected")?r.trigger("unselect",{originalEvent:e,data:n}):r.trigger("select",{originalEvent:e,data:n})}})),this.$results.on("mousedown",".select2-results__option--selectable",(function(e){this._mousedown=!0})),this.$results.on("mouseup",".select2-results__option--selectable",(function(e){if(this._mousedown){var n=t(this),a=O.GetData(this,"data");n.hasClass("select2-results__option--selected")?r.trigger("unselect",{originalEvent:e,data:a}):r.trigger("select",{originalEvent:e,data:a})}}))},e}(),I=function(){function e(){}return e.prototype.bind=function(e,t,n){var a,i=this;e.call(this,t,n),null==(a=t.listeners.close)||a.pop(),t.on("close",(function(){i.$search.attr("tabindex",-1).removeAttr("aria-controls").removeAttr("aria-activedescendant")}))},e}(),C=$.fn.select2.amd.require._defined["select2/keys"];C.PRINT_SCREEN=44;let P=function(){function e(){}return e.prototype.handleSearch=function(e,t){var n=t.which;if(![C.TAB,C.SHIFT,C.CTRL,C.ALT,C.PRINT_SCREEN].includes(n)){if(!this._keyUpPrevented){var a=this.$search.val();this.trigger("query",{term:a})}this._keyUpPrevented=!1}},e}(),N=function(e){function n(t,n,a){return e.call(this,t,n,a)||this}u(n,e);var a=n.prototype;return a._attachPositioningHandler=function(e,n){var a=this,i=["scroll.select2."+n.id,"resize.select2."+n.id,"orientationchange.select2."+n.id],r=()=>{a._positionDropdown(),a._resizeDropdown()};t(window).on(i.join(" "),r),n.$element.closest(".modal").on("scroll.select2."+n.id,r)},a._detachPositioningHandler=function(e,n){var a=["scroll.select2."+n.id,"resize.select2."+n.id,"orientationchange.select2."+n.id];t(window).off(a.join(" ")),n.$element.closest(".modal").off("scroll.select2."+n.id)},a._showDropdown=function(e){this.$dropdownContainer.appendTo(this.$dropdownParent),null!=this._popper||(this._popper=Popper.createPopper(this.$container[0],this.$dropdownContainer[0],{placement:ew.IS_RTL?"bottom-end":"bottom-start",modifiers:[{name:"flip",enabled:!0},{name:"preventOverflow",enabled:!0}]})),this._positionDropdown(),this._resizeDropdown()},a._positionDropdown=function(){var e;null==(e=this._popper)||e.update()},a.destroy=function(t){var n;e.prototype.destroy.call(this,t),null==(n=this._popper)||n.destroy(),this._popper=null},n}(t.fn.select2.amd.require._defined["select2/dropdown/attachBody"]),R=function(){function e(e,n,a){p(this,"$modal",null),a.set("dropdownParent",t(document.body)),e.call(this,n,a)}var n=e.prototype;return n.bind=function(e,t,n){let a=this;e.call(this,t,n),t.on("open",(function(){a._showDropdown(),a._bindContainerResultHandlers(t)})),this.$dropdownContainer.on("mousedown",(function(e){e.stopPropagation()}))},n.position=function(e,t,n){t.attr("class",n.attr("class")),t.removeClass("select2"),this.$container=n},n.render=function(e){let n=t("<span></span>"),a=e.call(this);return n.append(a),this.$dropdownContainer=n,n},n._bindContainerResultHandlers=function(e,t){if(this._containerResultsHandlersBound)return;let n=this;t.$modal=this.$modal,t.on("results:all",(function(){var e;n._updateDropdown(),null==(e=n.$search[0])||e.focus()})),t.on("results:append",(function(){n._updateDropdown()})),t.on("results:message",(function(){n._updateDropdown()})),t.on("select",(function(e){var t;let a=null==(t=e.originalEvent)?void 0:t.currentTarget;null==a||a.classList.add("select2-results__option--selected"),n._updateDropdown()})),t.on("unselect",(function(e){var t;let a=null==(t=e.originalEvent)?void 0:t.currentTarget;null==a||a.classList.remove("select2-results__option--selected"),n._updateDropdown()})),this._containerResultsHandlersBound=!0},n._updateDropdown=function(){this.$modal.find(this.$dropdownContainer)[0]||this.$modal.find(".modal-body").children().detach().end().append(this.$dropdownContainer)},n._showDropdown=function(e){let n=this,a=this.$element.val();this.$dropdownContainer.appendTo(this.options.get("dropdownParent")),null!=this.$modal||(this.$modal=t("#ew-modal-lookup-dialog")),this._updateDropdown(),this.$modal.find(".modal-title").empty().append(ew.language.phrase("LookupTitle").replace("%s",this.$element.data("caption"))),this.$modal.find(".modal-footer button[data-value]").off().on("click",(function(){t(this).data("value")||n.$element.val(a).trigger("change")})),this.$modal.modal("show").on("hidden.bs.modal",(function(e){n.$container.removeClass("select2-container--open")})).draggable(this.options.get("draggableOptions"))},e}(),L=function(e){function n(t,n,a){return e.call(this,t,n,a)||this}u(n,e);var a=n.prototype;return a.bind=function(e,t,n){var a=this;e.call(this,t,n),t.on("open",(function(){a._showDropdown(),a._bindContainerResultHandlers(t)})),t.on("close",(function(){a._hideDropdown()})),this.$dropdownContainer.on("mousedown",(function(e){e.stopPropagation()}))},a._positionDropdown=function(){var e;null==(e=this._popper)||e.update()},a._resizeDropdown=function(){var e={width:this.$container.outerWidth(!1)+"px"};this.options.get("dropdownAutoWidth")&&(e.minWidth=e.width,e.position="relative",e.width="auto"),this.$dropdown.css(e)},a._showDropdown=function(e){var n;this.$dropdownContainer.appendTo(this.$dropdownParent);let a=this,i=this.$element.val(),r=t("#ew-filter-dropdown-footer").contents().clone();r.find(".ew-filter-btn[data-value]").off("click.ew").on("click.ew",(function(e){t(this).data("value")?t(a.$element[0].form).triggerHandler("submit"):a.$element.val(i).trigger("change"),a.$element.select2("close")})),r.find(".ew-filter-clear").off("click.ew").on("click.ew",(e=>a.$element.data("select2").selection._handleClear(e)));let l=this.$dropdownContainer.find(".ew-filter-dropdown");l.find(".ew-filter-btn")[0]||l.append(r);var o=document.querySelector(".ew-filter-dropdown-btn[data-table="+this.$element.data("table")+"][data-field="+this.$element.data("field")+"]"),s=null!=(n=o.closest(".ew-table-header-cell"))?n:o.closest(".ew-table-header-btn");null!=this._popper||(this._popper=Popper.createPopper(s,this.$dropdownContainer[0],{placement:ew.IS_RTL?"bottom-end":"bottom-start",modifiers:[{name:"flip",enabled:!0},{name:"preventOverflow",enabled:!0}]})),this._positionDropdown(),this._resizeDropdown()},a.position=function(e,t,n){t.attr("class",n.attr("class")),t[0].classList.remove("select2"),t[0].classList.add("select2-container--open"),this.$container=n},a.destroy=function(t){var n;e.prototype.destroy.call(this,t),null==(n=this._popper)||n.destroy(),this._popper=null},n}(t.fn.select2.amd.require._defined["select2/dropdown/attachBody"]),F=function(e){function t(t,n,a){return e.call(this,t,n,a)||this}u(t,e);var n=t.prototype;return n.bind=function(e,t,n){var a=this;e.call(this,t,n),t.on("open",(function(){a._showDropdown(),a._bindContainerResultHandlers(t)})),t.on("close",(function(){a._hideDropdown()})),this.$dropdownContainer.on("mousedown",(function(e){e.stopPropagation()}))},n._showDropdown=function(e){this.$dropdownContainer.appendTo(this.$dropdownParent),null!=this._popper||(this._popper=Popper.createPopper(this.$element.parent().find(".select2-container")[0],this.$dropdownContainer[0],{placement:ew.IS_RTL?"bottom-end":"bottom-start",modifiers:[{name:"flip",enabled:!0},{name:"preventOverflow",enabled:!0}]})),this._positionDropdown(),this._resizeDropdown()},n._positionDropdown=function(){var e;null==(e=this._popper)||e.update()},n.position=function(e,t,n){t.attr("class",n.attr("class")),t[0].classList.remove("select2"),t[0].classList.add("select2-container--open"),this.$container=n},n.destroy=function(t){var n;e.prototype.destroy.call(this,t),null==(n=this._popper)||n.destroy(),this._popper=null},t}(t.fn.select2.amd.require._defined["select2/dropdown/attachBody"]),k=t.fn.select2.amd.require._defined,D=k["select2/selection/allowClear"],M=k["select2/utils"],j=function(e){function t(){return e.apply(this,arguments)||this}return u(t,e),t.prototype._handleClear=function(e,t){if(!this.isDisabled()){var n=this.$selection.find(".select2-selection__clear");if(0!==n.length){t.stopPropagation();var a=M.GetData(n[0],"data"),i=this.$element.val();this.$element.val(this.placeholder.id);var r={data:a};if(this.trigger("clear",r),r.prevented)this.$element.val(i);else{for(var l=0;l<a.length;l++)if(r={data:a[l]},this.trigger("unselect",r),r.prevented)return void this.$element.val(i);this.$element.trigger("input").trigger("change")}}}},t}(D),U=function(){function e(){}return e.prototype.bind=function(e,t,n){e.call(this,t,n),this.$selection.on("click",".select2-selection__choice__remove",(function(e){e.stopPropagation()}))},e}(),B=function(){function e(){}return e.prototype.option=function(e,t){var n,a=t.text,i=null==(n=t.element)?void 0:n.innerHTML,r=e.call(this,t);return a.startsWith("<")&&a.endsWith(">")?r.html(a):i&&i!=a&&r.html(i),r},e}(),K=$.fn.select2.amd.require._defined,V=K["select2/results"],q=K["select2/selection/single"],H=K["select2/selection/multiple"],G=K["select2/selection/placeholder"],W=K["select2/selection/allowClear"],Y=K["select2/selection/search"],z=K["select2/selection/eventRelay"],J=K["select2/utils"],X=K["select2/translation"],Z=K["select2/data/select"],Q=K["select2/data/array"],ee=K["select2/data/ajax"],te=K["select2/data/tags"],ne=K["select2/data/tokenizer"],ae=K["select2/data/minimumInputLength"],ie=K["select2/data/maximumInputLength"],re=K["select2/data/maximumSelectionLength"],le=K["select2/dropdown"],oe=K["select2/dropdown/search"],se=K["select2/dropdown/hidePlaceholder"],de=K["select2/dropdown/infiniteScroll"],ce=K["select2/dropdown/minimumResultsForSearch"],ue=K["select2/dropdown/selectOnClose"],pe=K["select2/dropdown/closeOnSelect"],fe=K["select2/dropdown/dropdownCss"],he=K["select2/dropdown/tagsSearchHighlight"],ge=K["select2/defaults"];ge.apply=function(e){return null==(e=$.extend(!0,{},this.defaults,e)).dataAdapter&&(null!=e.ajax?e.dataAdapter=ee:null!=e.data?e.dataAdapter=Q:e.dataAdapter=Z,e.dataAdapter=J.Decorate(e.dataAdapter,B),e.minimumInputLength>0&&(e.dataAdapter=J.Decorate(e.dataAdapter,ae)),e.maximumInputLength>0&&(e.dataAdapter=J.Decorate(e.dataAdapter,ie)),e.maximumSelectionLength>0&&(e.dataAdapter=J.Decorate(e.dataAdapter,re)),e.tags&&(e.dataAdapter=J.Decorate(e.dataAdapter,te)),null==e.tokenSeparators&&null==e.tokenizer||(e.dataAdapter=J.Decorate(e.dataAdapter,ne))),null==e.resultsAdapter&&(e.resultsAdapter=V,e.columns>0&&e.customOption?(e.resultsAdapter=J.Decorate(e.resultsAdapter,T),e.iconClass&&e.multiple&&e.templateResult==ew.selectOptions.templateResult&&(e._templateResult=e.templateResult,e.templateResult=t=>t.loading?t.text:'<div class="form-check-input ew-dropdown-check-input"></div><label class="'+e.iconClass+' ew-dropdown-check-label">'+e._templateResult(t)+"</label>")):(e.modal||e.filter)&&(e.resultsAdapter=J.Decorate(e.resultsAdapter,x)),null!=e.ajax&&(e.resultsAdapter=J.Decorate(e.resultsAdapter,de)),null!=e.placeholder&&(e.resultsAdapter=J.Decorate(e.resultsAdapter,se)),e.selectOnClose&&(e.resultsAdapter=J.Decorate(e.resultsAdapter,ue)),e.tags&&(e.resultsAdapter=J.Decorate(e.resultsAdapter,he))),null==e.dropdownAdapter&&(e.modal||e.filter?(e.dropdownAdapter=J.Decorate(le,oe),e.dropdownAdapter=J.Decorate(e.dropdownAdapter,P),e.dropdownAdapter=J.Decorate(e.dropdownAdapter,I)):(e.dropdownAdapter=le,e.multiple||(e.dropdownAdapter=J.Decorate(e.dropdownAdapter,oe),e.dropdownAdapter=J.Decorate(e.dropdownAdapter,P))),0!==e.minimumResultsForSearch&&(e.dropdownAdapter=J.Decorate(e.dropdownAdapter,ce)),e.closeOnSelect&&(e.dropdownAdapter=J.Decorate(e.dropdownAdapter,pe)),null!=e.dropdownCssClass&&(e.dropdownAdapter=J.Decorate(e.dropdownAdapter,fe)),e.dropdownAdapter=J.Decorate(e.dropdownAdapter,e.modal?R:e.filter?L:e.dropdown?F:N)),null==e.selectionAdapter&&(e.multiple?(e.selectionAdapter=H,e.selectionAdapter=J.Decorate(e.selectionAdapter,U)):e.selectionAdapter=q,null!=e.placeholder&&(e.selectionAdapter=J.Decorate(e.selectionAdapter,G)),e.allowClear&&(e.selectionAdapter=J.Decorate(e.selectionAdapter,e.filter?j:W)),e.multiple&&(e.selectionAdapter=J.Decorate(e.selectionAdapter,Y)),e.selectionAdapter=J.Decorate(e.selectionAdapter,z)),e.translations=new X(A),e.dir=ew.IS_RTL?"rtl":"ltr",e};let me=new URL(window.location),we=new _,ve=t(document),be=t("body"),ye=".row, [id^=el_], [class^=el_]";function _e(e){var n;let a=null!=(n=null==e?void 0:e.target)?n:document,i={...ew.tooltipOptions,container:"body",trigger:ew.IS_MOBILE?"manual":"hover"};t(a).find(".ew-icon").closest(".btn, .ew-home, .ew-row-link:not(.dropdown-item)").each((function(){let e=t(this);if(e.hasClass("dropdown-toggle")){let t=e.closest(".btn-group");1==t.children(".btn").length&&(t.tooltip({...i,title:this.dataset.title||this.title}).on("mouseleave",(e=>{var t;return null==(t=bootstrap.Tooltip.getInstance(e.currentTarget))?void 0:t.hide()})),e.next(".dropdown-menu").on("mouseover",(e=>e.stopPropagation())))}else e.tooltip(i)}))}function Ee(e){var n,a=null!=(n=null==e?void 0:e.target)?n:document;t.fn.pStrength&&"undefined"!=typeof ew.MIN_PASSWORD_STRENGTH&&t(a).find(".ew-password-strength").each((function(){var e=t(this);e.data("pStrength")||e.pStrength({changeBackground:!1,backgrounds:[],passwordValidFrom:ew.MIN_PASSWORD_STRENGTH,onPasswordStrengthChanged:function(e,n){var a=t("[id='"+this.attr("data-password-strength")+"']"),i=a.find(".progress-bar");if(this.val()&&!ew.isMaskedPassword(this)){var r=n+"%",l=ew.MIN_PASSWORD_STRENGTH,o=n>=l;n<.25*l?i.addClass("text-bg-danger").removeClass("text-bg-warning text-bg-info text-bg-success"):n<.5*l?i.addClass("text-bg-warning").removeClass("text-bg-danger text-bg-info text-bg-success"):n<.75*l?i.addClass("text-bg-primary").removeClass("text-bg-danger text-bg-warning text-bg-success"):i.addClass("text-bg-success").removeClass("text-bg-danger text-bg-warning text-bg-info"),i.css("width",r),n>.5*l&&(r=ew.language.phrase("PasswordStrength").replace("%p",r)),i.html(r),a.removeClass("d-none"),this.data("validated",o),o&&ft(this[0])}else a.addClass("d-none"),this.data("validated",null);a.width(this.outerWidth())}})})),t.fn.pGenerator&&t(a).find(".ew-password-generator").each((function(){var e=t(this);e.data("pGenerator")||e.pGenerator({passwordLength:ew.GENERATE_PASSWORD_LENGTH,uppercase:ew.GENERATE_PASSWORD_UPPERCASE,lowercase:ew.GENERATE_PASSWORD_LOWERCASE,numbers:ew.GENERATE_PASSWORD_NUMBER,specialChars:ew.GENERATE_PASSWORD_SPECIALCHARS,onPasswordGenerated:function(e){t("#"+this.attr("data-password-confirm")).val(e),t("#"+this.attr("data-password-field")).val(e).trigger("change").trigger("focus").triggerHandler("click")}})}))}function Ae(e,n){var a=ew.PATH_BASE+ew.API_URL,i=(n instanceof URLSearchParams?n:new URLSearchParams(n)).toString();if(t.isString(e))a+=e||"";else if(Array.isArray(e)){var r=e.map((function(e){return encodeURIComponent(e)})).join("/");a+=r||""}return a+(i?"?"+i:"")}function Se(e){var t,n;let a,i,r;[a,r]=e.split("#"),[a,i]=a.split("?"),!i&&a.includes("=")&&([a,i]=["",a]);let l={url:e,pathname:null!=(t=a)?t:"",hash:null!=(n=r)?n:"",searchParams:new URLSearchParams(i)};return Object.defineProperty(l,"search",{value:i,writable:!1,enumerable:!0}),l}function Te(e){try{return new URLSearchParams(e)}catch(e){return console.log(e),new URLSearchParams}}function Oe(e){return Se(e).searchParams}function xe(e){let t=Se(e);for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];return t.searchParams=Ie(t.searchParams,...a),Ne(t)}function Ie(){let e=new URLSearchParams;for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];for(const n of a)if(t.isObject(n)||t.isString(n)&&n){(n instanceof URLSearchParams?n:Te(n)).forEach(((t,n)=>e.has(n)&&n.endsWith("[]")?e.append(n,t):e.set(n,t)))}return e}function Ce(e,t,n){return xe(e,{[t]:n})}function Pe(e){let t=Se(e);for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];return a.forEach((e=>t.searchParams.delete(e))),Ne(t)}function Ne(e){let t=e.searchParams.toString();return e.pathname+(e.pathname&&t?"?":"")+t+(e.hash?"#"+e.hash:"")}function Re(e,t){return e&&"#"!=e?xe(e,{[ew.PAGE_LAYOUT]:String(t)}):e}function Le(e){let t=Se(e),n=t.searchParams;return n.forEach(((e,t)=>{e=decodeURIComponent(e),["<>","<=",">=",">","<"].includes(e)?n.set(t,e):n.set(t,ew.sanitize(e))})),Ne(t)}function Fe(e){var n;let a=t(null!=(n=null==e?void 0:e.target)?n:document);a.find("a.ew-export-link[href]:not(.ew-email):not(.ew-print):not(.ew-xml)").on("click",(function(e){let t=this.href;t&&"#"!=t&&Me(t,nt()),e.preventDefault()})),a.find("a.ew-export-link[href].ew-print, a.ew-export-link[href].ew-xml").each((function(){let e=new URL(this.href);e.searchParams.set(ew.TOKEN_NAME_KEY,ew.TOKEN_NAME),e.searchParams.set(ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN),this.href=e.pathname+e.search}))}function ke(e){var n,a=null!=(n=null==e?void 0:e.target)?n:document,i=t(a),r=i.find("input[type=checkbox].ew-multi-select"),l=function(e){var n=r.filter("[name^='"+e+"_']"),a=n.length,i=n.filter(":checked").length;t("input[type=checkbox]#"+e).prop("checked",i==a).prop("indeterminate",i!=a&&0!=i)};r.on("click",(e=>l(e.target.name.split("_")[0]))),i.find("input[type=checkbox].ew-priv:not(.ew-multi-select)").each(((e,t)=>l(t.id)))}function De(e){var n,a;return e&&((null==(n=e.error)?void 0:n.description)||(null==(a=e.error)?void 0:a.message)||t.isString(e.error)&&e.error||e.failureMessage||!1===e.success&&e.message||null)}function Me(e,t){let n=e.includes("export=html")||e.includes(Ae([ew.API_EXPORT_ACTION,"html"])),a=window.parent.Swal;return t=Ie(t,[[ew.TOKEN_NAME_KEY,ew.TOKEN_NAME],[ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN]]),a.fire({...ew.sweetAlertSettings,showConfirmButton:!1,html:"<p>"+ew.language.phrase("Exporting")+"</p>",allowOutsideClick:!1,allowEscapeKey:!1,willOpen:()=>{a.showLoading(),Ut(e,{method:t?"POST":"GET",body:t||null}).then((async t=>{let i=t.headers.get("Content-Type");if(null!=i&&i.includes("json")){var r;let n=null!=(r=De(await t.json()))?r:ew.language.phrase("FailedToExport");n&&(a.hideLoading(),a.update({html:"<div class='text-danger'>"+n+"</div>",showConfirmButton:!0}),ve.trigger("export",[{type:"fail",url:e}]))}else{let i=n?await t.text():await t.blob(),r=URL.createObjectURL(n?new Blob([i],{type:"text/html"}):i),l=document.createElement("a"),o=t.headers.get("Content-Disposition"),s=null==o?void 0:o.match(/\bfilename=((['"])(.+)\2|([^;]+))/i);l.style.display="none",l.href=r,s&&(l.download=s[3]||s[4]),document.body.appendChild(l),l.click(),ve.trigger("export",[{type:"done",url:e,objectUrl:r}]),URL.revokeObjectURL(r),a.close()}})).catch((t=>{a.hideLoading(),a.update({html:"<div class='text-danger'>"+t+"</div>",showConfirmButton:!0}),ve.trigger("export",[{type:"fail",url:e}])})).finally((()=>{ve.trigger("export",[{type:"always",url:e}])}))}})}function je(e){var t;ew.LAZY_LOAD&&((null!=(t=null==e?void 0:e.target)?t:document).querySelectorAll("img.ew-lazy").forEach(((e,t)=>{ew.LAZY_LOAD_DELAY>0?setTimeout((()=>e.src=e.dataset.src),t*ew.LAZY_LOAD_DELAY):e.src=e.dataset.src})),ve.trigger("lazyload"))}function $e(e){var n;if(ew.USE_COLORBOX){var a=null!=(n=null==e?void 0:e.target)?n:document,i=Object.assign({},ew.lightboxSettings,{title:ew.language.phrase("LightboxTitle"),current:ew.language.phrase("LightboxCurrent"),previous:ew.language.phrase("LightboxPrevious"),next:ew.language.phrase("LightboxNext"),close:ew.language.phrase("LightboxClose"),xhrError:ew.language.phrase("LightboxXhrError"),imgError:ew.language.phrase("LightboxImgError")});t(a).find(".ew-lightbox").each((function(){var e=t(this);e.colorbox(Object.assign({rel:e.data("rel")},i))}))}}function Ue(e){var n;if(!ew.EMBED_PDF)return;let a=null!=(n=null==e?void 0:e.target)?n:document,i=Object.assign({},ew.PDFObjectOptions);t(a).find(".ew-pdfobject").not(":has(.pdfobject)").each((function(){let e=t(this),n=e.data("url"),a=e.html();n&&PDFObject.embed(n,this,Object.assign(i,{fallbackLink:a}))}))}function Be(e){var n;let a=null!=(n=null==e?void 0:e.target)?n:document,i=t(a);i.find("input[data-bs-toggle=tooltip], textarea[data-bs-toggle=tooltip], select[data-bs-toggle=tooltip]").each((function(){let e=t(this);e.tooltip({...ew.tooltipOptions,html:!0,...e.data()})})),i.find("a.ew-tooltip-link").each(zt),i.find(".ew-tooltip").tooltip(ew.tooltipOptions),i.find(".ew-popover").popover(ew.popoverOptions),i.find(".ew-tippy[data-title]").each((function(){tippy(this,{content:this.dataset.title,...ew.tippyOptions})}))}function Ke(e){if(t.isString(e))try{return JSON.parse(e)}catch(e){return}return e}function Ve(e){let n=t(e).closest("[id^=r_], [id^=xs_]"),a=e.id.substring(2),i=n.find(".ew-search-field"),r=n.find(".ew-search-field2"),l=r.find("[name='y_"+a+"'], [name='y_"+a+"[]']").length,o=n.find(".ew-search-cond"),s=o.length,d=n.find(".ew-search-and"),c=n.find(".ew-search-operator").find("[name='z_"+a+"']").val(),u=n.find(".ew-search-operator2"),p=u.find("[name='w_"+a+"']").val(),f=c.includes("BETWEEN"),h=["IS NULL","IS NOT NULL","IS EMPTY","IS NOT EMPTY"].includes(c),g=["IS NULL","IS NOT NULL","IS EMPTY","IS NOT EMPTY"].includes(p),m=!l||f,w=h,v=!f&&(!s||g);o.toggleClass("d-none",m).find(":input").prop("disabled",m),d.toggleClass("d-none",!f),u.toggleClass("d-none",m).find(":input").prop("disabled",m),i.toggleClass("d-none",w).find(":input").prop("disabled",w),r.toggleClass("d-none",v).find(":input").prop("disabled",v)}function qe(e){var t;let n=null!=(t=null==e?void 0:e.target)?t:document,a=ew.forms.ids();for(let e of a)(null!=n.matches&&n.matches("#"+e)||n.querySelector("#"+e))&&we.get(e).init()}function He(e){return"function"==typeof e}function Ge(e,n,a){let i=t.isObject(e)?e:{};e=t.isString(e)?e:"",a=t.isString(n)?n:a,i=t.extend(!0,{},ew.sweetAlertSettings,{html:e,confirmButtonText:ew.language.phrase("OKBtn"),customClass:{htmlContainer:"ew-swal2-html-container text-"+(a||"danger")}},i);let r={config:i,type:a,show:!0};if(ve.trigger("alert",[r]),r.show)return Swal.fire(r.config).then((e=>He(n)?n(e.isConfirmed):e))}function We(e,n){var a;let i=t.isObject(e)?e:{};return i=t.extend(!0,{},ew.sweetAlertSettings,{html:t.isString(e)?e:"",showCancelButton:!0,confirmButtonText:ew.language.phrase("OKBtn"),cancelButtonText:ew.language.phrase("CancelBtn")},i),i.input&&(null!=(a=i).inputValidator||(a.inputValidator=e=>{if(!e)return ew.language.phrase("EnterValue")})),Swal.fire(i).then((e=>He(n)?n(e.value):e))}function Ye(e){e=Object.assign({},ew.toastOptions,e),ve.Toasts("create",e);var n=e.position;return t("#toastsContainer"+n[0].toUpperCase()+n.substring(1)).children().first()}function ze(e,t,n){if(!e)return;t||(t="danger"),n||(n=ew.language.phrase(t));let a={message:e,type:t,title:n,show:!0};return ve.trigger("toast",[a]),a.show?(({message:e,type:t,title:n}=a),Ye({class:"ew-toast text-bg-"+t,title:n,body:e,autohide:"success"==t&&ew.autoHideSuccessMessage,delay:"success"==t?ew.autoHideSuccessMessageDelay:500})):void 0}function Je(e){if(e instanceof w)return e.$element[0];var n=t(e),a=n.closest(".ew-form");return a[0]||(a=n.closest(".ew-grid, .ew-multi-column-grid, .modal").find(".ew-form")),a[0]}function Xe(e,n,a,i){var r,l,o=this.$element?this.$element[0]:this.form||(null==(r=e)?void 0:r.form);if(o&&((this.htmlForm?this:we.get(o.id))&&(this.form&&t.isUndefined(e)?e=we.get(this).getList(this).childFields.slice():t.isString(e)&&(e=At(e,o)),e&&(!Array.isArray(e)||0!=e.length)))){var s=this,d=new f;if(Array.isArray(e)&&t.isString(e[0])){for(var c=[],u=0,p=e.length;u<p;u++){var h=e[u].split(" ");if(1==h.length&&s.form){var g=Ft(s,!1).match(/^([xy]\d*_)/);g&&(e[u]=e[u].replace(/^([xy]\d*_)/,g[1]))}var m=At(e[u],o),w=[];if(!ct(m)&&!lt(m))if(c.push(m),2==h.length&&Array.isArray(m)){var v=t(m);v.each((function(){if(!w.includes(this.name)){w.push(this.name);var e=v.filter("[name='"+this.name+"']"),t=e.attr("type"),r=["radio","checkbox"].includes(t)?e.get():e[0];d.add(Ze.bind(s,r,n,a,i))}}))}else d.add(Ze.bind(s,m,n,a,i))}e=c;var b=we.get(s).getList(s);Array.isArray(null==b?void 0:b.autoFillTargetFields)&&b.autoFillTargetFields[0]&&d.add(Yt.bind(null,s))}else{if(ct(e)||lt(e))return;d.add(Ze.bind(s,e,n,a,i))}return null==(l=d.send({url:ew.getApiUrl(ew.API_LOOKUP_ACTION)}))?void 0:l.then((function(){ve.trigger("updatedone",[{source:s,target:e}])}))}}function Ze(e,n,a,i){void 0===i&&(i=!0);var r=Ft(e,!1);if(r){var l=Je(e);if(l&&l.id){var o=we.get(l.id);if(o){var s=this,d=Array.from(arguments),c=Pt(e),u=r.match(/^([xy])(\d*)_/),p=u?u[1]:"",f=u?u[2]:"",h=[],g=o.getList(e),m=t(e).data("updating",!0);if(!m.data("hidden")){if(t.isUndefined(n)&&(n=g.parentFields.slice(),""!=f))for(var w=0,v=n.length;w<v;w++){1==n[w].split(" ").length&&(n[w]=n[w].replace(/^x_/,"x"+f+"_"))}if(Array.isArray(n)&&n.length>0)if(Array.isArray(n[0]))h=n;else if(t.isString(n[0]))for(w=0,v=n.length;w<v;w++)h.push(Pt(n[w],l));ot(e)||Lt(e);var b=function(t){var n=Ft(e);t.forEach((function(t){let a={data:t,parents:h,valid:!0,name:n,form:l};ve.trigger("addoption",[a]),a.valid&&jt(e,t,l)})),null==e.render||e.render(),$t(e,c,i),i&&!e.options&&e.length&&m.first().triggerHandler("click")};t.isUndefined(a)&&(a=g.ajax);var y=function(){/(srch|search|summary|crosstab)$/.test(l.id)&&"x"==p&&!f&&(d[0]=r.replace(/^x_/,"y_"),Xe.apply(s,d))};if(!t.isBoolean(a)||Array.isArray(g.lookupOptions)&&g.lookupOptions.length>0){var _=g.lookupOptions;return b(_),y(),m.first().trigger("updated",[{target:e}]),_}var E=Ft(e),A=Object.assign({page:g.page,field:g.field,ajax:"updateoption",language:ew.LANGUAGE_ID,name:E},Qe("#p_"+r,l));ot(e)&&s.htmlForm?A.v0=c[0]||an():(e.options&&!e.list&&!dt(e)||rt(e))&&(A.v0=c[0]?e.multiple?c.join(ew.MULTIPLE_OPTION_SEPARATOR):c[0]:an());w=0;for(var S=h.length;w<S;w++)A["v"+(w+1)]=h[w].join(ew.MULTIPLE_OPTION_SEPARATOR);return null==e.showLoading||e.showLoading(),t.ajax(Ae(ew.API_LOOKUP_ACTION),{method:"POST",dataType:"json",data:A,async:a,processData:!1,success:t=>{let n=De(t);if(n)return void Ge(n);let a=t.records||[];return b(a),y(),m.first().trigger("updated",[Object.assign({},t,{target:e})]),a},error:(e,t,n)=>Ge(n),complete:()=>m.data("updating",!1)})}}}}}function Qe(e,n){e=e.replace(/\[\]$/,"");var a={},i=((n=t.isString(n)?/^#/.test(n)?n:"#"+n:n)?t(n).find(e):t(e)).val();i&&new URLSearchParams(i).forEach((function(e,t){a[t]=e}));return a}function et(e,t,n){var a;let i=document.getElementById(e);null!=(a=i.children[0])&&a.matches("div[id^=ct_]")&&(i=i.children[0]);let r={customexport:t,data:i.innerHTML,[ew.TOKEN_NAME_KEY]:ew.TOKEN_NAME,[ew.ANTIFORGERY_TOKEN_KEY]:ew.ANTIFORGERY_TOKEN,...nt()};"email"==t?Xt(n,Ie(me.searchParams,r)):Me(Ae([ew.API_EXPORT_ACTION,t,n]),r)}function tt(e){return e&&["1","y","t","true"].includes(String(e).toLowerCase())}function nt(){let e=Array.from(Object.entries(window.exportCharts)).map((e=>{let[t,n]=e;return{chartEngine:"Chart.js",streamType:"base64",stream:n.toBase64Image(),fileName:t+".png"}}));return e.length?{charts:JSON.stringify(e)}:null}async function at(e){let{evt:n,url:a,export:i,custom:r,exportSelected:l,emailForm:o}=e,s=n.currentTarget.form;if(l&&(l=s&&!!s.querySelector("input[type=checkbox][name='key_m[]']")),l&&!gt(s))return Ge(ew.language.phrase("NoRecordSelected")),!1;let d=s?t(s):t('<form class="ew-export-form" method="post"></form>').appendTo(be),c=d.attr("target"),u=d.attr("action"),p=[[ew.TOKEN_NAME_KEY,ew.TOKEN_NAME],[ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN]];try{if(r){var f;document.body.style.cursor="wait";let e="ew-export-frame";a=xe(a,{export:i,custom:1},t(o).serialize()),null==(f=document.querySelector("iframe[name='"+e+"']"))||f.remove();let n=t("<iframe>").attr("name",e).addClass("d-none").appendTo(be);d.attr({action:a,target:e}),p.forEach((e=>{let[n,a]=e;return d.find('input[name="'+n+'"]').val(a)[0]||t("<input>").attr({type:"hidden",name:n,value:a}).appendTo(d)})),n.one("load",(()=>document.body.style.cursor="default")).one("load",(()=>d.attr({action:u,target:c}))),d.trigger("submit")}else a=Ce(a,"export",i),"print"==i?d.attr("action",a).trigger("submit"):Me(a,Ie(d.serialize(),nt()))}finally{s||d.remove()}return!1}function it(e){var n=t(e);return n.is(":hidden")&&n.data("editor")}function rt(e){var t;return null==e||null==(t=e.dataset)?void 0:t.modalLookup}function lt(e){var t;return null==e||null==(t=e.dataset)?void 0:t.filter}function ot(e){var n=t(e);return n.is(":hidden")&&n.data("autosuggest")}function st(e){return null==e||null==e.matches?void 0:e.matches("select.select2-hidden-accessible")}function dt(e){return(null==e||null==e.matches?void 0:e.matches("select:not(.select2-hidden-accessible)"))&&"select-one"==e.type}function ct(e){return(null==e||null==e.matches?void 0:e.matches("input:not([type=checkbox]):not([type=radio])"))&&!ot(e)}function ut(e){return null==e||null==e.matches?void 0:e.matches("input[type=checkbox][data-boolean]")}function pt(e,n){if(e){var a=t(e);if(!Ot(a)){if(it(e))return a.data("editor").focus();!e.options&&e.length?e=a[0]:ot(e)&&(e=e.input),e.focus(n)}}}function ft(e){if(!e)return;let n=t(e);if(Ot(n))return;!e.options&&e.length&&(e=n[0]);let a=n.closest(ye),i=()=>a.find(".is-valid").removeClass("is-valid");if(ot(e))a.find(".ew-auto-suggest").removeClass("is-invalid").addClass("is-valid").one("click keydown paste",i);else if(it(e))n.removeClass("is-invalid").addClass("is-valid"),n.data("editor").instance.once("change",i);else if(rt(e))n.removeClass("is-invalid").addClass("is-valid").one("select2:open",i);else if(["checkbox","radio"].includes(e.type))n.removeClass("is-invalid").addClass("is-valid").one("click keydown",i);else{let e=ew.MOBILE_DETECT.version("Safari")&&!ew.MOBILE_DETECT.version("Chrome")?"change keydown paste":"click keydown paste";n.parent().one(e,i),n.add(n.closest(".input-group")).removeClass("is-invalid").addClass("is-valid")}}function ht(e){null==e||e.scrollIntoView()}function gt(e){return!(null==e||!e.querySelector("input[type=checkbox][name='key_m[]']:checked"))}function mt(e){null!=e&&e.form&&t(e.form.elements).filter("input[type=checkbox][name^="+e.name+"_], [type=checkbox][name="+e.name+"]").not(e).not(":disabled").prop("checked",e.checked)}function wt(e){let n=t(e).find("input[type=checkbox][name='key_m[]']:checked").closest("[data-rowindex]").map(((e,t)=>t.dataset.rowindex)).get();t(null==e?void 0:e.rows).filter(((e,t)=>t.classList.contains("table-active")&&!n.includes(t.dataset.rowindex))).removeClass("table-active ew-table-selected-row").triggerHandler("change")}function vt(e){if(!(null==e?void 0:e.closest(".ew-table")))return;let n=t(e).closest(".ew-table > tbody > tr");n.siblings("[data-rowindex='"+n.data("rowindex")+"']").addBack().removeClass("table-active").triggerHandler("change")}function bt(e){let n=null==e?void 0:e.closest(".ew-table");if(!n)return;wt(n);let a=t(e).closest(".ew-table > tbody > tr");a.siblings("[data-rowindex='"+a.data("rowindex")+"']").addBack().addClass("table-active").triggerHandler("change")}function yt(){let e,n;t.isNumber(arguments[0])?e=arguments[1]:arguments[0]instanceof HTMLTableElement&&(e=arguments[0],n=arguments[1]);let a=t(e),i=t(e.rows);if(!e||!e.rows||!n&&e.dataset.isset||0==e.tBodies.length)return;let r=function(e){let n=t(this),a=this.closest(".ew-table"),i=t(e.target);!a||i.hasClass("btn")||i.hasClass("ew-preview-btn")||i.is(":input")||(wt(a),n.siblings("[data-rowindex='"+n.data("rowindex")+"']").addBack().toggleClass("table-active").triggerHandler("change"))},l=i.filter("[data-rowindex=1]").length||i.filter("[data-rowindex=0]").length||1,o=i.filter(":not(.ew-template)").each((function(){t(this.cells).removeClass("ew-table-last-row").last().addClass("ew-table-last-col")})).get();if(o.length>=l){let t=a.parentsUntil(".ew-grid","."+ew.RESPONSIVE_TABLE_CLASS)[0];o[o.length-1].classList.add("border-bottom-0"),o.splice(-1*l).forEach(((n,a)=>Array.from(n.cells).filter((e=>e.rowSpan==a+1)).forEach((n=>{n.classList.add("ew-table-last-row"),n.classList.toggle("ew-table-border-bottom",(null==t?void 0:t.clientHeight)>e.offsetHeight)}))))}let s=e.closest("form"),d=s&&t(s.elements).filter("input#action:not([value^=grid])").length>0;t(e.tBodies[e.tBodies.length-1].rows).filter(":not(.ew-template):not(.ew-table-preview-row)").each((function(){let e=t(this);d&&!e.data("isset")&&e.on("click",r).data("isset",!0)})),_t(e.closest(".ew-grid"),n),e.dataset.isset="true"}function _t(e,n){let a=t(e);if(e&&(n||!e.dataset.isset)){if(0!=a.find("table.ew-table > tbody").first().children("tr:not(.ew-table-preview-row, .ew-template)").length||e.querySelector(".ew-grid-upper-panel, .ew-grid-lower-panel")||a.hide(),a.find(".ew-grid-middle-panel:visible").hasClass(ew.RESPONSIVE_TABLE_CLASS)&&a.width()>t(".content").width()&&(a.addClass("d-flex"),a.closest(".ew-detail-pages").addClass("d-block"),a.closest(".ew-form").addClass("w-100")),a.find(".ew-grid-middle-panel:visible")&&(!e.querySelector(".ew-grid-upper-panel")||a.find(".ew-grid-upper-panel:hidden")[0])){let e=a.find(".ew-grid-middle-panel:not(.overflow-y-auto):visible").addClass("rounded-top").children(".ew-table:not(.table-head-fixed):visible").first().children("thead:visible").first().children("tr:visible").first().children("th:visible");e.first().addClass("rounded-top-left"),e.last().addClass("rounded-top-right")}if(a.find(".ew-grid-middle-panel:visible")&&(!e.querySelector(".ew-grid-lower-panel")||a.find(".ew-grid-lower-panel:hidden")[0])){let e=a.find(".ew-grid-middle-panel:not(.overflow-y-auto):visible").addClass("rounded-bottom").children(".ew-table:not(.table-head-fixed):visible").last().children("tbody:visible").last().children("tr:visible").last().children("td:visible");e.first().addClass("rounded-bottom-left"),e.last().addClass("rounded-bottom-right")}e.dataset.isset="true"}}function Et(e){return String(e).replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">")}function At(e,n){let a=(n=t.isString(n)?/^#/.test(n)?n:"#"+n:n)?t(n):ve,i=[],r=e=>"[data-field='"+e+"']:not(.ew-custom-option):not([name^=y_]):not([data-old])";if(e instanceof HTMLElement&&e.dataset.table&&e.dataset.field){if(ut(e))return e;i=["[data-table='"+e.dataset.table+"']"+r(e.dataset.field)]}else if(t.isString(e)){let[t,n]=e.split(" ");i=n?["[data-table='"+t+"']"+r(Ft(n))]:["[name='"+e+"']:not(.ew-custom-option):not([data-old])",r(Ft(e))]}let l=["input","select","textarea","button","selection-list"].flatMap((e=>i.map((t=>e+t)))).join(),o=a.find(l);return a.is("form.ew-form")&&a.find("div.ew-form")[0]&&(o=o.not("div.ew-form *")),1==o.length&&(o.is(":not([type=checkbox]):not([type=radio])")||ut(o[0]))||2==o.length&&o.eq(0).is("selection-list")&&o.eq(1).is("input[type=hidden]")?o[0]:o[0]?o.get():null}function St(e,n){n=t.isString(n)?/^#/.test(n)?n:"#"+n:n;let a="#"+e.replace(/([\$\[\]])/g,"\\$1")+",[name='"+e+"']";return n?t(n).find(a)[0]:t(a).first()[0]}function Tt(e,t){for(;e=e.parentNode;){var n;if(1==(null==(n=e)?void 0:n.nodeType)&&(!t||t(e)))return e}return null}function Ot(e){var n=t(e);return"none"==n.css("display")&&!n.is("selection-list")&&!n.closest(".dropdown-menu")[0]&&!rt(e)&&!ot(e)&&!it(e)||null!=Tt(e,(e=>"none"==e.style.display&&!e.classList.contains("tab-pane")&&!e.classList.contains("collapse")))}function xt(e,t){return String(e).toLowerCase()==String(t).toLowerCase()}function It(e){return e?String(e).replace(/^[^A-Za-z0-9]*|[^A-Za-z0-9]*$/g,"").replace(/([a-z])([A-Z])/g,((e,t,n)=>t+"_"+n.toLowerCase())).replace(/[^A-Za-z0-9]+|_+/g,"-").toLowerCase().replace(/(-?)(\w+)(-?)/g,((e,t,n,a)=>t+n.charAt(0).toUpperCase()+n.slice(1)+a)):""}function Ct(e,t){if((e=e instanceof URL?e.pathname:Se(e).pathname)!=(t=t instanceof URL?t.pathname:Se(t).pathname)&&e.startsWith(ew.PATH_BASE)&&t.startsWith(ew.PATH_BASE)){e=e.substring(ew.PATH_BASE.length),t=t.substring(ew.PATH_BASE.length);let n=e.split("/"),a=t.split("/");if(n[0]==a[0]&&n[0].match(/(list|view|edit)$/i)||n[0]==a[0]&&n[1]==a[1]&&[ew.LIST_ACTION,ew.VIEW_ACTION,ew.EDIT_ACTION].includes(n[1]))return!0}return e==t}function Pt(e,n){let a=e;if(t.isString(e)?a=2==e.split(" ").length?At(e):At(e,n):["checkbox","radio"].includes(e.type)&&(a=At(e)),!a)return[];if(a.options){if(a.list)return a.values;if(st(a)){let e=t(a).val();return Array.isArray(e)?e:t.isValue(e)?[e]:[]}return Array.from(a.options).filter((e=>e.selected&&""!==e.value)).map((e=>e.value))}return Array.isArray(a)||ut(a)?t(a).filter(":checked").map((function(){return this.value})).get():ew.isHiddenTextArea(a)?(t(a).data("editor").save(),[a.value]):[a.value]}function Nt(e,t){return Pt(e,t).join(ew.MULTIPLE_OPTION_SEPARATOR)}function Rt(e,n){let a=e;return t.isString(e)?a=2==e.split(" ").length?At(e):At(e,n):["checkbox","radio"].includes(e.type)&&(a=At(e)),a?ot(a)?[a.input.value]:a.options?st(a)?t(a).find(":selected").map(((e,t)=>t.innerHTML)).get():Array.from(a.options).filter((e=>e.selected&&""!==e.value)).map((e=>e.text)):Array.isArray(a)||ut(a)?t(a).filter(":checked").map((function(){return t(this).parent().text()})).get():ew.isHiddenTextArea(a)?(t(a).data("editor").save(),[a.value]):[a.value]:[]}function Lt(e){if(e.options){var t="select-multiple"==e.type||e.hasAttribute("data-dropdown")||e.length>0&&""!=e.options[0].value?0:1;if(e.list)e.removeAll(),e.render();else for(var n=e.length-1;n>=t;n--)e.remove(n);ot(e)&&(e.input.value="",e.value="")}}function Ft(e,n){var a=t.isString(e)?e:t(e).attr("name")||t(e).attr("id");return!1!==n?a.replace(/\[\]$/,""):a}function kt(e,n){var a=t(n).data("value-separator");return Array.isArray(a)?a[e-1]:a||", "}function Dt(e,n){return[e.df,e.df2,e.df3,e.df4].reduce(((e,a,i)=>{let r=i>0?kt(i,n):"";return!t.isUndefined(r)&&t.isValue(a)&&""!=a?e+r+a:e}),"")}function Mt(e){return ew.OPTION_HTML_TEMPLATE.replace(/\{value\}/g,e)}function jt(e,t,n,a){let i=we.get(n.id),r=Ft(e),l=i.getList(e),o=t.gf,s=t.lf,d=i.getOptionTemplate(l),c=null!=d&&d.render&&!ot(e)?d.render(t,ew.jsRenderHelpers):Dt(t,e)||s;if(e.options){let i;e.list?i=new ew.SelectionListOption(c,s,!!a):(i=document.createElement("option"),i.value=s,i.innerHTML=c,i.selected=!!a);let l={name:r,form:n.$element,data:t,group:o,option:i};if(ve.trigger("newoption",[l]),e.list)e.addOption(l.option);else if(l.group&&!st(e)){var u;let t=Array.from(null!=(u=e.querySelector(":scope > optgroup"))?u:[]).find((e=>e.label==l.group));t||(t=document.createElement("optgroup"),t.label=l.group,e.add(t)),t.appendChild(l.option)}else e.add(l.option);return l.option.text}return c}function $t(e,n,a){var i,r;if(void 0===a&&(a=!0),!e||!n)return;let l=t(e);if(n=Array.isArray(n)?n:[n],e.options){var o;if(e.list)e.value=n;else l.val(n),a&&st(e)&&l.triggerHandler("change"),"select-one"!=e.type||-1!=e.selectedIndex||null!=(o=e.options[0])&&o.value||(e.selectedIndex=0);if(ot(e)&&1==n.length){let t=e.options||[];for(let a of t)if(a.value==n[0]){e.value=a.value,e.input.value=a.text;break}}}else ut(e)?e.checked=tt(n.join(ew.MULTIPLE_OPTION_SEPARATOR)):e.type&&"file"!=e.type&&(l.val(n.join(ew.MULTIPLE_OPTION_SEPARATOR)),it(l)&&l.data("editor").set());if("false"===(null==(i=e.dataset)?void 0:i.autoselect))return;let s=Je(e);if(s&&!(s.id.endsWith("search")||s.id.endsWith("srch")||0===(null==(r=we.get(s.id).getList(e))||null==(r=r.parentFields)?void 0:r.length))&&e.options&&(e.list||"select-one"!=e.type||2!=e.options.length||e.options[1].selected?1!=e.options.length||e.options[0].selected||(e.options[0].selected=!0,!a||l.trigger("change")):(e.options[1].selected=!0,!a||l.trigger("change")),ot(e))){let t=e.options||[];1==t.length&&(e.value=t[0].value,e.input.value=t[0].text)}}function Ut(e,t){var n;null!=t||(t={}),t.headers=new Headers(t.headers||{}),e.startsWith(Ae())&&ew.API_JWT_TOKEN&&t.headers.set(ew.API_JWT_AUTHORIZATION_HEADER,"Bearer "+ew.API_JWT_TOKEN),null!=(n=t.headers)&&null!=(n=n.get("Content-Type"))&&n.includes("application/json")&&(t.headers.set(It(ew.TOKEN_NAME_KEY),ew.TOKEN_NAME),t.headers.set(It(ew.ANTIFORGERY_TOKEN_KEY),ew.ANTIFORGERY_TOKEN)),!t.method||xt(t.method,"GET")?(e=xe(e,t.body),delete t.body):t.body instanceof FormData?(t.body.set(ew.TOKEN_NAME_KEY,ew.TOKEN_NAME),t.body.set(ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN)):t.body=Ie(t.body,{[ew.TOKEN_NAME_KEY]:ew.TOKEN_NAME,[ew.ANTIFORGERY_TOKEN_KEY]:ew.ANTIFORGERY_TOKEN});let a={url:e,init:t};return ve.trigger("fetch",[a]),fetch(a.url,a.init)}function Bt(e,t,n){let a=n?/<(head)[^>]*>[\s\S]*?<\/\1\s*>/gi:/<(head|template)[^>]*>[\s\S]*?<\/\1\s*>/gi,i=e.replaceAll(a,"").matchAll(/<script[^>]*>[\s\S]*?<\/script\s*>/gi);Array.from(document.createRange().createContextualFragment(Array.from(i).map((e=>e[0])).filter((e=>!e.includes("$rowindex$"))).join("")).querySelectorAll("script:not([type]), script[type='text/javascript']")).sort(((e,t)=>t.classList.contains("ew-apply-template")?1:e.classList.contains("ew-apply-template")?-1:0)).forEach(((e,n)=>Vt(e,"scr_"+t+"_"+n)))}function Kt(e){let t=e.replaceAll(/<(head|template)[^>]*>[\s\S]*?<\/\1\s*>/gi,"").matchAll(/<script([^>]*)>([\s\S]*?)<\/script\s*>/gi);return Array.from(t).filter((e=>document.createRange().createContextualFragment(e[0]).querySelector("script:not([type]), script[type='text/javascript']"))).reduce(((e,t)=>e.replace(t[0],"")),e)}function Vt(e,n){let a=e instanceof HTMLScriptElement?e:document.createElement("SCRIPT");return t.isString(e)&&(a.text=e),n&&(a.id=n),document.body.appendChild(a)}function qt(e){e&&t("script[id^='scr_"+e+"_']").remove()}function Ht(e,n){var a;e=e.trim().replace(/<head>[\s\S]*<\/head>/,"");let i=n?e:Kt(e),r=i.match(/<body[\s\S]*>[\s\S]*<\/body>/i);i=null!=(a=null==r?void 0:r[0])?a:i;let l=t(i).find("section.content");return l[0]?l.html():i}function Gt(e){return null!=e&&e.options?Array.prototype.map.call(e.options,(e=>[e.value,e.text])):[]}function Wt(){let e=t(this),n=e.data("args"),a=e.removeData("args").find(".modal-body form").data("form");qt("modal_dialog"),null==a||a.destroyEditor(),e.find(".modal-footer .btn-primary").off(),e.find(".modal-dialog").removeClass(((e,t)=>{let n=t.match(/table\-\w+/);return n?n[0]:""})),e.data({showing:!1,url:null}),null!=n&&n.reload&&window.location.reload()}function Yt(e){let n=we.get(e).$element[0];if(!n)return;let a=Pt(e),i=Ft(e),r=i.match(/^([xy])(\d*)_/),l=r?r[2]:"",o=we.get(e).getList(i),s=o.autoFillTargetFields,d=function(a){let r=null==a?void 0:a.records,o=Array.isArray(r)&&r.length>0?r[0]:[];for(let a=0;a<s.length;a++){let d=At(s[a].replace(/^x_/,"x"+l+"_"),n);if(d){let l=t.isValue(o["af"+a])?String(o["af"+a]):"",c={results:r,result:o,data:l,form:n,name:i,target:s[a],cancel:!1,trigger:!0};if(t(e).trigger("autofill",[c]),c.cancel)continue;l=c.data,d.options?($t(d,l.split(",")),ot(d)&&(d.input.value=l,Xe.call(we.get(n.id),d))):it(d)?(d.value=l,t(d).data("editor").set()):"checkbox"==d.type?d.checked=tt(l):d.value=l,c.trigger&&t(d).trigger("change")}}return o};if(a.length>0&&""!=a[0]){let e=Object.assign({page:o.page,field:o.field,ajax:"autofill",v0:a[0],language:ew.LANGUAGE_ID},Qe("#p_"+i,n)),r=o.parentFields.slice();if(""!=l)for(let e=0,t=r.length;e<t;e++){1==r[e].split(" ").length&&(r[e]=r[e].replace(/^x_/,"x"+l+"_"))}return r.map((e=>Nt(e,n))).forEach(((t,n)=>e["v"+(n+1)]=t)),t.post(Ae(ew.API_LOOKUP_ACTION),e,d,"json")}return d()}function zt(e,n){var a=t(n),i=t("#"+a.data("tooltip-id")),r=a.data("trigger")||"hover",l=a.data("placement")||"auto";i[0]&&(""!=i.text().trim()||i.find("img[src!='']")[0])&&(bootstrap.Popover.getInstance(n)||a.popover({...ew.popoverOptions,placement:l,trigger:r,delay:100,container:document.getElementById("ew-tooltip"),content:i.html()}).on("show.bs.popover",(function(){var e=a.data("tooltip-width");e&&t(bootstrap.Popover.getInstance(this)._getTipElement()).css("max-width",parseInt(e,10)+"px")})))}function Jt(e){var n;let a=null!=(n=null==e?void 0:e.target)?n:document,i=null==a?void 0:a.querySelector(".ew-filter-option");ew.CLIENT_SEARCH_FILTER||ew.SERVER_SEARCH_FILTER&&ew.IS_LOGGEDIN&&!ew.IS_SYS_ADMIN&&""!=ew.CURRENT_USER_NAME?t(i).removeClass("d-none").find(".ew-btn-dropdown").on("show.bs.dropdown",(function(e){var n,a;let i=t(this).find(".ew-save-filter[data-form], .ew-delete-filter[data-form]").data("form"),r=ew.forms.get(i),l=ew.CLIENT_SEARCH_FILTER?ew.parseJson(localStorage.getItem(ew.PROJECT_NAME+"_"+r.id+"_filters")||"[]")||[]:null!=(n=null==r||null==(a=r.filterList)?void 0:a.filters)?n:[];r.setupFilters(e,l.filter((e=>Array.isArray(e)&&2==e.length)))})):null==i||i.classList.add("d-none")}function Xt(e,t){let n=window.parent.Swal;return t=Ie(t,[[ew.TOKEN_NAME_KEY,ew.TOKEN_NAME],[ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN]]),n.fire({...ew.sweetAlertSettings,showConfirmButton:!1,html:"<p>"+ew.language.phrase("Exporting")+"</p>",allowOutsideClick:!1,allowEscapeKey:!1,willOpen:()=>{n.showLoading(),Ut(Ae([ew.API_EXPORT_ACTION,"email",e])+"?rnd="+an(),{method:"POST",body:t}).then((async a=>{n.hideLoading();let i=await a.json();var r;null!=i&&i.success?(n.update({html:"<div class='text-success'>"+i.message+"</div>"}),ve.trigger("export",[{type:"done",tblVar:e,data:t,result:i}])):(n.update({html:null!=(r="<div class='text-danger'>"+De(i))?r:ew.language.phrase("FailedToExport")+"</div>"}),ve.trigger("export",[{type:"fail",tblVar:e,data:t,result:i}]))})).catch((a=>{var i;n.hideLoading(),n.update({html:null!=(i="<div class='text-danger'>"+a)?i:ew.language.phrase("FailedToExport")+"</div>"}),ve.trigger("export",[{type:"fail",tblVar:e,data:t,error:a}])})).finally((()=>{n.update({showConfirmButton:!0}),ve.trigger("export",[{type:"always",tblVar:e,data:t}])}))}})}function Zt(){return location.href.split("#")[0].split("?")[0]}function Qt(e){var n,a;const i=(null==(n=e=t.isString(e)?document.querySelector(e):e)?void 0:n.value)||(null==(a=e)?void 0:a.innerText);if(i){const e=document.createElement("textarea");e.value=i,e.setAttribute("readonly",""),e.style.position="absolute",e.style.left="-9999px",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}return i}function en(e){return!(e=String(e))||0==e.length||(e=e.trim(),null!==ew.parseNumber(e))}function tn(e){return!e||0==e.length||/^[\w.%+-]+@[\w.-]+\.[A-Z]{2,18}$/i.test(e.trim())}function nn(e){var n;let a,i;try{[a,i]=[window.parent.document,window.parent.Swal]}catch(e){[a,i]=[window.document,window.Swal]}let r=null!=(n=null==e?void 0:e.target)?n:a,l=t(r).find("div.ew-message-dialog.d-none").first(),o=l.length?l.text():"";if(t.isString(e)&&(o=t("<div>"+e.trim()+"</div>").text()),""!=o.trim())return l.length&&["success","info","warning","danger"].forEach((function(e){let t=l.find(".alert-"+e).toggleClass("alert-"+e),n=t.find(".alert-heading").detach(),a=t.children(":not(.icon)");if(t.find(".icon").remove(),t[0]){let i=parseInt(a.css("width"),10);i>0&&a.first().css("width","auto");let r=ze(t.html(),e,n.html());i>0&&r.css("max-width",i)}else;})),t.isString(e)?i.fire({...ew.sweetAlertSettings,html:e}):void 0}function an(){return Math.floor(100001*Math.random())+1e5}Pace.on("done",(()=>{var e;let t=document.querySelector(".modal.show form.ew-form")||document.querySelector("form.ew-form");null==(e=we.get(null==t?void 0:t.id))||e.tryFocus()})),ve.on("ajaxSend",(function(e,n,a){let i=a.url,r=i.startsWith(Ae()),l=r||i.startsWith(ew.PATH_BASE)||i.startsWith(Zt());if(!l&&i.match(/^http/i)){l=new URL(i).hostname==me.hostname}if(l)if(r&&ew.API_JWT_TOKEN&&n.setRequestHeader(ew.API_JWT_AUTHORIZATION_HEADER,"Bearer "+ew.API_JWT_TOKEN),t.isString(a.contentType)&&a.contentType.includes("application/json"))n.setRequestHeader(It(ew.TOKEN_NAME_KEY),ew.TOKEN_NAME),n.setRequestHeader(It(ew.ANTIFORGERY_TOKEN_KEY),ew.ANTIFORGERY_TOKEN);else if(xt(a.type,"POST"))if(a.data instanceof FormData)a.data.set(ew.TOKEN_NAME_KEY,ew.TOKEN_NAME),a.data.set(ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN);else{let e=Ie(new URLSearchParams(a.data),{[ew.TOKEN_NAME_KEY]:ew.TOKEN_NAME,[ew.ANTIFORGERY_TOKEN_KEY]:ew.ANTIFORGERY_TOKEN});a.data=e.toString()}})),ve.on("ajaxStart",(function(){ve.data("_ajax",!0),t("form.ew-form").addClass("ew-wait").each((function(){let e=we.get(this.id);e&&(e.multiPage&&e.multiPage.lastPageSubmit||e.disableForm())}))})),ve.on("ajaxStop ajaxError",(function(){t("form.ew-form.ew-wait").removeClass("ew-wait").each((function(){let e=we.get(this.id);e&&(e.multiPage&&e.multiPage.lastPageSubmit||e.enableForm())})),ve.data("_ajax",!1)}));let rn=n.DateTime,ln=n.Interval;function on(e,n){let a;return t.isString(e)?a=rn.fromSQL(e,{zone:"utc"}):t.isNumber(e)?a=rn.fromSeconds(e,{zone:"utc"}):e instanceof Date?a=rn.fromJSDate(e,{zone:"utc"}):e instanceof rn&&(a=e),a.toFormat(n,{locale:ew.LANGUAGE_ID,numberingSystem:ew.getNumberingSystem()})}function sn(e,t){return rn.fromFormat(e,t,{locale:ew.LANGUAGE_ID,numberingSystem:ew.getNumberingSystem()})}function dn(e,t,n,a){var i;let r;if((null!=(i=ew.vars)&&i.login?Array.from(Object.entries(ew.vars.login)).filter((e=>e[0].endsWith("Url"))).map((e=>e[1])):[]).includes(e))return window.location=e,!1;if(e.startsWith("http"))r=new URL(e);else{if(!e.startsWith("/"))return Ge(ew.language.phrase("IncorrectUrl")),!1;r=new URL(e,location.protocol+"//"+location.host)}let l=r.searchParams;if(a&&(l=Ie(l,a)),xt(n,"post")){const n=t||document.createElement("form");n.method="post",n.action=e.split("?")[0],document.body.appendChild(n),l.set(ew.TOKEN_NAME_KEY,ew.TOKEN_NAME),l.set(ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN),l.forEach(((e,t)=>{const a=document.createElement("input");a.type="hidden",a.name=t,a.value=ew.sanitize(e),n.appendChild(a)})),n.submit()}else window.location=Le(r.toString());return!1}function cn(){return window.matchMedia(ew.screenMediaQuery).matches}function un(e,n){null!=n||(n=".ew-card.ew-grid"),n=n.startsWith(".")||n.startsWith("#")?n:"."+n;let a=document.querySelector(n+", .ew-multi-column-grid, .ew-view-form, .ew-edit-form, .ew-calendar, ew-dashboard, main.ew-no-record"),i=document.querySelector(".ew-dashboard");if(!a)return;let r=t(ew.overlayTemplate()),l=t(a).addClass("ew-loading").toggleClass("overlay-wrapper",!a.classList.contains("card")).append(r);return e.then((async e=>{if(!(e instanceof Response))return e;let r=e.headers.get("Content-Type");if(null!=r&&r.includes("json")){let n=await e.json(),r=n.validation,l=De(n),o=a.querySelector(".ew-form"),s=ew.forms.get(o);if(i)for(let e in n)t("#"+e).find(".card-body").html(""),t("#"+e).find("[data-card-widget='card-refresh']").CardRefresh("load");else if(s&&r){for(let[e,n]of Object.entries(r))if(e=parseInt(e,10),t.isNumber(e)&&t.isObject(n)){o.dataset.rowindex=e;for(let[t,a]of Object.entries(n))s.addCustomError(t,a,e)}else t.isString(n)&&s.addCustomError(e,n);s.focus()}return l?ze(l):t.isString(n.warningMessage)?ze(n.warningMessage,"warning"):t.isString(n.message)?ze(n.message,"body"):t.isString(n.successMessage)&&ze(n.successMessage,"success"),!1}let o=await e.text(),s=new URL(e.url),d=[".ew-message-dialog",".ew-chart-top",".ew-chart-bottom",".ew-debug .card-body",".ew-timer",".ew-dashboard"];"false"==s.searchParams.get("layout")&&(o="<div>"+o+"</div>",s.searchParams.delete("layout")),s.searchParams.delete("rnd"),s.searchParams.delete("action"),o=Ht(o,!0);let c=t("<div>"+o+"</div>");a.closest(".ew-dashboard")||(d.unshift(".ew-toolbar"),Ct(s,me)&&me.toString()!=s.toString()&&window.history.pushState(null,"",s.toString())),d=c.find("main.ew-no-record")[0]||l.is("main.ew-no-record")?[".ew-ext-search-form","main",...d]:l.hasClass("ew-view-form")?[".ew-view-form",".ew-pager",...d]:l.hasClass("ew-edit-form")?[".ew-edit-form",".ew-pager",...d]:l.hasClass("ew-multi-column-grid")?[".ew-ext-search-form",".ew-multi-column-grid",...d]:["#ew-filter-list",".ew-ext-search-form",n+" .card-header",n+" .card-body",n+" .card-footer",...d],d.forEach((e=>t(e).each(((n,a)=>{let i=t(a),r=c.find(e).eq(n);if(i[0]&&r[0]&&(delete a.dataset.isset,i.html(r.html()),i.attr("class",r.attr("class"))),".ew-toolbar"==e){let e={target:a};_e(e),Jt(e)}else if(".ew-ext-search-form"==e){ew.initForms({target:r[0]});let e=r.find("#navbar-basic-search");if(e[0]){let n=e.render(null,ew.jsRenderHelpers),a=t(n),i=a.find("#"+ew.TABLE_BASIC_SEARCH),r=a.find("#"+ew.TABLE_BASIC_SEARCH_TYPE);i.val()==t("#"+ew.TABLE_BASIC_SEARCH).val()&&r.val()==t("#"+ew.TABLE_BASIC_SEARCH_TYPE).val()||t(".nav-item.navbar-basic-search").replaceWith(a)}i.find(".ew-search-operator .form-select.ew-operator-select").each(((e,t)=>Ve(t)))}else".ew-message-dialog"==e&&(r.hasClass("d-none")||i.html(r.html()))})))),d.filter((e=>".ew-message-dialog"!=e)).forEach((e=>c.find(e).remove())),qt("refresh"),Bt(c.html(),"refresh");let u=t.Event({type:"load.ew",target:a});ew.initPage(u),a.querySelectorAll(".btn-group").forEach((e=>{var t;return null==(t=bootstrap.Tooltip.getInstance(e))?void 0:t.update()})),t(".toast.show").toast("dispose"),nn({target:c}),ve.trigger(u),ve.trigger(t.Event({type:"refresh.ew",target:a}))})).finally((()=>l.removeClass("ew-loading").find(r).remove()))}var pn;var fn={__proto__:null,AjaxLookup:b,AutoSuggest:y,Field:m,Form:w,Select2Defaults:ge,Select2Utils:J,_export:at,addEventHandlers:function(e){let n=ew.events[e];if(n)for(const[a,i]of Object.entries(n))t("[data-table="+e+"][data-field="+a+"]").on(i)},addGridRow:function(e){var n;let a=null==e?void 0:e.closest(".ew-grid"),i=t(a).find("table.ew-table").last(),r=i.parent("div"),l=i.find("tr.ew-template");if(!(e&&a&&i[0]&&l[0]))return!1;let o=t(i[0].rows).last();i.find("td.ew-table-last-row").removeClass("ew-table-last-row");let s=l.clone(!0,!0).removeClass("ew-template"),d=a.querySelector("div.ew-form[id^=f][id$=grid]")||a.querySelector("form.ew-form[id^=f][id$=list]")||a.querySelector("form.ew-form[id^=f][id$=grid]"),c=t(d),u=c.is("div")?"_"+d.id:"",p=c.find("#"+ew.FORM_KEY_COUNT_NAME+u),f=parseInt(p.val(),10)+1,h=ew.FORM_ROW_ACTION_NAME.replace(/^k_/,"k"+f+"_")+u,g=l.find("script:contains('$rowindex$')").add("tr.ew-template + script[data-rowindex='$rowindex$']");s.attr({id:"r"+f+s.attr("id").substring(2),"data-rowindex":f}),s.children("td").each((function(){t(this).find("*").each((function(){t.each(this.attributes,(function(e,t){t.value=t.value.replace(/\$rowindex\$/g,f)}))}))}));let m=s.find(".ew-icon").closest("a, button");null==(n=bootstrap.Tooltip.getInstance(m[0]))||n.dispose(),m.tooltip({...ew.tooltipOptions,container:"body",trigger:"hover"}),p.val(f).after(t("<input>").attr({type:"hidden",id:h,name:h,value:"insert"})),o.after(s),g.get().forEach((e=>Vt(e.text.replace(/\$rowindex\$/g,f))));let w=c.data("form");return null==w||w.initEditors(),null==w||w.initUpload(),yt(i[0],!0),r.scrollTop(r[0].scrollHeight),i.trigger("rowadded",[f]),!1},addOptionDialogShow:function(e){var n;e.lnk=e.lnk||(null==(n=e.evt)?void 0:n.currentTarget);var a=ew.addOptionDialog||t("#ew-add-opt-dialog").on("hidden.bs.modal",(function(){qt(a.data("args").el);var e=a.removeData("args").find(".modal-body form").data("form");e&&e.destroyEditor(),a.find(".modal-body").html(""),a.find(".modal-footer .btn-primary").off(),a.data("showing",!1)}));if(a[0]){if(!a.data("showing")){a.data("showing",!0);var i=function(e){var n,i=e,r=a.data("args"),l=we.get(r.lnk),o=a.find(".modal-body form input[name='"+ew.API_OBJECT_NAME+"']").val(),s=r.el,d=/^x(\d+)_/,c=s.match(d),u=c?c[0]:"x_",p=c?c[1]:-1,f=s.replace(d,"x_"),h=l.getList(s);if(t.isString(e)&&(i=Ke(e)),null!=(n=i)&&n.success&&i[o]){a.modal("hide");var g=i[o],m=l.$element[0],w=At(s,m);if(w){var v=h.linkField,b=h.displayFields.slice(),y=h.filterFields.slice(),_=h.parentFields.slice();_.forEach(((e,t)=>{1==e.split(" ").length&&(_[t]=_[t].replace(/^x_/,u))}));var E=""!=v?g[v]:"",A={lf:E};if(b.forEach(((e,t)=>{e in g&&(A["df"+(t>0?t+1:"")]=g[e])})),y.forEach(((e,t)=>{e in g&&(A["ff"+(t>0?t+1:"")]=g[e])})),E&&b.length>0&&A.df){null===h.ajax&&h.lookupOptions.push(A);var S=_.map((e=>Pt(e,m)));r={data:A,parents:S,valid:!0,name:Ft(w),form:m};if(ve.trigger("addoption",[r]),r.valid){var T=Gt(w),O=jt(w,A,m);w.options&&(w.options[w.options.length-1].selected=!0,w.list&&t(w.target).find("input").last().trigger("focus"),ot(w)?(t(w).val(E).trigger("change"),t(w.input).val(O).trigger("focus")):t(w).trigger("change").trigger("focus"));var x=t(m),I=x.is("div")?"_"+m.id:"",C=x.find("#"+ew.FORM_KEY_COUNT_NAME+I).val();if(C>0)for(var P=1;P<=C;P++)if(P!=p){var N=At(f.replace(/^x/,"x"+P),m),R=Gt(N);JSON.stringify(T)==JSON.stringify(R)&&(jt(N,A,m),null==N.render||N.render())}}}}}else{var L;if(null!=(L=i)&&L.error){let e=De(i);e&&Ge(e)}else{var F,k,D=t("<div></div>").html(e).find("div.ew-message-dialog");if(D[0])F=D.html();else(F=(null==(k=i)?void 0:k.failureMessage)||e)&&""!=String(F).trim()||(F=ew.language.phrase("InsertFailed"));Ge(F)}}},r=function(e){a.modal("hide"),Ge("Server Error "+e.status+": "+e.statusText)},l=async function(e){let n=ew.addOptionDialog.find(".modal-body form")[0],a=we.get(n.id),l=null==e?void 0:e.target,o=t(l);return await a.canSubmit(e)&&(o.prop("disabled",!1).removeClass("disabled"),document.body.style.cursor="wait",t.post(Ae([ew.API_ADD_ACTION,n.elements[ew.API_OBJECT_NAME].value]),t(n).serialize(),i).fail(r).always((function(){a.enableForm(),o.prop("disabled",!1).removeClass("disabled"),document.body.style.cursor="default"}))),!1};a.modal("hide"),a.data("args",e);return t.get(e.url,(function(n){var i=we.get(e.lnk),r="x_",o=e.el.match(/^(x\d+_)/);o&&(r=o[1]);var s=i.getList(e.el),d=s.parentFields.slice().map((e=>1==e.split(" ").length?e.replace(/^x_/,r):e)),c=i.htmlForm,u=d.map((e=>Pt(e,c))),p=d.map((e=>Rt(e,c))),f=s.filterFieldVars.slice();a.find(".modal-title").html(t(e.lnk).closest(".ew-add-opt-btn").data("title")),a.find(".modal-body").html(Kt(n)),(c=a.find(".modal-body form")[0])&&t(c).on("keydown",(function(e){if("Enter"==e.key&&"TEXTAREA"!=e.target.nodeName)return l()})),ew.addOptionDialog=a.modal("show"),a.find(".modal-footer .btn-primary").click(l).focus(),c&&u.forEach(((e,t)=>{var n=At(f[t],c);n&&e[0]&&(ot(n)?(n.value=e[0],n.input.value=p[t][0],n.add(e[0],p[t][0],!0)):n.options||n.length?jt(n,{lf:e[0]},i,!0):n.value=e[0])})),Bt(n,e.el,!0),a.trigger("load.ew")})).fail(r),!1}}else Ge("DIV #ew-add-opt-dialog not found.")},addScript:Vt,ajax:function(e,n){if(t.isObject(e)&&(e.url||e.action)){var a;e.url?e.url.startsWith(Ae())?a=e.url.replace(Ae(),"").split("/")[0]:e.url.startsWith(ew.API_URL)&&(a=e.url.replace(ew.API_URL,"").split("/")[0]):(a=e.action,delete e.action);var i=Object.assign({},e),r=e=>{if(t.isObject(e)&&"OK"==e.result){var n=e.records;return Array.isArray(n)&&1==n.length?(n=n[0],Array.isArray(n)&&1==n.length?n[0]:n):n}return e},l=i.url||Ae(a),o=i.type||([ew.API_LIST_ACTION,ew.API_VIEW_ACTION,ew.API_DELETE_ACTION].includes(a)?"GET":"POST");if(delete i.url,delete i.type,i.dataType="json",!He(n)){var s=t.ajax({url:l,async:!1,type:o,data:i});return r(s.responseJSON)}t.ajax({url:l,type:o,data:i,success:function(e){n(r(e))}})}},alert:Ge,applyTemplate:function(e,n,a,i,r,l,o){let s={data:l||{},id:e,template:n,class:a,export:i,enabled:!0};if(ve.trigger("rendertemplate",[s]),s.enabled){var d;let a=o?document.querySelector("#ew-modal-dialog.show"):document.body,i=null==a||null==(d=a.querySelector("#"+n))?void 0:d.content;if(!i)return;if(i.querySelectorAll(".ew-slot").forEach((e=>{let t=e.name||e.id,n=a.querySelector("#"+t);null!=n&&n.content?(e.dataset.rowspan>1&&Array.prototype.slice.call(n.content.childNodes).forEach((t=>t.rowSpan=e.dataset.rowspan)),e.replaceWith(n.content.cloneNode(!0))):e.remove()})),t.views){let n=i.textContent,r=n.includes("{{")&&n.includes("}}");if(!r){let e=ew.jsRenderAttributes.map((e=>"["+e+"*='{{']["+e+"*='}}']")).join(",");r=i.querySelector(e)}if(r){let n=Array.prototype.slice.call(i.querySelectorAll("script"));n.forEach((e=>e.remove()));let r=document.createElement("div");r.appendChild(i);let l=r.innerHTML.replace(/{{([^}]+)}}/g,(e=>Et(e))),o=t.templates(l);a.querySelector("#"+e).innerHTML=o.render(s.data,ew.jsRenderHelpers),n.forEach((e=>document.body.appendChild(e)))}else a.querySelector("#"+e).appendChild(i)}else a.querySelector("#"+e).appendChild(i)}i&&"print"!=i&&et(e,i,r)},autoFill:Yt,buildUrl:Ne,checkByRegEx:function(e,t){return!e||0==e.length||!!e.match(t)},checkCreditCard:function(e){if(!e||0==e.length)return!0;var t=e.replace(/\D/g,"");if(0==t.length)return!1;for(var n,a=t.length%2!=1,i=0,r=0,l=t.length;r<l;r++)n=parseInt(t.charAt(r),10),a?(i+=(n*=2)%10,n/10>=1&&i++,a=!1):(i+=n,a=!0);return i%10==0},checkDate:function(e,t){return!e||0==e.length||sn(e,t).isValid},checkEmail:tn,checkEmails:function(e,t){if(!e||0==e.length)return!0;for(var n=e.replace(/,/g,";").split(";"),a=0,i=n.length;a<i;a++){if(t>0&&i>t)return!1;if(!tn(n[a]))return!1}return!0},checkGuid:function(e){return!e||0==e.length||/^(\{\w{8}-\w{4}-\w{4}-\w{4}-\w{12}\}|\w{8}-\w{4}-\w{4}-\w{4}-\w{12})$/.test(e.trim())},checkInteger:function(e){return!e||0==e.length||!e.includes(ew.DECIMAL_SEPARATOR)&&en(e)},checkNumber:en,checkPhone:function(e){return!e||0==e.length||/^\(\d{3}\) ?\d{3}( |-)?\d{4}|^\d{3}( |-)?\d{3}( |-)?\d{4}$/.test(e.trim())},checkRange:function(e,n,a){return!e||0==e.length||((t.isNumber(n)||t.isNumber(a))&&en(e)&&(e=ew.parseNumber(e)),!(null!==n&&e<n)&&!(null!==a&&e>a))},checkSsn:function(e){return!e||0==e.length||/^(?!000)([0-6]\d{2}|7([0-6]\d|7[012]))([ -]?)(?!00)\d\d\3(?!0000)\d{4}$/.test(e.trim())},checkTime:function(e,t){return!e||0==e.length||sn(e,t).isValid},checkUrl:function(e){if(!e||0==e.length)return!0;try{new URL(e)}catch(e){return!1}return!0},checkZip:function(e){return!e||0==e.length||/^\d{5}$|^\d{5}-\d{4}$/.test(e.trim())},clearDelete:vt,clearError:function(e){if(e.jquery){let t=e.attr("type");e="checkbox"==t||"radio"==t?e.get():e[0]}t(e).closest(ye).find(".invalid-feedback").html("")},clearOptions:Lt,clearSelected:wt,clickDelete:bt,confirmDelete:function(e){return bt(e),We(ew.language.phrase("DeleteConfirm"),(t=>{t&&(e.dataset.json&&e.href?ew.modalDialogShow({url:xe(e.href,{action:"delete"}),lnk:e,json:!0,callback:!0}):e.href?window.location=Le(xe(e.href,{action:"delete"})):vt(e))})),!1},convertToBool:tt,copyToClipboard:Qt,createFilter:function(e){if(e.selectId.includes("$rowindex$"))return;if(t.isObject(e.data)){let t=new ew.AjaxLookup(e.data);e.data=t.options.map((e=>({id:e.lf,text:t.formatResult({lf:e.lf,df:e.df,df2:e.df2,df3:e.df3,df4:e.df4})})))}if(t.isObject(e.ajax)){let n=e.ajax.limit,a=new ew.AjaxLookup({...e.ajax,action:"modal"});e.ajax={url:e=>{let t=e.page?(e.page-1)*n:-1;return a.getUrl(e.term,t)},type:"POST",dataType:"json",data:a.generateRequest.bind(a),delay:e.debounce,processResults:function(e){var t,n;return{results:a.transform(e).map((e=>({id:e.lf,text:a.formatResult({lf:e.lf,df:e.df,df2:e.df2,df3:e.df3,df4:e.df4})}))),pagination:{more:this.container.$results.find(".select2-results__option:not(.select2-results__option--load-more)").length+(null!=(t=null==(n=e.records)?void 0:n.length)?t:0)<a.recordCount}}},transport:(e,n,a)=>t.ajax(e).then((e=>{let t=De(e);!t||Ge(t),n(e)})).fail(a)}}let n=t("select[data-select2-id='"+e.selectId+"']").select2(e);n.on("select2:open",(function(){var n;null==(n=t(this).data("select2").$dropdown.find(".select2-search__field").addClass("form-control")[0])||n.focus({preventScroll:e.preventScroll})})),t.isObject(e.ajax)&&n.on("select2:opening",(function(){t(this).data("select2").$results.find(".select2-results__option:not(.loading-results)").remove()}))},createModalLookup:function(e){if(e.selectId.includes("$rowindex$"))return;if(t.isObject(e.data)){let t=new ew.AjaxLookup(e.data);e.data=t.options.map((e=>({id:e.lf,text:t.formatResult({lf:e.lf,df:e.df,df2:e.df2,df3:e.df3,df4:e.df4})})))}if(t.isObject(e.ajax)){let n=e.ajax.limit,a=new ew.AjaxLookup({...e.ajax,action:"modal"});e.ajax={url:e=>{let t=e.page?(e.page-1)*n:-1;return a.getUrl(e.term,t)},type:"POST",dataType:"json",data:a.generateRequest.bind(a),delay:e.debounce,processResults:function(e){var t,n;return{results:a.transform(e).map((e=>({id:e.lf,text:a.formatResult({lf:e.lf,df:e.df,df2:e.df2,df3:e.df3,df4:e.df4})}))),pagination:{more:this.container.$results.find(".select2-results__option:not(.select2-results__option--load-more)").length+(null!=(t=null==(n=e.records)?void 0:n.length)?t:0)<a.recordCount}}},transport:(e,n,a)=>t.ajax(e).then((e=>{let t=De(e);!t||Ge(t),n(e)})).fail(a)}}let n=t("select[data-select2-id='"+e.selectId+"']").select2(e);n.on("select2:open",(function(){var e;null==(e=t(this).data("select2").$dropdown.find(".select2-search__field").addClass("form-control")[0])||e.focus()})),t.isObject(e.ajax)&&n.on("select2:opening",(function(){t(this).data("select2").$results.find(".select2-results__option:not(.loading-results)").remove()}))},createSearchParams:Te,createSelect:function(e){if(e.selectId.includes("$rowindex$"))return;if(t.isObject(e.data)){let t=new ew.AjaxLookup(e.data);e.data=t.toSelect2Data(t.options)}if(t.isObject(e.ajax)){let n=e.ajax.limit,a=new ew.AjaxLookup({...e.ajax,action:"modal"});e.ajax={url:e=>{let t=e.page?(e.page-1)*n:-1;return a.getUrl(e.term,t)},type:"POST",dataType:"json",data:a.generateRequest.bind(a),delay:e.debounce,processResults:function(e){var t,n;return{results:a.toSelect2Data(a.transform(e)),pagination:{more:this.container.$results.find(".select2-results__option:not(.select2-results__option--load-more)").length+(null!=(t=null==(n=e.records)?void 0:n.length)?t:0)<a.recordCount}}},transport:(e,n,a)=>t.ajax(e).then((e=>{let t=De(e);!t||Ge(t),n(e)})).fail(a)}}let n={name:e.name,options:e};ve.trigger("select2",[n]);let a=t("select[data-select2-id='"+e.selectId+"']").select2(n.options);a.on("select2:open",(function(){var e;null==(e=t(this).data("select2").$dropdown.find(".select2-search__field")[0])||e.focus()})),t.isObject(e.ajax)&&a.on("select2:opening",(function(){t(this).data("select2").$results.find(".select2-results__option:not(.loading-results)").remove()})),e.minimumResultsForSearch===1/0&&a.on("select2:opening select2:closing",(function(){t(this).data("select2").$dropdown.find(".select2-search--dropdown").addClass("select2-search--hide")}))},currentPage:Zt,currentUrl:me,deleteGridRow:function(e,n){var a;null==(a=bootstrap.Tooltip.getInstance(e))||a.dispose();let i=e.closest(".ew-grid, .ew-multi-column-grid"),r=e.closest("tr, div[data-rowindex]"),l=null==r?void 0:r.closest(".ew-table"),o=parseInt(null==r?void 0:r.dataset.rowindex,10),s=(null==i?void 0:i.querySelector("div.ew-form[id^=f][id$=grid]"))||(null==i?void 0:i.querySelector("form.ew-form[id^=f][id$=list], form.ew-form[id^=f][id$=grid]")),d=t(s),c=d.data("form");if(!(e&&i&&r&&l&&s&&c))return!1;let u=d.is("div")?"_"+s.id:"",p="#"+ew.FORM_KEY_COUNT_NAME+u,f=function(){if(r.remove(),i.classList.contains(".ew-grid")&&yt(l,!0),o>0){let e=d.find("#k"+o+"_action"+u);e[0]?e.val("insert"==e.val()?"insertdelete":"delete"):d.find(p).after(t("<input>").attr({type:"hidden",id:"k"+o+"_action"+u,name:"k"+o+"_action"+u,value:"delete"}))}t(l).trigger("rowdeleted",[o])};return He(c.emptyRow)&&c.emptyRow(n)?f():We(ew.language.phrase("DeleteConfirm"),(e=>{e&&f()})),!1},deleteSearchParam:Pe,disable2FA:function(){We({html:ew.language.phrase("Disable2FAConfirm"),preConfirm:e=>{if(e)return t.get(Ae([ew.API_2FA_ACTION,ew.API_2FA_RESET])).then((e=>{var t;return null!=e&&null!=(t=e.error)&&t.description?ze(e.error.description):!0!==(null==e?void 0:e.success)&&ze(ew.language.phrase("2FAResetFailed")),e})).fail(((e,t,n)=>ze(n)))}},(e=>{var n;null!=e&&null!=(n=e.error)&&n.description?ze(e.error.description):null!=e&&e.success&&(ze(ew.language.phrase("2FADisabled"),"success"),t("#enable-2fa").removeClass("d-none"),t("#disable-2fa, #backup-codes").addClass("d-none"))})).catch((e=>ze(null==e?void 0:e.message)))},displayValue:Dt,emailDialogShow:function(e){let n=ew.emailDialog||t("#ew-email-dialog").on("shown.bs.modal",(e=>setTimeout((()=>{var t;return null==(t=e.target.querySelector(".modal-body .form-control"))?void 0:t.focus()}),200))).on("click",".modal-footer .btn-primary",(function(e){var a;e.preventDefault(),null!=(a=t(this).closest(".modal").find(".modal-body form").data("form"))&&a.submit()&&n.modal("hide")}));if(!n[0])return Ge("DIV #ew-email-dialog not found."),!1;let a=e.evt.currentTarget.form;if(e.exportSelected&&!gt(a))return Ge(ew.language.phrase("NoRecordSelected")),!1;let i=n.find(".modal-body form"),r=i.data("form");return r||(r=(new v).setId(i.attr("id")).addFields([["sender",[ew.Validators.required(ew.language.phrase("Sender")),ew.Validators.email]],["recipient",[ew.Validators.required(ew.language.phrase("Recipient")),ew.Validators.emails(ew.MAX_EMAIL_RECIPIENT,ew.language.phrase("EnterProperRecipientEmail"))]],["cc",ew.Validators.emails(ew.MAX_EMAIL_RECIPIENT,ew.language.phrase("EnterProperCcEmail"))],["bcc",ew.Validators.emails(ew.MAX_EMAIL_RECIPIENT,ew.language.phrase("EnterProperBccEmail"))],["subject",ew.Validators.required(ew.language.phrase("Subject"))]]).setValidate((function(){return this.validateFields()})).setSubmit((function(){if(!this.validate())return!1;let r=Ie(i.serialize(),e.key,nt(),a&&e.exportSelected?t(a).find("input[type=checkbox][name='key_m[]']:checked").serialize():null);return n.modal("hide"),e.custom?at({...e,export:"email",custom:!0,emailForm:i[0]}):Xt(i.find("#tblvar").val(),r),!1})).build(),i.data("form",r)),ew.emailDialog=n.modal("hide").find(".modal-title").html(e.hdr).end().modal("show"),!1},enable2FA:function(){if(document.body.style.cursor="wait",xt(ew.TWO_FACTOR_AUTHENTICATION_TYPE,"google")){let e=Ae([ew.API_2FA_ACTION,ew.API_2FA_SHOW]);t.get(e,(e=>{var n;null!=e&&e.url?We({imageUrl:e.url,html:ew.language.phrase("Scan2FAQrCode"),input:"text",confirmButtonText:ew.language.phrase("Verify"),showLoaderOnConfirm:!0,allowEscapeKey:!1,allowOutsideClick:()=>!Swal.isLoading(),willOpen:()=>{Swal.showLoading(Swal.getConfirmButton()),Swal.disableInput(),Swal.getImage().onload=()=>{Swal.enableInput(),Swal.hideLoading(),Swal.getInput().focus()}},preConfirm:e=>t.get(Ae([ew.API_2FA_ACTION,ew.API_2FA_VERIFY,e])).then((e=>{if(!0!==(null==e?void 0:e.success))throw new Error(ew.language.phrase("2FAVerificationFailed"));return e})).catch((e=>Swal.showValidationMessage(e)))},(e=>{var n;null!=e&&null!=(n=e.error)&&n.description?ze(e.error.description):null!=e&&e.success&&(ze(ew.language.phrase("2FAEnabled"),"success"),t("#enable-2fa").addClass("d-none"),t("#disable-2fa, #backup-codes").removeClass("d-none"))})).catch((e=>ze(null==e?void 0:e.message))):null!=e&&null!=(n=e.error)&&n.description&&Ge(e.error.description)})).fail(((e,t,n)=>ze(n))).always((()=>document.body.style.cursor="default"))}else{let e=Ae([ew.API_2FA_ACTION,ew.API_2FA_SHOW]),n=xt(ew.TWO_FACTOR_AUTHENTICATION_TYPE,"email")?ew.language.phrase("EnterOTPEmailAddress"):ew.language.phrase("EnterOTPMobileNumber");t.get(e,(e=>{var a;e.success?We({html:n,input:"text",inputValue:e.account,confirmButtonText:ew.language.phrase("SendOTP"),showLoaderOnConfirm:!0,allowEscapeKey:!1,allowOutsideClick:()=>!Swal.isLoading(),preConfirm:e=>t.get(Ae([ew.API_2FA_ACTION,ew.API_2FA_SEND_OTP,e])).then((e=>{if(!0!==(null==e?void 0:e.success))throw new Error(ew.language.phrase("SendOTPFailed").replace("%e",De(e)));return e})).catch((e=>Swal.showValidationMessage(e)))},(e=>{var n;null!=e&&null!=(n=e.error)&&n.description?ze(e.error.description):null!=e&&e.success&&We({html:ew.language.phrase("EnterSecurityCode"),input:"text",confirmButtonText:ew.language.phrase("Verify"),showLoaderOnConfirm:!0,allowEscapeKey:!1,allowOutsideClick:()=>!Swal.isLoading(),preConfirm:e=>t.get(Ae([ew.API_2FA_ACTION,ew.API_2FA_VERIFY,e])).then((e=>{if(!0!==(null==e?void 0:e.success))throw new Error(ew.language.phrase("2FAVerificationFailed"));return e})).catch((e=>Swal.showValidationMessage(e)))},(e=>{var n;null!=e&&null!=(n=e.error)&&n.description?ze(e.error.description):null!=e&&e.success&&(ze(ew.language.phrase("2FAEnabled"),"success"),t("#enable-2fa").addClass("d-none"),t("#disable-2fa, #backup-codes").removeClass("d-none"))})).catch((e=>ze(null==e?void 0:e.message)))})).catch((e=>ze(null==e?void 0:e.message))):null!=e&&null!=(a=e.error)&&a.description&&Ge(e.error.description)})).fail(((e,t,n)=>ze(n))).always((()=>document.body.style.cursor="default"))}return!1},escapeRegExChars:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},executeScript:Bt,export:at,exportCustom:et,exportEmail:Xt,fetch:Ut,fieldContainerSelector:ye,fileDownload:Me,filter:function(e){let n=e.currentTarget.dataset;t("select[data-select2-id='f"+n.table+"srch_"+n.field+"']").select2("open")},fixLayoutHeight:function(){pn&&pn.cancel(),pn=t.later(50,null,(function(){var e=be.data("lte.layout");e&&e.fixLayoutHeight()}))},formatCurrency:function(e,t){if(t||(t=ew.CURRENCY_FORMAT),t.includes(";")){let n=t.split(";");t=e>=0?n[0]:n[1]}t=t.replace("¤","$");let n=ew.getLocaleFromPlatform(ew.LANGUAGE_ID);return"latn"==ew.NUMBERING_SYSTEM&&(n.numeralSystem=void 0),n.delimiters.thousands!==ew.GROUPING_SEPARATOR&&(n.delimiters.thousands=ew.GROUPING_SEPARATOR),n.delimiters.decimal!==ew.DECIMAL_SEPARATOR&&(n.delimiters.decimal=ew.DECIMAL_SEPARATOR),ew.format(e,t,{locale:n,currency:(ew.IS_RTL?"‎":"")+ew.CURRENCY_SYMBOL})},formatDateTime:on,formatNumber:function(e,t){let n=ew.getLocaleFromPlatform(ew.LANGUAGE_ID);return"latn"==ew.NUMBERING_SYSTEM&&(n.numeralSystem=void 0),n.delimiters.thousands!==ew.GROUPING_SEPARATOR&&(n.delimiters.thousands=ew.GROUPING_SEPARATOR),n.delimiters.decimal!==ew.DECIMAL_SEPARATOR&&(n.delimiters.decimal=ew.DECIMAL_SEPARATOR),ew.format(e,t||ew.NUMBER_FORMAT,{locale:n})},formatPercent:function(e,t){let n=ew.getLocaleFromPlatform(ew.LANGUAGE_ID);return"latn"==ew.NUMBERING_SYSTEM&&(n.numeralSystem=void 0),n.delimiters.thousands!==ew.GROUPING_SEPARATOR&&(n.delimiters.thousands=ew.GROUPING_SEPARATOR),n.delimiters.decimal!==ew.DECIMAL_SEPARATOR&&(n.delimiters.decimal=ew.DECIMAL_SEPARATOR),ew.format(e,t||ew.PERCENT_FORMAT,{locale:n})},formatTimeSpan:function(e,t,n){let a=rn.fromJSDate(e,{zone:"utc"}),i=rn.fromJSDate(t,{zone:"utc"});i.isValid&&i.equals(i.startOf("day"))&&(i=i.minus(1));let r=new ln({start:a,end:i});if(r.isValid){let e=r.count()/864e5;n||(n=Number.isInteger(e)&&e>=1)}return n?r.isValid&&r.count("days")>1||a.isValid&&i.isValid&&a.startOf("day")<i.startOf("day")?on(a,ew.DATE_FORMAT)+" - "+on(i,ew.DATE_FORMAT):a.isValid&&!t?on(a,ew.DATE_FORMAT):"":a.isValid&&i.isValid?a.startOf("day")<i.startOf("day")?on(a,ew.DATE_FORMAT+" "+ew.TIME_FORMAT)+" - "+on(i,ew.DATE_FORMAT+" "+ew.TIME_FORMAT):on(a,ew.TIME_FORMAT)+" - "+on(i,ew.TIME_FORMAT):a.isValid?on(a,ew.TIME_FORMAT):""},forms:we,getAncestorBy:Tt,getApiUrl:Ae,getContent:Ht,getElement:St,getElements:At,getError:De,getForm:Je,getId:Ft,getNumberingSystem:function(){return ew.NUMBERING_SYSTEM||new Intl.NumberFormat(ew.LANGUAGE_ID).resolvedOptions().numberingSystem},getOptionTexts:Rt,getOptionValue:Nt,getOptionValues:Pt,getOptions:Gt,getQueryBuilderFilterInput:function(){return function(e,t){var n,a;let i=this.status.id.replace(/_query_builder$/,""),r=e.filter.id,l="tpx_"+i+"_"+r,o=null==(n=document.getElementById(l))||null==(n=n.content)?void 0:n.cloneNode(!0).querySelector(".ew-search-field");return'<div class="d-inline-flex position-relative">'+(null!=(a=null==o?void 0:o.innerHTML.replace(/\binvalid-feedback\b/,ew.queryBuilderErrorClass).replace(new RegExp('(data-field=")?(\\b|_)x_'+r+"(\\[\\]|\\b)","g"),((e,n,a)=>n?e:a+t)))?a:"")+"</div>"}},getQueryBuilderFilterValidation:function(e){return{callback:function(n,a){let i=a.$el.find(".rule-value-container"),r=0;for(let n=0;n<a.operator.nb_inputs;n++)i.find("[name='"+a.id+"_value_"+n+"']").each((function(){let n=t(this),a=n.next("."+ew.queryBuilderErrorClass).empty();null==e||null==e.forEach||e.forEach((e=>{let n=e(this);t.isObject(n)&&(r++,a.append("<span>"+Object.values(n)[0]+"</span>"))})),a.html()&&n.addClass("is-invalid").one("click",(()=>n.removeClass("is-invalid")))}));return!r||""}}},getQueryBuilderValueSetter:function(){return function(e,n){let a=e.$el.find(".rule-value-container").find("select, selection-list, input[name^=sv_], input[data-field]")[0],i=Array.isArray(n)?n:t.isValue(n)?[n]:[];if(null!=a&&a.matches("select, selection-list")){let e=we.get(a);i.forEach((t=>jt(a,{lf:t},e,!0))),e.updateList(a,void 0,void 0,!0)}else ew.selectOption(a,i);return null}},getSearchParam:function(e,t){return Oe(e).get(t)},getSearchParams:Oe,getUserParams:Qe,getValue:function(e,n){let a=e;if(t.isString(e)?a=2==e.split(" ").length?At(e):At(e,n):["checkbox","radio"].includes(e.type)&&(a=At(e)),a)return a.options?a.list?"select-multiple"==a.type?a.values:a.value:t(a).val():Array.isArray(a)?a.length?t(a).filter(":checked").map(((e,t)=>t.value)).get():void 0:ut(a)?a.checked?a.value:void 0:ew.isHiddenTextArea(a)?(t(a).data("editor").save(),a.value):a.value},getchartParams:nt,hasFormData:function(e){for(var n="[name^=x_],[name^=y_],[name^=z_],[name^=w_],[name="+ew.TABLE_BASIC_SEARCH+"]",a=t(e).find(n).filter(":enabled").get(),i=0,r=a.length;i<r;i++){var l=a[i];if(/^(z|w)_/.test(l.name)){if(/^IS/.test(t(l).val()))return!0}else if("checkbox"==l.type||"radio"==l.type){if(l.checked)return!0}else if("select-one"==l.type||"select-multiple"==l.type){if(t(l).val())return!0}else if(["text","textarea","password","search","color","date","datetime-local","datetime","email","hidden","month","number","range","tel","time","url","week"].includes(l.type)&&l.value)return!0}return!1},hasValue:function(e){return""!=Nt(e)},headerCase:It,htmlDecode:Et,htmlEncode:function(e){return String(e).replace(/&/g,"&amp;").replace(/\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},importDialogShow:function(e){var n,a;e.lnk=e.lnk||(null==(n=e.evt)?void 0:n.currentTarget),null==(a=bootstrap.Tooltip.getInstance(e.lnk))||a.hide();let i=ew.importDialog||t("#ew-import-dialog");if(!i[0])return Ge("DIV #ew-import-dialog not found."),!1;let r,l,o=i.find("#importfiles"),s=o.closest(".ew-file-drop-zone"),d=i.find(".modal-body"),c=d.find(":input[id!=importfiles]"),u=d.find(".message"),p=d.find(".progress"),f=function(e,n){let a=t("<div>"+e+"</div>");var r;n&&a.addClass(n),u.removeClass("d-none").html(a),"text-danger"==n&&(r=!0,i.find(".modal-footer .btn").prop("disabled",!r))},h=()=>u.addClass("d-none").html(""),g=(e,t)=>p.removeClass("d-none").find(".progress-bar").removeClass("text-bg-success text-bg-info").addClass(t||"text-bg-success").attr("aria-valuenow",e).css("width",e+"%").html(e+"%"),m=function(e){const n=Ke(e.data)||{};try{let e=n.totalCount||0,a=n.count||0,l=n.successCount||0,o=n.failCount||0,s=n.file;if(e>0&&i.find(".modal-footer .ew-close-btn").data("import-progress")){n.row&&function(e){let{row:n,success:a,error:i,count:l}=e,o=()=>{r.addRow(n).then((e=>e.getElement().classList.toggle("text-danger",i))),i&&console.log(ew.language.phrase("ImportRowError").replace("%i",l+" "+JSON.stringify(n)).replace("%e",i))};n={_index:l,_success:a,_error:i,...n},r?r.initialized?o():r.on("tableBuilt",o):(r=new Tabulator("#ew-import-dialog .result",t.extend({data:[n],index:"_index",autoColumns:!0,autoColumnsDefinitions:e=>(e.forEach((e=>{e.headerSort=!1,e.resizable=!1,["_index","_error"].includes(e.field)?e.visible=!1:"_success"==e.field&&(e.title="#",e.headerSort=!0,e.headerSortTristate=!0,e.formatter=e=>{e.getElement().style.textOverflow="clip";let t=e.getRow(),n=t.getData();return n._error&&new bootstrap.Tooltip(t.getElement(),{placement:"bottom",title:n._error,container:"#ew-import-dialog .result"}),(n._success?'<i class="fa-solid fa-check text-success"></i>':'<i class="fa-solid fa-xmark text-danger"></i>')+" #"+n._index})})),e)},ew.importTabulatorOptions)),r.on("tableBuilt",(()=>r.element.querySelector(".tabulator-row").classList.toggle("text-danger",i))))}(n);let i=parseInt(100*a/e,10);g(i),f(ew.language.phrase("ImportResult").replace("%t",e).replace("%c",a).replace("%f",s).replace("%s",l).replace("%e",o),o>0?"text-danger":"text-primary")}}catch(e){}},w=function(e){var t;let n=[],a=Ke(e.data)||{},r=a.files;g(100),i.find(".modal-footer .ew-close-btn").data("import-progress",!1),Array.isArray(r)&&r.forEach((e=>{let t=e.totalCount||0,a=e.count||0,i=e.successCount||0,r=e.failCount||0;n.push(ew.language.phrase("ImportResult").replace("%t",t).replace("%c",a).replace("%f",e.file).replace("%s",i).replace("%e",r))})),a.success?(a.rollbacked&&n.push(ew.language.phrase("ImportSave")),f(n.join("<br>"),"text-success"),i.find(".modal-footer .ew-close-btn").data("imported",!0)):(ew.IMPORT_MAX_FAILURES>0&&a.failCount>=ew.IMPORT_MAX_FAILURES&&n.push(ew.language.phrase("ImportMaxFailuresExceeded").replace("%s",ew.IMPORT_MAX_FAILURES)),f(n.join("<br>"),"text-danger")),document.body.style.cursor="default",i.find(".modal-footer .ew-close-btn").prop("disabled",!1);let o=i.find(".modal-footer .ew-import-btn").toggleClass("d-none",!a.rollbacked||!a.success);a.rollbacked&&o.off("click").one("click",b),console.log("Closing EventSource..."),null==(t=l)||t.close()},v=function(e){var t;document.body.style.cursor="default",i.find(".modal-footer .ew-close-btn").data("import-progress",!1);let n=Ke(e.data)||{};n.error&&f(n.error,"text-danger"),console.log("Closing EventSource..."),null==(t=l)||t.close()},b=function(e){var t;document.body.style.cursor="wait",g(0),null==(t=r)||t.clearData(),i.find(".modal-footer .ew-close-btn").data("import-progress",!0);let n=new URLSearchParams(c.serialize());n.set(ew.API_ACTION_NAME,ew.API_IMPORT_ACTION),n.set(ew.API_FILE_TOKEN_NAME,o.data(ew.API_FILE_TOKEN_NAME)),n.set("rollback","0"),l=new EventSource(Zt()+"?"+n.toString()),l.addEventListener("message",m),l.addEventListener("error",v),l.addEventListener("complete",w)},y=ew.importUploadOptions;return y.acceptFileTypes||(y.acceptFileTypes=new RegExp("\\.("+ew.IMPORT_FILE_ALLOWED_EXTENSIONS.replace(/,/g,"|")+")$","i")),o.data("blueimpFileupload")||o.fileupload(Object.assign({url:Ae(ew.API_UPLOAD_ACTION),dataType:"json",autoUpload:!0,singleFileUploads:!1,dropZone:s,messages:{acceptFileTypes:ew.language.phrase("UploadErrorAcceptFileTypes"),maxFileSize:ew.language.phrase("UploadErrorMaxFileSize"),maxNumberOfFiles:ew.language.phrase("UploadErrorMaxNumberOfFiles"),minFileSize:ew.language.phrase("UploadErrorMinFileSize")},beforeSend:function(e,t){t.data.set("session",ew.SESSION_ID),t.data.set(ew.TOKEN_NAME_KEY,ew.TOKEN_NAME),t.data.set(ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN),ew.API_JWT_TOKEN&&e.setRequestHeader(ew.API_JWT_AUTHORIZATION_HEADER,"Bearer "+ew.API_JWT_TOKEN)},done:function(e,t){var n;if(Array.isArray(null==t||null==(n=t.result)||null==(n=n.files)?void 0:n.importfiles)){let e=[];t.result.files.importfiles.forEach((function(t,n){t.error&&e.push(ew.language.phrase("ImportUploadError").replace("%f",t.name).replace("%s",t.error))})),e.length?f(e.join("\n"),"text-danger"):(r=null,function(e){var t;document.body.style.cursor="wait",g(0),null==(t=r)||t.clearData(),o.data(ew.API_FILE_TOKEN_NAME,e),i.find(".modal-footer .ew-close-btn").data("import-progress",!0);let n=new URLSearchParams(c.serialize());n.set(ew.API_ACTION_NAME,ew.API_IMPORT_ACTION),n.set(ew.API_FILE_TOKEN_NAME,e),n.set("rollback","1"),l=new EventSource(Zt()+"?"+n.toString()),l.addEventListener("message",m),l.addEventListener("error",v),l.addEventListener("complete",w)}(t.result[ew.API_FILE_TOKEN_NAME]))}},change:function(e,t){h()},processfail:function(e,t){t.files.forEach((function(e,t){e.error&&f(ew.language.phrase("ImportUploadError").replace("%f",e.name).replace("%s",e.error),"text-danger")}))},fail:function(e,t){f(ew.language.phrase("ImportServerError").replace("%s",t.textStatus).replace("%t",t.errorThrown),"text-danger")},progressall:function(e,t){!function(e){const t=parseInt(100*e.loaded/e.total,10);g(t,"text-bg-primary"),f(100===t?ew.language.phrase("ImportUploadComplete"):ew.language.phrase("ImportUploadProgress").replace("%p",t),"text-primary")}(t)}},y)),i.modal("hide").find(".modal-title").html(e.hdr),i.find(".modal-footer .ew-close-btn").off("click.ew").on("click.ew",(function(){let e=t(this);e.data("imported")&&(e.data("imported",!1),window.location.reload())})),h(),ew.importDialog=i.on("show.bs.modal",(function(){var e,t,n;p.addClass("d-none").find(".progress-bar").attr("aria-valuenow",0).css("width","0%").html("0%"),null==(e=this.querySelector(".modal-footer .ew-import-btn"))||e.classList.add("d-none"),null==(t=r)||t.element.removeAttribute("style"),null==(n=r)||n.destroy(),r=null})).modal("show"),!1},initExportLinks:Fe,initForms:qe,initIcons:_e,initLightboxes:$e,initMultiSelectCheckboxes:ke,initPage:function(e){var n,a=null!=(n=null==e?void 0:e.target)?n:document,i=t(a),r=i.find("table.ew-table:not(.ew-export-table)");ew.initPanels(a),ew.renderJsTemplates(e),je(e),qe(e),Be(e),Ee(e),_e(e),Jt(e),$e(e),Ue(e),r.each(yt),i.find(".ew-column-dropdown").each((function(){var e;let n=this.dataset.table;null==(e=localStorage.getItem(ew.PROJECT_NAME+"_"+n+"_invisible_fields"))||e.split(",").forEach((e=>t("#tbl_"+n+"list").find("th[data-name='"+e+"'],td[data-name='"+e+"']").toggleClass("d-none",!0))),t(this).find(".ew-dropdown-checkbox").on("click",(function(e){let a=this.querySelector(".ew-dropdown-check-input[data-field]"),i=null==a?void 0:a.dataset.field;n&&i&&(a.classList.toggle("ew-checked"),t("#tbl_"+n+"list").find("th[data-name='"+i+"'],td[data-name='"+i+"']").toggleClass("d-none",!a.classList.contains("ew-checked"))),localStorage.setItem(ew.PROJECT_NAME+"_"+n+"_invisible_fields",Array.from(e.currentTarget.closest(".dropdown-menu").querySelectorAll(".ew-dropdown-check-input[data-field]:not(.ew-checked)"),(e=>e.dataset.field)))}))})).on("show.bs.dropdown",(function(e){let n=e.currentTarget.dataset.table,a=e.currentTarget.querySelectorAll(".ew-dropdown-check-input[data-field]");for(let e of a){let a=e.dataset.field;e.classList.toggle("ew-checked",!!t("#tbl_"+n+"list").find("th[data-name='"+a+"']:not(.d-none)")[0])}})),Fe(e),ke(e);var l=i.find(".ew-report");l[0]&&(l.find(".card").on("collapsed.lte.widget",(function(){var e=t(this).closest("[class^='col-']"),n=e.css("min-height");n&&e.data("min-height",n),e.css("min-height",0)})).on("expanded.lte.widget",(function(){var e=t(this).closest("[class^='col-']"),n=e.css("min-height");n&&e.css("min-height",n)})),l.find(".ew-group-toggle").on("click",(function(){ew.toggleGroup(this)}))),"undefined"!=typeof ew.USE_JAVASCRIPT_MESSAGE&&ew.USE_JAVASCRIPT_MESSAGE&&nn(e)},initPasswordOptions:Ee,initPdfObjects:Ue,initSearchFilters:Jt,initTooltips:Be,inlineAction:async function(e){var n;let a=t(null==(n=e.evt)?void 0:n.currentTarget),i=a.closest(".ew-grid, .ew-multi-column-grid");if(a.tooltip("hide"),!i[0]&&a.is(".dropdown-item")){let e=t("#"+a.closest(".dropdown-menu").attr("aria-labelledby"));e[0]&&(a=e,i=a.closest(".ew-grid, .ew-multi-column-grid"))}if(!a[0])return;let r,{url:l,ewAction:o,action:s}=e,d=i.find("form"),c=d[0],u=a.closest("tr[data-rowindex], div[data-rowindex]"),p=u.data("key"),f=u.data("rowindex");if(!("add"==s||i[0]&&c))return;let h=function(e){!e.status||ze("Server Error "+e.status+": "+e.statusText)},g=function(){document.body.style.cursor="default"},m=async function(e){if(!(e instanceof Response))return;let t=e.headers.get("Content-Type");if(null!=t&&t.includes("json")){let t=await e.json();null!=t&&t.success?(u.remove(),ze(ew.language.phrase("DeleteSuccess"),"success")):ze(De(t)||ew.language.phrase("DeleteFailed"))}else Ge(await e.text())},w=()=>t(".ew-list-options, .ew-list-option-body").find("[data-ew-action='inline'][data-action='add'],[data-ew-action='inline'][data-action='copy'],[data-ew-action='inline'][data-action='edit']").addClass("disabled"),v=()=>t(".ew-list-options, .ew-list-option-body").find("[data-ew-action='inline'][data-action='add'],[data-ew-action='inline'][data-action='copy'],[data-ew-action='inline'][data-action='edit']").removeClass("disabled"),b=()=>i.find(".ew-grid-middle-panel .ew-table")[0],y=e=>{let t=0;Array.from(e.rows).forEach((e=>e.dataset.rowindex="0"===e.dataset.rowindex?"0":String(t++)))},_=async function(e){if(!(e instanceof Response))return;let n=await e.clone().text(),a=t("<div>"+n+"</div>"),l=a.find("tr[data-rowindex=0], div[data-rowindex=0]"+(p?", tr[data-key='"+p+"'], div[data-key='"+p+"']":"")).filter("[data-rowtype=2], [data-rowtype=3]"),o=l.data("inline"),d=l.data("rowtype"),f=o&&2==d?0:o&&3==d?1:l.data("rowindex"),h=l.add(a.find("script[data-rowindex="+f+"]"));if(["add","copy","edit"].includes(s)&&!h[0])return ze(n);if(["add","copy"].includes(s)){if(document.querySelector("main.ew-no-record")&&a.find("main:not(.ew-no-record)")[0])await un(Promise.resolve(e));else{if(l.is("TR")){let e=b();e.matches(".ew-infinite-scroll-table")?t(e.tBodies).last().append(h):t(e.tBodies).last().prepend(h),y(e),yt(e,!0)}else i.find(".ew-multi-column-row").append(h);w()}ew.initPage(t.Event({type:"load.ew",target:i[0]})),we.get(c.id).tryFocus(),ht(i.find("[data-rowtype=2]")[0])}else"edit"==s&&(r=u.replaceWith(h),i.data("detached",r),l.is("TR")&&yt(b(),!0),w(),ew.initPage(t.Event({type:"load.ew",target:i[0]})),we.get(c.id).tryFocus(),ht(i.find("[data-rowtype=3]")[0]))},E=async function(n){if(!(n instanceof Response))return;let a=n.headers.get("Content-Type");if(null!=a&&a.includes("json")){let e=De(await n.json());if(e)return void ze(e)}if(n.headers.get("Infinite-Scroll")){let e,a=await n.text(),r=t("<div>"+a+"</div>"),l=r.find(".main");if(["insert","update"].includes(s)){if(e=r.find("tr[data-rowindex][data-rowtype="+ew.ROWTYPE_VIEW+"], div[data-rowindex][data-rowtype="+ew.ROWTYPE_VIEW+"]"),!e[0])return;"insert"==s?i.find("tr[data-rowtype="+ew.ROWTYPE_ADD+"], div[data-rowtype="+ew.ROWTYPE_ADD+"]").replaceWith(e[0]):"update"==s&&e.get().forEach((e=>i.find("tr[data-key='"+e.dataset.key+"'], div[data-key='"+e.dataset.key+"']").replaceWith(e)))}else["add","edit","multiedit"].includes(s)&&(e=r.find("tr[data-rowindex][data-rowtype="+ew.ROWTYPE_VIEW+"], div[data-rowindex][data-rowtype="+ew.ROWTYPE_VIEW+"]"),["edit","multiedit"].includes(s)?e.get().forEach((e=>i.find("tr[data-key='"+e.dataset.key+"'], div[data-rowtype='"+e.dataset.key+"']").replaceWith(e))):"add"==s&&i.find(".ew-grid-middle-panel .ew-table > tbody:last").append(e));let o=b();y(o),yt(o,!0),nn({target:r}),ew.initPage(t.Event({type:"load.ew",target:l[0]}))}else await un(Promise.resolve(n));let r=n.headers.get("Return-Url");r&&["inline","modal"].includes(e.ewAction)&&!Ct(Se(r).pathname,me.pathname)&&i.find("[data-ew-action=modal][data-url='"+r+"'], [data-ew-action=inline][data-url='"+r+"']").trigger("click")};if("inline"==o)if("cancel"==s){var A;if("0"==f)u.remove();else null==(A=i.data("detached"))||A.replaceAll(u);v()}else if(c&&["insert","update"].includes(s)){let n=we.get(c.id);if(await n.canSubmit(e.evt)){document.body.style.cursor="wait";let e=xe(d.serialize(),{action:s}),a=Ut(xe(l,{rnd:an()}),{method:"POST",body:e}).catch(h).finally((()=>{n.enableForm(),g()}));if(n.submitWithFetch){let e={form:c,result:a},i=t.Event("aftersubmit",{originalEvent:e.evt});n.trigger(i,[e])}else a.then(E).finally(v)}}else if("delete"==s){if(!p&&(u=i.find("input[type=checkbox][name='key_m[]']:checked").closest("tr[data-rowindex], div[data-rowindex]"),!u[0]))return Ge(ew.language.phrase("NoRecordSelected")),!1;We(ew.language.phrase("DeleteConfirm"),(e=>{if(e){document.body.style.cursor="wait";let e=p?"GET":"POST",n=Pe(d.serialize(),"action"),a=we.get(c.id),i=Ut(xe(l,{action:"delete",rnd:an()}),{method:e,body:n}).catch(h).finally((()=>{a.enableForm(),g()}));if(a.submitWithFetch){let e={form:c,result:i},n=t.Event("aftersubmit",{originalEvent:e.evt});a.trigger(n,[e])}else i.then(m)}}))}else document.body.style.cursor="wait",Ut(xe(l,{rnd:an()})).then(_).catch(h).finally(g);else if("grid"==o||"modal"==o){if(("grid"==o&&"edit"==s||"modal"==o&&["multiedit","update"].includes(s))&&!gt(c))return Ge(ew.language.phrase("NoRecordSelected")),!1;ew.modalDialogShow({...e,callback:E})}return!1},isAutoSuggest:ot,isBooleanCheckbox:ut,isFilter:lt,isFunction:He,isHidden:Ot,isHiddenTextArea:it,isMaskedPassword:function(e){var n=t(e).val();return null==n?void 0:n.match(/^\*+$/)},isMediumScreen:cn,isMobile:function(){return ew.IS_MOBILE||!cn()},isModalLookup:rt,isNativeSelectOne:dt,isSelect2:st,isTextbox:ct,keySelected:gt,lazyLoad:je,mergeSearchParams:Ie,modalDialogHide:Wt,modalDialogShow:function(e){var n,a,i,r,l,o;e.lnk||(e.lnk=null==(n=e.evt)?void 0:n.currentTarget),null==(a=bootstrap.Tooltip.getInstance(e.lnk))||a.hide();let{ewAction:s,action:d}=e,c=e.f||(null==(i=e.evt)||null==(i=i.currentTarget)?void 0:i.form);if(("grid"==s&&"edit"==d||"modal"==s&&["multiedit","update"].includes(d))&&!gt(c))return Ge(ew.language.phrase("NoRecordSelected")),!1;let u=e.url||(null==(r=e.evt)||null==(r=r.currentTarget)?void 0:r.dataset.url),p=ew.modalDialog||t("#ew-modal-dialog").on("hidden.bs.modal",Wt);if(p.on("hidden.bs.modal",(()=>p.data("showing",!1))),p.data("showing")&&u&&p.data("url")==u)return!1;p.data({showing:!0,url:u}),e.reload=!1,p.find(".modal-dialog").removeClass("modal-sm modal-md modal-lg modal-xl").addClass(e.size||"modal-xl");let f=function(){let e=p.data("args"),n=t(e.lnk);return e.caption||n.data("caption")||n.data("original-title")||""},h=function(e){p.modal("hide"),e.status&&Ge("Server Error "+e.status+": "+e.statusText)},g=function(){document.body.style.cursor="default"},m=function(){p.data("showing")&&!p.hasClass("show")&&p.data("showing",!1).trigger("hidden.bs.modal")},w=function(n){let a=De(n);if(a)Ge(a),m();else if(t.isString(n.warningMessage))Ge(n.warningMessage,"warning"),m();else if(t.isString(n.message))Ge(n.message,"body"),m();else if(n.success&&!He(null==e?void 0:e.callback)||t.isString(n.successMessage)){var i,r,l;let e=p.data("args");p.modal("hide"),n.successMessage&&ze(n.successMessage,"success");let t=null==e?void 0:e.lnk,a=null==t||null==(i=t.closest(".dropdown-menu[aria-labelledby]"))?void 0:i.getAttribute("aria-labelledby"),o=a?document.getElementById(a):null,s=null!=(r=null==t?void 0:t.closest(".tab-pane"))?r:null==o?void 0:o.closest(".tab-pane"),d=null==s||null==(l=s.parentNode)||null==(l=l.parentNode)?void 0:l.querySelector("[data-bs-toggle='tab'][data-bs-target='#"+s.id+"']:not([tabindex])");p.trigger("success.ew.modal",[{result:n,tabPane:s,navItem:d}])}else if(n.reload)p.modal("hide"),window.location.reload();else if(t.isBoolean(n.success)&&He(null==e?void 0:e.callback))p.modal("hide"),e.callback(n);else if(n.url){let a=n.url;n.modal?!function(e){let t=document.createElement("a");return t.href=e,window.location.pathname.endsWith(t.pathname)}(a)?(e.reload=!0,e.url=a,n.caption&&(e.caption=n.caption),e.btn=n.view?null:"",p.data({args:e,url:a}),a=xe(a,{modal:"1",rnd:an()}),document.body.style.cursor="wait",t.get(a).done(E).fail(h).always(g)):n.error||(p.modal("hide"),un(fetch(a))):(p.modal("hide"),window.location=Le(a))}},v=function(){let e=p.find(".modal-footer").last().empty();if(!p.find(".card-body button[type=submit]").first().addClass("ew-submit").on("click",_)[0]){if(p.find(".modal-body .ew-modal-buttons").contents().clone().find("button").each((function(){if("submit"==this.type){this.type="button",this.classList.add("ew-submit"),"btn-cancel"==this.id&&this.classList.add("ew-cancel");let e=t(this);e.on("click",(function(n){"set-action"==this.dataset.ewAction&&(this.form.elements.action.value=this.dataset.value),!1===e.data("ajax")?t(this.form).trigger("submit"):_(n)}))}else"btn-cancel"==this.id&&(this.dataset.href?t(this).on("click",(function(e){let t=p.find(".modal-body form")[0],n=we.get(t.id);null==n||n.updateTextArea(),null!=n&&n.modified&&ew.hasFormData(this.form)?ew.prompt(ew.language.phrase("ConfirmCancel"),(e=>{e&&(Ct(this.dataset.href,me.pathname)?p.modal("hide"):dn(this.dataset.href))})):Ct(this.dataset.href,me.pathname)?p.modal("hide"):dn(this.dataset.href)})):t(this).on("click",(()=>p.modal("hide"))));e[0].appendChild(this)})),!p.find(".card-body button[type=submit], .modal-footer .btn")[0]){let n=function(){let e=p.data("args");return null===e.btn?"":e.btn&&""!=e.btn?ew.language.phrase(e.btn):f()}();n?(t('<button type="button" class="btn btn-primary ew-btn">'+n+"</button>").on("click",_).appendTo(e),e.append('<button type="button" class="btn btn-default ew-btn" data-bs-dismiss="modal">'+ew.language.phrase("CancelBtn")+"</button>")):e.append('<button type="button" class="btn btn-default ew-btn" data-bs-dismiss="modal">'+ew.language.phrase("CloseBtn")+"</button>")}e.find("button").on("mousedown",(e=>e.preventDefault())),e.find(".btn-primary").focus()}},b=n=>{let a=n.headers.get("Return-Url");a&&e.table&&["inline","modal"].includes(e.ewAction)&&!Ct(Se(a).pathname,me.pathname)&&t(".ew-grid."+e.table).find("[data-ew-action=modal][data-url='"+a+"'], [data-ew-action=inline][data-url='"+a+"']").trigger("click")},y=async function(e){let n=p.data("args");if(!(e instanceof Response))return;let a=e.headers.get("Content-Type");if(null!=a&&a.includes("json")){let t=await e.json();if(He(null==n?void 0:n.callback)){let e=De(t);return e?ze(e):p.modal("hide"),void n.callback(t)}w(t)}else{let a=await e.clone().text(),i=Ht(a).trim();if(i.startsWith("<")&&i.endsWith(">")){if(n.ajax&&"add"==n.action&&document.querySelector("main.ew-no-record")&&t(i).find("main:not(.ew-no-record)")[0])return p.modal("hide"),await un(Promise.resolve(e)),void b(e);if(p.find(".modal-body").html(i),p.find(".modal-body .ew-infinite-scroll-grid .ew-grid-middle-panel").css("height","auto"),!p.find(".modal-body .ew-modal-buttons").length&&He(null==n?void 0:n.callback))return p.modal("hide"),void n.callback(e);v(),Bt(a,"modal_dialog",!0),p.trigger("load.ew")}else a&&(p.modal("hide"),Ge(a))}},_=async function(e){let n=p.find(".modal-body form")[0],a=t(n),i=we.get(n.id),r=null==e?void 0:e.target;if(r.classList.contains("disabled"))return!1;if(r.classList.contains("ew-cancel"))t.post(a.attr("action"),a.serialize(),E).fail(h).always(g);else if(await i.canSubmit(e)){document.body.style.cursor="wait";let r=Ut(a.attr("action"),{method:"POST",body:a.serialize()}).catch(h).finally((()=>{i.enableForm(),g()}));i.submitWithFetch?r.then((async a=>{var r;let l=a.clone(),o=null==(r=l.headers.get("Content-Type"))?void 0:r.includes("json"),s=o?await l.json():null,d=(null==s?void 0:s.validation)||De(s);o&&d||p.modal("hide");let c={form:n,result:Promise.resolve(a),context:d?"#ew-modal-dialog.show .modal-body":null},u=t.Event("aftersubmit",{originalEvent:e});i.trigger(u,[c])})):r.then(y)}return!1},E=function(e){let n=Ke(e);if(t.isObject(n))w(n);else{let n=p.data("args"),a=t(n.lnk),i=Ht(e);p.find(".modal-title").html(f()),p.find(".modal-body").html(i),p.find(".modal-body .ew-infinite-scroll-grid .ew-grid-middle-panel").css("height","auto"),v(),p.find(".modal-footer").toggle(!1!==n.footer);let r=a.data()||{};r.table&&p.find(".modal-dialog").addClass("table-"+r.table),p.find(".modal-body form").on("keydown",(e=>{if("Enter"==e.key&&"TEXTAREA"!=e.target.nodeName)return p.find(".modal-footer .btn.btn-primary").trigger("click"),!1})),r.ajax&&r.table&&"view"==r.action&&[".ew-add",".ew-copy",".ew-edit",".ew-delete"].forEach((e=>{let n=p.find(".modal-body "+e+"[data-ew-action=modal]"),a=t("[data-ew-action=modal][data-table='"+r.table+"'][data-url='"+n.data("url")+"']").not(".modal-body *").first();a[0]?n.on("click",(e=>{e.preventDefault(),e.stopImmediatePropagation(),a.trigger("click")})):n.addClass("d-none")})),ew.modalDialog=p.modal("show"),Bt(e,"modal_dialog",!0);let l=bootstrap.Modal.getInstance(p[0]);l._focustrap.__handleFocusin||(l._focustrap.__handleFocusin=l._focustrap._handleFocusin,l._focustrap._handleFocusin=function(e){var t;null!=(t=e.target)&&t.matches("[class^=cke_dialog_]")||this.__handleFocusin(e)}),p.trigger("load.ew")}};if(!0===e.callback&&null!=(l=p.data("args"))&&l.callback&&(e.callback=p.data("args").callback),u&&null!=(o=p.data("args"))&&o.reload&&(e.reload=!0,p.data("args").reload=!1),p.modal("hide"),p.data("args",e),u){document.body.style.cursor="wait";let n=ew.getSearchParams(u);n.set("rnd",an()),"delete"!=n.get("action")&&n.set("modal","1"),t.ajax({url:xe(u,n),method:c?"POST":"GET",data:c?t(c).serialize():"",headers:e.json?{Accept:"application/json, */*; q=0.01"}:{}}).done(E).fail(h).always(g)}else e.html&&function(e){let t=p.data("args");p.find(".modal-title").html(f()),p.find(".modal-body").html(e),v(),p.find(".modal-footer").toggle(!1!==t.footer),ew.modalDialog=p.modal("show")}(e.html);return!1},newOption:jt,onError:function(e,n,a,i){if(n.jquery){let e=n.attr("type");n="checkbox"==e||"radio"==e?n.get():n[0]}else n instanceof m&&(n=n.element);return t(n).closest(ye).find(".invalid-feedback").append("<p>"+a+"</p>"),i&&pt(n),null==e||e.makeVisible(n),!1},optionHtml:Mt,optionsHtml:function(e,t){return e.length>(t||ew.MAX_OPTION_COUNT)?ew.language.phrase("CountSelected").replace("%s",e.length):e.length?e.reduce(((e,t)=>e+Mt(t)),""):ew.language.phrase("PleaseSelect")},parseDate:sn,parseDateTime:sn,parseJson:Ke,parseNumber:function(e){let t=ew.getLocaleFromPlatform(ew.LANGUAGE_ID);return"latn"==ew.NUMBERING_SYSTEM&&(t.numeralSystem=void 0),t.delimiters.thousands!==ew.GROUPING_SEPARATOR&&(t.delimiters.thousands=ew.GROUPING_SEPARATOR),t.delimiters.decimal!==ew.DECIMAL_SEPARATOR&&(t.delimiters.decimal=ew.DECIMAL_SEPARATOR),ew.parse(e,{locale:t})},parseTime:sn,parseUrl:Se,prompt:We,random:an,redirect:dn,refresh:un,removeScript:qt,removeSpaces:function(e){return/^(<(p|br)\/?>(&nbsp;)?(<\/p>)?)?$/i.test(e.replace(/\s/g,""))?"":e},samePath:Ct,sameString:function(e,t){return String(e)==String(t)},sameText:xt,sanitizeUrl:Le,scrollIntoView:ht,searchOperatorChange:Ve,selectAll:mt,selectAllKeys:function(e){mt(e);let n=null==e?void 0:e.closest(".ew-table");n&&t(n.tBodies).each((function(){t(this.rows).each((function(){let n=t(this);n.is(":not(.ew-template):not(.ew-table-preview-row)")&&n.toggleClass("table-active ew-table-selected-row",e.checked).triggerHandler("change")}))}))},selectKey:function(e){let n=e.target,a=null==n?void 0:n.closest(".ew-table");if(!a)return;wt(a);let i=t(n).closest(".ew-table > tbody > tr");i.siblings("[data-rowindex='"+i.data("rowindex")+"']").addBack().each((function(){t(this).toggleClass("table-active ew-table-selected-row",n.checked).triggerHandler("change")})),e.stopPropagation()},selectOption:$t,sendOTP:function(e){We({html:ew.language.phrase("SendOTPConfirm"),preConfirm:n=>{let a=Ae(e?[ew.API_2FA_ACTION,ew.API_2FA_SEND_OTP,e]:[ew.API_2FA_ACTION,ew.API_2FA_SEND_OTP]);if(n)return t.get(a).then((e=>{var t;return null!=e&&null!=(t=e.error)&&t.description?ze(e.error.description):!0!==(null==e?void 0:e.success)&&ze(ew.language.phrase("SendOTPFailed")),e})).fail(((e,t,n)=>ze(n)))}},(e=>{var t;null!=e&&null!=(t=e.error)&&t.description?ze(e.error.description):null!=e&&e.success&&ze(ew.language.phrase("SendOTPSuccess"),"success")})).catch((e=>ze(null==e?void 0:e.message)))},setActiveUser:function(e){let t=e.checked?"1":"0",n=new URL(window.location);return n.searchParams.set("activeuser",t),window.location=Le(n.toString()),!1},setFocus:pt,setInvalid:function(e){if(!e)return;let n=t(e);if(Ot(n))return;!e.options&&e.length&&(e=n[0]);let a=n.closest(ye),i=()=>a.find(".is-invalid").removeClass("is-invalid");if(ot(e))a.find(".ew-auto-suggest").removeClass("is-valid").addClass("is-invalid").one("click keydown paste",i);else if(it(e))n.removeClass("is-valid").addClass("is-invalid"),n.data("editor").instance.once("change",i);else if(rt(e))n.removeClass("is-valid").addClass("is-invalid").one("select2:open",i);else if(["checkbox","radio"].includes(e.type))n.removeClass("is-valid").addClass("is-invalid").one("click keydown",i);else{let e=ew.MOBILE_DETECT.version("Safari")&&!ew.MOBILE_DETECT.version("Chrome")?"change keydown paste":"click keydown paste";n.parent().one(e,i),n.add(n.closest(".input-group")).removeClass("is-valid").addClass("is-invalid")}},setLanguage:function(e){let t=e.value||e.dataset.language;if(!t)return!1;let n=new URL(window.location);return n.searchParams.set("language",t),window.location=Le(n.toString()),!1},setLayout:Re,setSearchParam:Ce,setSearchParams:xe,setSearchType:function(e){var t=e.dataset.searchType,n="Auto";"="==t?n="Exact":"AND"==t?n="All":"OR"==t&&(n="Any"),e.closest(".ew-basic-search").querySelector("input.ew-basic-search-type").value=t||"",e.closest(".dropdown-menu").querySelectorAll(".dropdown-item").forEach((e=>e.classList.remove("active"))),e.closest(".dropdown-item").classList.add("active");var a=e.closest(".input-group").querySelector("#searchtype"),i=ew.language.phrase("QuickSearch"+n+"Short");return a.innerHTML=i,a.classList.toggle("me-2",!!i),!1},setSessionTimer:function(){let e,n,a,i,r=()=>{t.get(Ae(ew.API_SESSION_ACTION),{rnd:an()}).then((e=>{e&&t.isObject(e)&&(ew.TOKEN_NAME=e[ew.TOKEN_NAME_KEY],ew.ANTIFORGERY_TOKEN=e[ew.ANTIFORGERY_TOKEN_KEY],e.JWT&&(ew.API_JWT_TOKEN=e.JWT),d())}))},l=()=>{var t;i=ew.SESSION_TIMEOUT_COUNTDOWN,e=ew.SESSION_TIMEOUT-ew.SESSION_TIMEOUT_COUNTDOWN,e<0&&(e=0,i=0),null==(t=n)||t.cancel()},o=()=>{l(),window.location=Le(ew.TIMEOUT_URL+"?expired=1")},s=()=>{var e;if(null==(e=a)||e.cancel(),i>0){let e,t='<p class="text-danger">'+ew.language.phrase("SessionWillExpire")+"</p>";t.includes("%m")&&t.includes("%s")?t=t.replace("%m",'<span class="ew-session-counter-minute">'+Math.floor(i/60)+"</span>").replace("%s",'<span class="ew-session-counter-second">'+i%60+"</span>"):t.includes("%s")&&(t=t.replace("%s",'<span class="ew-session-counter-second">'+i+"</span>")),Swal.fire({...ew.sweetAlertSettings,html:t,showConfirmButton:!0,confirmButtonText:ew.language.phrase("OKBtn"),timer:1e3*i,timerProgressBar:!0,allowOutsideClick:!1,allowEscapeKey:!1,willOpen:()=>{e=setInterval((()=>{let e=Swal.getHtmlContainer(),t=e.querySelector(".ew-session-counter-minute"),n=e.querySelector(".ew-session-counter-second"),a=Math.round(Swal.getTimerLeft()/1e3);t&&n?(t.textContent=Math.floor(a/60),n.textContent=a%60):n&&(n.textContent=a)}),1e3)},willClose:()=>{clearInterval(e)}}).then((e=>{e.value?r():e.dismiss===Swal.DismissReason.timer&&o()}))}else o()},d=()=>{var a;ew.SESSION_TIMEOUT>0&&window.location.pathname!=(null==(a=ew.vars.login)||null==(a=a.login)?void 0:a.url)&&(l(),n=t.later(1e3*e,null,s))};if(ew.SESSION_KEEP_ALIVE_INTERVAL>0||ew.IS_LOGGEDIN&&ew.IS_AUTOLOGIN){let e=Math.max(ew.SESSION_KEEP_ALIVE_INTERVAL||ew.SESSION_TIMEOUT-ew.SESSION_TIMEOUT_COUNTDOWN,ew.MIN_SESSION_KEEP_ALIVE_INTERVAL);a=t.later(1e3*e,null,r,null,!0)}else d()},setValid:ft,setupGrid:_t,setupTable:yt,showBackupCodes:function(){let e="<p>"+ew.language.phrase("BackupCodesMsg")+"</p>";return Ge({title:ew.language.phrase("BackupCodes"),html:e,showDenyButton:!0,showLoaderOnDeny:!0,showCancelButton:!0,confirmButtonText:ew.language.phrase("CopyToClipboard"),denyButtonText:ew.language.phrase("GetNewCodes"),customClass:{denyButton:"btn btn-primary ew-swal2-deny-button"},willOpen:()=>{Swal.showLoading(),Swal.disableButtons(),t.get(Ae([ew.API_2FA_ACTION,ew.API_2FA_BACKUP_CODES])).then((t=>{t.success&&Array.isArray(t.codes)&&(Swal.update({html:e+'<textarea class="form-control ew-backup-codes" readonly>'+t.codes.join("\n")+"</textarea>"}),Swal.enableButtons(),Swal.getConfirmButton().focus())})).fail(((e,t,n)=>ze(n))).always((()=>Swal.hideLoading()))},preConfirm:()=>(Qt(Swal.getHtmlContainer().querySelector("textarea"))&&ze(ew.language.phrase("CopiedToClipboard"),"success"),!1),preDeny:async()=>(Swal.showLoading(Swal.getDenyButton()),await t.get(Ae([ew.API_2FA_ACTION,ew.API_2FA_NEW_BACKUP_CODES])).then((t=>{t.success&&Array.isArray(t.codes)&&(Swal.update({html:e+'<textarea class="form-control ew-backup-codes" readonly>'+t.codes.join("\n")+"</textarea>"}),Swal.getConfirmButton().focus())})).fail(((e,t,n)=>ze(n))).always((()=>Swal.hideLoading())),!1)})},showDrillDown:function(e,n,a,i,r){if(null!=e&&e.ctrlKey){return dn(xe(a,{d:"2"}))}let l=t(n),o=l.data("config")||{},s={obj:l[0],config:{title:r,placement:"bottom",...o},id:i,url:a};ve.trigger("drilldown",[s]);let d=s.url.split("?");s.file=d[0]||"",s.data=d[1]||"",o=s.config,bootstrap.Popover.getInstance(n)||l.popover({...ew.popoverOptions,...o,trigger:"manual",template:'<div class="popover" role="tooltip"><h3 class="popover-header d-none" style="cursor: move;"></h3><div class="popover-body"></div></div>',content:ew.spinnerTemplate(),container:t("#ew-drilldown-panel").draggable(ew.draggableOptions),boundary:"viewport"}).on("show.bs.popover",(function(e){l.attr("data-bs-original-title","")})).on("shown.bs.popover",(function(e){if(!l.data("args"))return;let a=l.data("args").data;t.ajax({cache:!1,dataType:"html",type:"POST",data:a,url:l.data("args").file,success:function(e){let a=t(bootstrap.Popover.getInstance(n)._getTipElement());o.title&&a.find(".popover-header").empty().removeClass("d-none").append('<button type="button" class="btn-close" aria-label="'+ew.language.phrase("CloseBtn")+'"></button>'+o.title).find(".btn-close").on("click",(function(){l.popover("hide")}));let r=e.match(/<body[^>]*>([\s\S]*?)<\/body\s*>/i);e=r?r[0]:e;let s=ew.stripScript(e);a.find(".popover-body").html(t("<div></div>").html(s).find("#ew-report")).find(".ew-table").each(ew.setupTable),ew.executeScript(e,i,!0),l.popover("update")},error:function(e){if(e.responseText){let r=bootstrap.Popover.getInstance(n);if(t.isString(e.responseText)&&e.responseText.startsWith("{")&&e.responseText.endsWith("}")){var a,i;let t=Ke(e.responseText);if(null!=t&&null!=(a=t.error)&&a.type&&null!=t&&null!=(i=t.error)&&i.description)return null==r||r.hide(),Ge({title:t.error.type,html:t.error.description,customClass:{title:"ew-swal2-title text-danger",htmlContainer:"ew-swal2-html-container text-danger"}})}null==r||r.setContent({".popover-body":'<p class="text-danger">'+e.responseText+"</p>"})}}})})).on("hidden.bs.popover",(function(e){ew.removeScript(i)})),l.data("args",s).popover("show")},showMessage:nn,showToast:ze,sort:function(e,t){let{sortUrl:n,sortType:a,context:i,ajax:r}=t;return e.shiftKey&&!e.ctrlKey?n=xe(n,{cmd:"resetsort"}):2==a&&e.ctrlKey&&(n=xe(n,{ctrl:"1"})),tt(r)?un(fetch(Re(n,!1)),i):window.location=Le(n),!1},stripScript:Kt,submitAction:function(e,n){var a;let i=e.currentTarget,r=n.f||i.form||i.closest("form"),l=t(r),o=n.key,s=n.action,d=n.url||Zt(),c=n.msg,u=n.data,p=n.success,f=!n.method||xt(n.method[0],"p"),h=!n.select&&!n.key||n.select&&xt(n.select[0],"m");if((h||f)&&!r)return Ge(ew.language.phrase("NoHtmlForm")),!1;if(h&&!gt(r))return Ge(ew.language.phrase("NoRecordSelected")),!1;let g=function(e){if(t.isString(e))nn(e);else if(t.isObject(e)){let n=De(e);n?Ge(n):t.isString(e.successMessage)&&Ge(e.successMessage,"success"),e.disabled&&(i.disabled=!0)}},m=function(e,n){let a=l.find("input[type=hidden][name='"+e+"']");a[0]?a.val(n):t("<input>").attr({type:"hidden",name:e,value:n}).appendTo(l)},w=function(e){if(f&&r){if(s&&m("action",s),t.isUndefined(e)||m("actionvalue",e),t.isObject(u))for(const[e,t]of Object.entries(u))m(e,t);if(!h&&t.isObject(o))for(const[e,t]of Object.entries(o))m(e,t);Se(d).pathname!=me.pathname&&l.off("submit.ew"),l.prop({action:d,method:"post"}).trigger("submit")}else{u=new URLSearchParams(u),s&&(u.set("action",s),u.set("ajax",s),l.find("#action").remove()),t.isUndefined(e)||u.set("actionvalue",e),u=Ie(u,l.serialize()),!h&&t.isObject(o)&&(u=Ie(u,o)),p&&t.isString(p)&&(p=window[p]);let n=t.isObject(p)?p:{};n.data=u.toString(),n.method||(n.method="POST"),n.success||(n.success=He(p)?p:g),t.ajax(d,n)}};return c=t.isString(c)&&null!=(a=window[c])?a:c,c?We(c).then((e=>e.isDismissed||w(e.value))):w(),!1},toast:Ye,toggleChat:function(e){document.body.style.cursor="wait",t.get(Ae([ew.API_CHAT_ACTION,e]),(n=>{var a;null!=n&&null!=(a=n.error)&&a.description?Ge(n.error.description):null!=n&&n.success&&(t("#disable-chat").toggleClass("d-none",!e),t("#enable-chat").toggleClass("d-none",!!e),t(".chat-wrapper")[e?"fadeIn":"fadeOut"]())})).fail(((e,t,n)=>Ge(n))).always((()=>document.body.style.cursor="default"))},toggleGroup:function e(n){let a=t(n),i=a.closest("tr");if(i.data("group")){let e,n="tr";for(let a=1;a<=6;a++){let r=1==a?"":"-"+a,l=i.data("group"+r);t.isValue(l)&&(e=a,""!=l&&(n+="[data-group"+r+"='"+String(l).replace(/'/g,"\\'")+"']"))}a.hasClass("ew-rpt-grp-hide")?(t(n).slice(1).removeClass("ew-rpt-grp-hide-"+e),a.removeClass("ew-rpt-grp-hide")):(t(n).slice(1).addClass("ew-rpt-grp-hide-"+e),a.addClass("ew-rpt-grp-hide"))}else i.closest("table").find("tbody").find(".ew-rpt-grp-field-1 > .ew-group-toggle").each((function(){e(this),a.toggleClass("ew-rpt-grp-hide")}))},toggleLayout:function(e){var n;null==(n=bootstrap.Tooltip.getInstance(e))||n.hide(),document.body.style.cursor="wait",fetch(Le(Re(e.dataset.url,e.dataset.layout))).then((e=>e.text())).then((e=>{let n=t(".ew-multi-column-grid").html(t("<div>"+e+"</div>").find(".ew-multi-column-grid").html());ew.initPage({target:n[0]}),n.trigger("load.ew")})).catch((e=>Ge(e))).finally((()=>document.body.style.cursor="default"))},togglePassword:function(e){let n=t(e.currentTarget),a=n.closest(".input-group").find("input"),i=n.find("i");"text"==a.attr("type")?(a.attr("type","password"),i.toggleClass("fa-eye-slash fa-eye")):"password"==a.attr("type")&&(a.attr("type","text"),i.toggleClass("fa-eye-slash fa-eye"))},toggleSearchOperator:function(e,t,n){var a=e.currentTarget.form.elements[t];a&&(a.value=a.value!=n?n:"=")},tooltip:zt,updateChart:function(e){let n=new URL(e.form.action),a=t(e).closest(".ew-chart-top, .ew-chart-bottom"),i=t(ew.overlayTemplate());n.search=t(e.form).serialize(),a.addClass("ew-loading").append(i),fetch(n.toString()).then((async e=>{let n=t("<div>"+await e.text()+"</div>"),i=n.find(".ew-chart-top, .ew-chart-bottom").filter("[data-chart='"+a.data("chart")+"']"),r=n.find(".ew-debug");i[0]&&a.replaceWith(i),r[0]&&i.next(".ew-debug").replaceWith(r)})).finally((()=>a.removeClass("ew-loading").find(i).remove()))},updateDropdownPosition:function(){var e=t(".select2-container--open").prev(".ew-select").data("select2");e&&(e.dropdown._positionDropdown(),e.dropdown._resizeDropdown())},updateOptions:Xe,updateSelected:function(e){return!(null==e||!e.querySelector("input[type=checkbox][name^=u_]:checked,input[type=hidden][name^=u_][value='1']"))},upload:function(e){let n=t(e);if(n.data("blueimpFileupload"))return;let a=n.attr("name"),i=a.replace(/\$/g,"\\$"),r=n.data("table"),l=n.is("[multiple]"),o=n.closest(".ew-file-drop-zone"),s=n.closest(ye),d=s.find("#ft_"+i),c=s.find("#fn_"+i),u=s.find("#fa_"+i),p=s.find(".ew-file-label"),f=p.html(),h=function(e){!l&&c.val()&&(confirm(ew.language.phrase("UploadOverwrite"))||(e.preventDefault(),e.stopPropagation()))},g=Ae(ew.API_JQUERY_UPLOAD_ACTION),m=t.templates("#template-download"),w=t.templates("#template-upload"),v=Je(e),b="confirm"==t(v).find("#confirm").val()||n.attr("readonly")||n.prop("disabled");b&&!n.prop("disabled")&&n.prop("disabled",!0);const{acceptFileTypes:y,maxFileSize:_,maxNumberOfFiles:E}=n.data(),A={id:a,table:r,session:ew.SESSION_ID,replace:l?"0":"1",acceptFileTypes:y,maxFileSize:_,maxNumberOfFiles:E};n.fileupload(ew.deepAssign({url:g,type:"POST",multipart:!0,autoUpload:!0,loadImageFileTypes:/^image\/(gif|jpe?g|png)$/i,loadVideoFileTypes:/^video\/mp4$/i,loadAudioFileTypes:/^audio\/(mpeg|mp3)$/i,filesContainer:d,uploadTemplateId:null,downloadTemplateId:null,uploadTemplate:w.render.bind(w),downloadTemplate:m.render.bind(m),previewMaxWidth:ew.UPLOAD_THUMBNAIL_WIDTH,previewMaxHeight:ew.UPLOAD_THUMBNAIL_HEIGHT,dropZone:o,messages:{acceptFileTypes:ew.language.phrase("UploadErrorAcceptFileTypes"),maxNumberOfFiles:ew.language.phrase("UploadErrorMaxNumberOfFiles"),maxFileSize:ew.language.phrase("UploadErrorMaxFileSize"),minFileSize:ew.language.phrase("UploadErrorMinFileSize")},formData:A,readonly:b},ew.uploadOptions)).on("fileuploaddone",(function(e,t){if(t.result.files[0].error)return;let n=t.result.files[0].name,a=l&&c.val()?c.val().split(ew.MULTIPLE_UPLOAD_SEPARATOR):[];a.push(n),c.val(a.join(ew.MULTIPLE_UPLOAD_SEPARATOR)),u.val("0"),l||d.find("tbody > tr:not(:last-child)").remove()})).on("fileuploaddestroy",(function(e,t){let n=Oe(e.originalEvent.target.dataset.url),a=n.get("id"),i=n.get(a);if(i){let e=c.val()?c.val().split(ew.MULTIPLE_UPLOAD_SEPARATOR):[],t=e.indexOf(i);t>-1&&e.splice(t,1),c.val(e.join(ew.MULTIPLE_UPLOAD_SEPARATOR)),u.val("0")}})).on("fileuploadchange",(function(e,a){var i;d.toggleClass("ew-has-rows",(null==(i=a.files)?void 0:i.length)>0);let r=c.val()?c.val().split(ew.MULTIPLE_UPLOAD_SEPARATOR):[];a.files.forEach((e=>r.push(e.name)));let l=n.data("maxNumberOfFiles");if(t.isNumber(l)&&l>0&&r.length>l)return Ge(ew.language.phrase("UploadErrorMaxNumberOfFiles")),!1;let o=n.data("size");return t.isNumber(o)&&o>0&&r.join(ew.MULTIPLE_UPLOAD_SEPARATOR).length>o?(Ge(ew.language.phrase("UploadErrorMaxFileLength")),!1):void 0})).on("fileuploadadded fileuploadfinished fileuploaddestroyed",(function(e,t){var n,a;d.toggleClass("ew-has-rows",(null==(n=t.files)?void 0:n.length)>0||(null==(a=t.result)||null==(a=a.files)?void 0:a.length)>0);let i=c.val()?c.val().split(ew.MULTIPLE_UPLOAD_SEPARATOR):[];p.html(i.join(", ")||f)})).on("fileuploadadded",(function(e,t){var n;d.toggleClass("ew-has-rows",(null==(n=t.files)?void 0:n.length)>0),t.context.find(".start").click(h)})).on("fileuploadcompleted",(function(e,t){let n={target:t.context};$e(n),Ue(n),ew.updateDropdownPosition(),t.context.find("img").on("load",ew.updateDropdownPosition)})),c.val()&&t.ajax({url:g,data:{id:a,table:r,session:ew.SESSION_ID},dataType:"json",context:this,success:function(i){if(null!=i&&i[a]){let r=n.fileupload("option","done");r&&r.call(e,t.Event(),{result:{files:i[a]}})}b&&d.find("td.delete").hide()}})},valueChanged:function(e,t,n,a){let i=St("x"+t+"_"+n,e),r=St("o"+t+"_"+n,e),l=St("fn_x"+t+"_"+n,e);if("hidden"==(null==i?void 0:i.type)&&!r)return!1;if(!r&&(!i||Array.isArray(i)&&0==i.length))return!1;if(r&&i)if(a){if(tt(Nt(r))===tt(Nt(i)))return!1}else{if(Nt(r)==Nt(l||i))return!1}return!0},valueSeparator:kt};var hn={__proto__:null,fullCalendar:function(e,n,a){let i,{ajax:r,updateTable:l,eventFields:o,addUrl:s,viewUrl:d,editUrl:c,deleteUrl:u,copyUrl:p,fullCalendarOptions:f,eventPopoverOptions:h}=n;delete n.addUrl;let g=e=>{let n=(e,n)=>{let a;return"string"==typeof n&&(a=n.match(/^(\d{4}-\d{2}-\d{2}) (\d{2}:\d{2}:\d{2})/))?a[1]+"T"+a[2]:"allDay"==e?ew.convertToBool(n):"url"!=e||n?"display"!=e||n?"classNames"==e&&n&&t.isString(n)?n.replace(/\s+/g," ").split(" "):"classNames"!=e||n?("groupId"!=e||n)&&("description"!=e||n)?n:"":[""]:"auto":""};if(e.success){let t=e.action,r=e[l];Array.isArray(r)||(r=[r]);for(let e of r){for(let[t,n]of Object.entries(o))t!=n&&null!==n&&n in e&&(e[t]=e[n],delete e[n]);var a;if(t==ew.API_DELETE_ACTION)null==(a=i.getEventById(e.id))||a.remove();else if(t==ew.API_ADD_ACTION){for(let t in e){let a=Object.keys(o).find((e=>e===t)),i=e[t];a&&void 0!==i&&(e[a]=n(a,i))}i.addEvent(e)}else{let t=i.getEventById(e.id),a=e.groupId;for(let i in e){let r=Object.keys(o).find((e=>e===i)),l=n(r,e[i]);r&&void 0!==l?(l=n(r,l),"start"==r?t.setStart(l):"end"==r?t.setEnd(l):"allDay"==r?t.setAllDay(l):"description"==r?t.setExtendedProp(r,l):"id"==r||a||t.setProp(r,l)):l&&t.setExtendedProp(i,l)}}}}},m=e=>{let t=e.event,n=[t,...e.relatedEvents],a=t.id?ew.API_EDIT_ACTION:ew.API_ADD_ACTION;n.forEach((t=>w(t,a).then((t=>{t.success?g(t):e.revert()})).catch((t=>{console.log(t),e.revert()}))))},w=(e,n)=>new Promise(((a,i)=>{let r=e.toPlainObject({collapseExtendedProps:!0}),s={};for(let[e,t]of Object.entries(o))if(e in r){let n=r[e];t||(t=e),n instanceof Date?n=n.toISOString().slice(0,-5).replace(/T/," "):"string"==typeof n&&n.match(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/)?n=n.substring(0,19).replace(/T/," "):"boolean"==typeof n?n=n?"1":"0":"classNames"==e&&(n=Array.isArray(n)?n.join(" "):n),s[t]=n,delete r[e]}s={...s,...r};let d=n==ew.API_ADD_ACTION?ew.getApiUrl([n,l]):ew.getApiUrl([n,l,e.id]);t.post(d,s,(e=>a(e))).fail((e=>i(e)))})),v=e=>Object.keys(currentTable.fields).find((t=>currentTable.fields[t].name==e)),b=(e,t)=>{let n=e.split("?");return n[0]+=t?(n[0].endsWith("/")?"":"/")+t:"",n.join("?")},y=e=>{let n=s,a=new URLSearchParams;if(t.isObject(e)&&(e.startStr||e.endStr)){let t=v(o.start),n=v(o.end);t&&e.startStr&&a.set(t,e.startStr),n&&e.endStr&&a.set(n,e.endStr)}t.isString(e)&&e.match(/^\d+$/)&&(n=b(n,e));let i=a.toString();n+=i?"?"+i:"",ew.modalDialogShow({url:n,callback:r?g:null,json:r,btn:ew.language.phrase("AddBtn"),caption:ew.language.phrase("AddLink")})},_=e=>ew.modalDialogShow({url:b(d,e),callback:r?g:null,json:r,btn:null,caption:ew.language.phrase("ViewLink")});s&&(f.customButtons={add:{text:ew.language.phrase("AddEvent"),click:y}},f.headerToolbar.left+=" add");let E,A=e=>{let n={...bootstrap.Popover.Default,...h,trigger:"manual"},a=bootstrap.Popover.getOrCreateInstance(e.el,n),i=Array.from(document.querySelectorAll("script[data-name='event-popover']")).sort(((e,t)=>(e=parseInt(e.dataset.seq,10)||0)-(t=parseInt(t.dataset.seq,10)||0))).shift(),r=t.templates(i.text);e.event.setExtendedProp("timeSpan",ew.formatTimeSpan(e.event.start,e.event.end,e.event.allDay));let l=r.render(e.event,ew.jsRenderHelpers).trim();if(l){var o,s;let t=null!=(o=null==(s=Array.from(e.el.classList.values()).find((e=>e.match(/^event-([\w+]+)\b/))))?void 0:s.replace(/^event-/,"popover-"))?o:"popover-default";return a._templateFactory=null,a._config.title=e.event.title,a._config.content=l,a._config.customClass+=(a._config.customClass?" ":"")+"ew-event-popover "+t,a}return null},S=e=>{let t=0,n=0;if(e){let a=e.el.getBoundingClientRect(),i=e.jsEvent;t=a.left+i.offsetX,n=a.top+i.offsetY}return()=>({width:0,height:0,top:n,right:t,bottom:n,left:t})},T={getBoundingClientRect:S()};a&&n.useContextMenu&&(d||c||s&&p||u)&&(a.dataset.bsToggle="dropdown",document.addEventListener("keydown",(e=>"Escape"!==e.key||bootstrap.Dropdown.clearMenus())),E=bootstrap.Dropdown.getOrCreateInstance(a,{reference:T}),E._menu.querySelectorAll(".dropdown-item").forEach((e=>e.addEventListener("click",(e=>{let t=e.currentTarget.dataset,n=t.action,a=t.eventId;n&&a&&("view"==n&&d?_(a):"edit"==n&&c?(e=>{ew.modalDialogShow({url:b(c,e),callback:r?g:null,json:r,btn:null,caption:ew.language.phrase("EditLink")})})(a):"copy"==n&&s&&p?y(a):"delete"==n&&u&&(e=>{ew.prompt(ew.language.phrase("DeleteEventConfirm"),(t=>{t&&ew.modalDialogShow({url:ew.setSearchParams(b(u,e),{action:"delete"}),callback:r?g:null,json:r})}))})(a))})))));let O={element:e,options:ew.deepAssign(f,{drop:function(e){document.getElementById("remove-event").checked&&e.draggedEl.parentNode.removeChild(e.draggedEl)},select:e=>s&&y(e),eventReceive:m,eventDragStart:e=>{var t;return null==(t=bootstrap.Popover.getInstance(e.el))?void 0:t.hide()},eventDrop:m,eventResize:m,eventClick:e=>{if(e.jsEvent.preventDefault(),2==e.jsEvent.button){let a=e.event.extendedProps._view||e.event.extendedProps._edit||e.event.extendedProps._copy||e.event.extendedProps._delete;var t;if(E&&a)null==(t=bootstrap.Popover.getInstance(e.el))||t.hide(),E.hide(),E._menu.querySelectorAll(".dropdown-item").forEach((t=>{t.dataset.eventId=e.event.id,t.classList.toggle("d-none",!n[t.dataset.action+"Url"]||!e.event.extendedProps["_"+t.dataset.action])})),E._menu.querySelectorAll(".dropdown-item:not(.d-done)").length&&(T.getBoundingClientRect=S(e),E.show())}else if(e.event.url)window.open(e.event.url);else if(n.usePopover&&h.trigger.match(/\bclick\b/)){var a;null==(a=A(e))||a.toggle()}else n.showViewPageOnEventClick&&_(e.event.id)},eventMouseEnter:e=>{var t,a;null!=(t=E)&&t._isShown(E._menu)||n.popoverViews.includes(e.view.type)&&n.usePopover&&h.trigger.match(/\bhover\b/)&&(null==(a=A(e))||a.show())},eventMouseLeave:e=>{var t,a;null!=(t=E)&&t._isShown(E._menu)||n.popoverViews.includes(e.view.type)&&n.usePopover&&h.trigger.match(/\bhover\b/)&&(null==(a=bootstrap.Popover.getInstance(e.el))||a.hide())}})};return t(document).trigger("calendar",[O]),i=new window.FullCalendar.Calendar(e,O.options),i}};function gn(){return"serviceWorker"in navigator&&"PushManager"in window}function mn(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=window.atob(t),a=new Uint8Array(n.length);for(let e=0;e<n.length;++e)a[e]=n.charCodeAt(e);return a}async function wn(t,n){const a=t.getKey("p256dh"),i=t.getKey("auth"),r=(PushManager.supportedContentEncodings||["aesgcm"])[0];let l=new FormData;return l.set("endpoint",t.endpoint),l.set("publicKey",a?btoa(String.fromCharCode.apply(null,new Uint8Array(a))):null),l.set("authToken",i?btoa(String.fromCharCode.apply(null,new Uint8Array(i))):null),l.set("contentEncoding",r),(await e.fetch(n,{method:"POST",body:l})).json()}async function vn(){var t;let n=e.getApiUrl([e.API_PUSH_NOTIFICATION_ACTION,e.API_PUSH_NOTIFICATION_SUBSCRIBE]),a=await navigator.serviceWorker.ready,i=await a.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:mn(e.PUSH_SERVER_PUBLIC_KEY)}),r=await wn(i,n);return null!=r&&null!=(t=r.error)&&t.description&&e.alert(r.error.description),r.success?i:null}async function bn(){return(await navigator.serviceWorker.ready).pushManager.getSubscription()}function yn(n){let a=t("#subscribe-notification").toggleClass("ew-enable-notification",!n).removeClass("disabled");a.find("i").toggleClass("fa-bell",!n).toggleClass("fa-bell-slash",!!n);let i=bootstrap.Tooltip.getInstance(a[0]);i&&(i._config.title=e.language.phrase(n?"DisableNotifications":"EnableNotifications"))}async function _n(){if("denied"!==Notification.permission&&!e.IS_SYS_ADMIN){document.body.style.cursor="wait";try{var t,n;if("granted"===Notification.permission)yn(null!=(t=await bn())?t:await vn()),null!=(n=document.getElementById("subscribe-notification"))&&n.classList.contains("ew-enable-notification")||e.showToast(e.language.phrase("NotificationsEnabled"),"success");else if("default"===Notification.permission&&"granted"==await Notification.requestPermission()){var a;yn(await vn()),null!=(a=document.getElementById("subscribe-notification"))&&a.classList.contains("ew-enable-notification")||e.showToast(e.language.phrase("NotificationsEnabled"),"success")}}catch(t){e.alert(t)}finally{document.body.style.cursor="default"}}return!1}async function En(){return t("#subscribe-notification").tooltip(),"granted"==Notification.permission?yn(await bn()):yn(null),!0}async function An(){return e.prompt({html:e.language.phrase("DisableNotificationsConfirm")},(async t=>{if(t){document.body.style.cursor="wait";try{var n;let t=await bn();await t.unsubscribe();let a=e.getApiUrl([e.API_PUSH_NOTIFICATION_ACTION,e.API_PUSH_NOTIFICATION_DELETE]),i=await wn(t,a);if(null!=i&&null!=(n=i.error)&&n.description)return e.alert(i.error.description),!1;i.success&&(yn(null),e.showToast(e.language.phrase("NotificationsDisabled"),"success"))}catch(t){e.alert(t)}finally{document.body.style.cursor="default"}}})),!1}loadjs.ready("foot",(()=>{e.PUSH_SERVER_PUBLIC_KEY&&gn()?navigator.serviceWorker.register(e.PATH_BASE+e.SERVICE_WORKER,{scope:e.PATH_BASE}).then((()=>{En(),t("#subscribe-notification").on("click",(function(){this.classList.contains("ew-enable-notification")?_n():An()}))})).catch((e=>console.log(e))):t("#subscribe-notification").addClass("d-none")}));var Sn={__proto__:null,checkSubscription:En,isPushNotificationSupported:gn,pushNotificationDialogShow:async function(n){let a=e.pushDialog||t("#ew-push-notification-dialog").on("shown.bs.modal",(e=>setTimeout((()=>{var t;return null==(t=e.target.querySelector(".modal-body .form-control"))?void 0:t.focus()}),200))).on("click",".modal-footer .btn-primary",(function(e){var n;e.preventDefault(),null!=(n=t(this).closest(".modal").find(".modal-body form").data("form"))&&n.submit()&&a.modal("hide")}));if(!a[0])return console.log("DIV #ew-push-notificatoin-dialog not found"),!1;if(!n.url)return console.log("Missing URL of Web Push API"),!1;let i=n.evt.currentTarget,r=t(i.form),l=a.find(".modal-body form"),o=l.data("form");if(l.data("all",!1),!r.find("input[name='key_m[]']:checked")[0]){let t=await e.prompt(e.language.phrase("SendPushNotificationsToAll"),(e=>e));if(l.data("all",t),!t)return}return o||(o=(new e.FormBuilder).setId(l.attr("id")).addFields([["title",e.Validators.required(e.language.phrase("PushNotificationFormTitle"))],["body",e.Validators.required(e.language.phrase("PushNotificationFormBody"))]]).setValidate((function(){return this.validateFields()})).setSubmit((function(){if(!this.validate())return!1;let a=[l.serialize(),l.data("all")?"":r.find("input[name='key_m[]']:checked").serialize()].join("&");return t.post(n.url,a,(t=>{var n;if(Array.isArray(t)){let n=t.reduce(((e,t)=>e+(t.success?1:0)),0),a=t.length-n;n>0&&0==a?e.alert(e.language.phrase("PushNotificationSuccess").replace("%s",n),"success"):0==n&&a>0?e.alert(e.language.phrase("PushNotificationFailure").replace("%f",a)):0==n&&0==a?e.alert(e.language.phrase("NoSubscriptions").replace("%f",a),"primary"):e.alert(e.language.phrase("PushNotificationSent").replace("%s",n).replace("%f",a),"primary")}else null!=t&&null!=(n=t.error)&&n.description&&e.alert(t.error.description)})),!0})).build(),l.data("form",o)),e.pushDialog=a.modal("hide").find(".modal-title").html(n.hdr||i.dataset.caption).end().modal("show"),!1},subscribeNotification:_n,unsubscribeNotification:An};function Tn(e){if(e.inited)return!0;let n=e.latlng,a=t("#"+e.id),i=e.useSingleMap,r=e.showAllMarkers,l=e.useMarkerClusterer,o=ew.maps[e.ext];if(i){let n=e.id.replace(/^mp\d*_/,"mp_");a=t("#"+n),a[0]||(a=t("<div></div>").attr("id",n).addClass("ew-single-map").height(e.singleMapHeight),e.singleMapWidth&&a.width(e.singleMapWidth),t(".ew-grid, .ew-multi-column-grid").first()[e.showMapOnTop?"before":"after"](a),e.map=o.createMap(a[0],e),a.data("map",e.map),a.data("ext",e.ext),a.data("bounds",r?o.createBounds():null),a.data("markerClusterer",l?o.createMarkerClusterer(e):null)),e=Object.assign(e,a.data())}else{if(!n)return a.addClass("d-none").html(e.status),!0;a.next(".ew-map-value").addClass("d-none"),e.map||(e.map=o.createMap(a[0],e))}return e.marker=o.createMarker(e),e.inited=!0,t(document).trigger("map",[e]),!0}function On(){t(".ew-single-map").each((function(){let e=t(this).data();ew.maps[e.ext].fitBounds(e)})),t(document).trigger("maps")}function xn(e){let n=t(".ew-map").filter((function(){return!e||t(this).data("ext")==e})).map((function(e){let n=t(this).data();if(n.inited)return Tn(n);if(n.id=this.id,n.address=(n.address||"").trim(),n.address){let a=n.geocodingDelay;return new Promise((i=>{t.later(e*a,null,(()=>{i(ew.maps[n.ext].geocode(n).then((e=>{n.latlng=e})).catch((e=>{n.status=e})).finally((()=>Tn(n))))}))}))}{let e=n.latitude,t=n.longitude,a=n.coordinate;if(a){let n=a.match(/[-.\d]+/g);Array.isArray(n)&&2==n.length&&(e=parseFloat(n[0]),t=parseFloat(n[1]))}return e&&!isNaN(e)&&t&&!isNaN(t)&&(n.latlng=ew.maps[n.ext].createLatLng(e,t)),Tn(n)}})).get();return Promise.all(n).then(On)}t((function(){t("#ew-modal-dialog").on("load.ew",(()=>xn())),t(document).on("preview.ew",(()=>xn()))}));var In={__proto__:null,done:On,init:xn,show:Tn};ew.MOBILE_DETECT=new MobileDetect(window.navigator.userAgent),ew.IS_MOBILE=!!ew.MOBILE_DETECT.mobile(),window.exportCharts={},Object.assign(ew,{MultiPage:function(e){var n=this;this.$form=null,this.formID=e,this.pageIndex=1,this.maxPageIndex=0,this.minPageIndex=0,this.pageIndexes=[],this.$pages=null,this.$collapses=null,this.isTab=!1,this.isCollapse=!1,this.lastPageSubmit=!1,this.hideDisabledButton=!1,this.hideInactivePages=!1,this.lockTabs=!1,this.hideTabs=!1,this.showPagerTop=!1,this.showPagerBottom=!1,this.pagerTemplate='<nav><ul class="pagination"><li class="page-item previous ew-prev"><a href="#" class="page-link"><i class="fa-solid fa-angle-left"></i> {Prev}</a></li><li class="page-item next ew-next"><a href="#" class="page-link">{Next} <i class="fa-solid fa-angle-right"></i></a></li></ul></nav>';var a=function(e){e.preventDefault()},i=["lastPageSubmit","hideDisabledButton","hideInactivePages","lockTabs","hideTabs","showPagerTop","showPagerBottom","pagerTemplate"];this.set=function(){if(1==arguments.length&&t.isObject(arguments[0])){var e=arguments[0];for(var n in e){var a=n[0].toLowerCase()+n.substring(1);i.includes(a)&&(this[a]=e[n])}}},this.init=function(){var e=this.pagerTemplate.replace(/\{prev\}/i,ew.language.phrase("Prev")).replace(/\{next\}/i,ew.language.phrase("Next"));this.isTab?(this.showPagerTop&&this.$pages.closest(".ew-nav").before(e),this.showPagerBottom&&this.$pages.closest(".ew-nav").after(e),this.$form.find(".ew-prev").click((function(e){return n.$pages.off("show.bs.tab",a).filter(".active").parent().prev(":has([data-bs-toggle=tab]:not(.ew-hidden):not(.ew-disabled))").find("[data-bs-toggle=tab]").toggleClass("disabled d-none",!1).click(),!1})),this.$form.find(".ew-next").click((function(e){return n.$pages.off("show.bs.tab",a).filter(".active").parent().next(":has([data-bs-toggle=tab]:not(.ew-hidden):not(.ew-disabled))").find("[data-bs-toggle=tab]").toggleClass("disabled d-none",!1).click(),!1})),this.hideTabs&&this.$form.find(".ew-multi-page > .ew-nav > .nav").hide()):this.isCollapse&&(this.showPagerTop&&this.$collapses.closest(".ew-accordion").before(e),this.showPagerBottom&&this.$collapses.closest(".ew-accordion").after(e),this.$form.find(".ew-prev").click((function(e){return n.$pages.closest(".accordion-item").filter(":has(.collapse.show)").prev(":has([data-bs-toggle=collapse]:not(.ew-hidden):not(.ew-disabled))").toggleClass("disabled d-none",!1).find("[data-bs-toggle=collapse]").click(),!1})),this.$form.find(".ew-next").click((function(e){return n.$pages.closest(".accordion-item").filter(":has(.collapse.show)").next(":has([data-bs-toggle=collapse]:not(.ew-hidden):not(.ew-disabled))").toggleClass("disabled d-none",!1).find("[data-bs-toggle=collapse]").click(),!1}))),this.pageShow()},this.pageShow=function(){this.isTab?(this.lockTabs&&this.$pages.on("show.bs.tab",a),this.$pages.each((function(){var e=t(this);n.hideInactivePages&&e.toggleClass("d-none",!e.hasClass("active")),n.lockTabs&&e.toggleClass("disabled",!e.hasClass("active"))}))):this.isCollapse&&this.$pages.closest(".accordion-item").each((function(){var e=t(this);n.hideInactivePages&&e.toggleClass("d-none",!e.find(".collapse.show")[0])}));var e=this.lastPageSubmit&&this.pageIndex!=this.maxPageIndex,i=this.$form.closest(".content, .modal-content").find("#btn-action, button.ew-submit").prop("disabled",e).toggle(!this.hideDisabledButton||!e);t(".ew-captcha").toggle(i.is(":visible:not(:disabled)")),e=this.pageIndex<=this.minPageIndex,this.$form.find(".ew-prev").toggleClass("disabled",e),e=this.pageIndex>=this.maxPageIndex,this.$form.find(".ew-next").toggleClass("disabled",e)},this.gotoPage=function(e){if(!(e<=0||e<this.minPageIndex||e>this.maxPageIndex)&&this.pageIndex!=e){var t=this.$pages.eq(e-1);if(this.isTab)t.is(":not(.d-none):not(.disabled)")?t.click():t.parent().next(":has([data-bs-toggle=tab]):not(.d-none):not(.disabled)").find("[data-bs-toggle=tab]").toggleClass("disabled",!1).click();else if(this.isCollapse){var n=t.closest(".accordion-item");n.is(":not(.d-none)")?t.click():n.next(":has([data-bs-toggle=collapse]):not(.d-none)").find("[data-bs-toggle=collapse]").click()}this.pageIndex=e}},this.gotoPageByIndex=this.gotoPage,this.gotoPageByElement=function(e){this.gotoPage(parseInt(t(e).data("page"),10)||-1)},this.gotoPageByElementId=function(e){var t=this.$form.find("[data-page]").filter("[id='"+e+"'],[name='"+e+"'],[data-field='"+e+"']");this.gotoPageByElement(t)},this.togglePage=function(e,t){this.isTab?this.$pages.eq(e-1).toggleClass("d-none",!t):this.isCollapse&&this.$pages.eq(e-1).closest(".accordion-item").toggle("d-none",!t)},this.render=function(){this.$form=t("#"+e),this.pageIndexes=this.$form.find("[data-page]").map((function(){var e=parseInt(this.dataset.page,10);return e>0?e:null})).get(),this.pageIndexes.sort((function(e,t){return e-t})),this.minPageIndex=this.pageIndexes[0],this.maxPageIndex=this.pageIndexes[this.pageIndexes.length-1];var a=this.$form.find("[data-bs-toggle=tab]");if(a[0])this.$pages=a,this.isTab=!0,a.on("shown.bs.tab",(function(e){n.pageIndex=a.index(e.target)+1,n.pageShow(),t(t(this).attr("href")).find(".ew-map").each((function(){var e=ew.maps[this.id];null!=e&&e.map&&(google.maps.event.trigger(e.map,"resize"),e.map.setCenter(e.latlng))}))})),this.pageIndex=a.index(a.parent(".active"))+1;else if(this.$collapses=this.$form.find("[data-bs-toggle=collapse]"),this.$collapses[0]){this.$pages=this.$collapses,this.isCollapse=!0;var i=this.$collapses;i.on("shown.bs.collapse",(function(e){n.pageIndex=i.index(e.target)+1,n.pageShow(),t(this).find(".ew-map").each((function(){var e=ew.maps[this.id];null!=e&&e.map&&(google.maps.event.trigger(e.map,"resize"),e.map.setCenter(e.latlng))}))})),this.pageIndex=i.index(i.hasClass("show"))+1}t((function(){n.init()}))}},Form:w,FormBuilder:v,Validators:i,maps:In},fn,Sn,hn);var Cn=t(document);loadjs.ready("load",(function(){var e;t.views.settings.debugMode(ew.DEBUG),ew.setSessionTimer(),ew.initPage(),t("#ew-modal-dialog").on("load.ew",ew.initPage),t("#ew-add-opt-dialog").on("load.ew",ew.initPage);let n=ew.currentUrl.searchParams.get("hash"),a=null==(e=t("#"+n).offset())?void 0:e.top;a&&t("html, body").animate({scrollTop:a},800),Cn.trigger("load.ew")})),Cn.on("addoption",(function(e,n){let a=n.data,i=n.parents;for(let e=0,r=i.length;e<r;e++){let r=i[e];if(!r.length)return n.valid=!1;let l=a["ff"+(e>0?e+1:"")];if(!t.isUndefined(l)&&!r.includes(String(l)))return n.valid=!1}})),Cn.on("click","[data-ew-action]:not([data-ew-action=''])",(function(e){let n=Object.assign({},t(this).data()),a=n.ewAction;if(!a)return!0;if("none"==a)return!1;if("redirect"==a)return ew.redirect(n.url);if("reload"==a)return location.reload(),!1;if("submit"==a)return delete n.ewAction,ew.submitAction(e,n);if("modal"==a)return e.preventDefault(),n.ajax?ew.inlineAction({evt:e,...n}):ew.modalDialogShow({evt:e,...n});if("inline"==a||"grid"==a)return e.preventDefault(),ew.inlineAction({evt:e,...n});if("export"==a)return ew.export({evt:e,...n});if("layout"==a)return ew.toggleLayout(this);if("language"==a)return ew.setLanguage(this);if("active-user"==a)return ew.setActiveUser(this);if("filter"==a)return ew.filter(e);if("sort"==a)return ew.sort(e,this.dataset);if("refresh"==a){let e=ew.setLayout(this.dataset.url,!1);return e&&"#"!=e&&ew.refresh(fetch(e),this.dataset.context),!1}if("email"==a)return delete n.ewAction,ew.emailDialogShow({evt:e,...n});if("set-action"==a)this.form.elements.action.value=n.value;else{if("drilldown"==a)return ew.showDrillDown(e,this,n.url,n.id,n.hdr);if("add-option"==a)return delete n.ewAction,ew.addOptionDialogShow({evt:e,...n});if("search-type"==a)return ew.setSearchType(this);if("search-operator"==a)ew.toggleSearchOperator(e,n.target,n.value);else if("search-toggle"==a){let e=document.getElementById(this.dataset.form+"_search_panel");e&&(bootstrap.Collapse.getOrCreateInstance(e).toggle(),this.classList.toggle("active"))}else if("highlight"==a)t("mark."+this.dataset.name).toggleClass("mark"),this.classList.toggle("active");else{if("inline-delete"==a)return ew.confirmDelete(this);if("add-grid-row"==a)return ew.addGridRow(this);if("delete-grid-row"==a)return ew.deleteGridRow(this,this.dataset.rowindex);if("select-all"==a)ew.selectAll(this);else if("select-key"==a)ew.selectKey(e);else if("select-all-keys"==a)ew.selectAllKeys(this);else{if("import"==a)return ew.importDialogShow({evt:e,hdr:n.hdr});if("password"==a)return ew.togglePassword(e);if("push"==a)return ew.pushNotificationDialogShow({evt:e,url:n.apiUrl});if("enable-2fa"==a)return ew.enable2FA();if("disable-2fa"==a)return ew.disable2FA();if("toggle-chat"==a)return ew.toggleChat(n.value);var i;if("send-otp"==a)return ew.sendOTP(null==(i=document.getElementById(n.account))?void 0:i.value);if("backup-codes"==a)return ew.showBackupCodes();if("scroll-top"==a)return t(document).scrollTop(t("#top").offset().top),!1}}}})).on("change","[data-ew-action]:not([data-ew-action=''])",(function(e){let n=Object.assign({},t(this).data());if(!n.ewAction)return!0;let a=n.ewAction.split(" ").filter((e=>!!e));for(let e of a)if("submit-form"==e){var i;null==(i=this.form)||i.submit()}else{if("change-page-size"==e){let e=ew.sameText(this.value,"ALL")?"ALL":ew.parseNumber(this.value);if(ew.convertToBool(n.ajax)){let t=ew.setLayout(this.dataset.url,!1)+"&"+this.name+"="+e;ew.refresh(fetch(t),this.dataset.context)}else{let t=ew.setSearchParam(this.dataset.url,this.name,e);ew.redirect(t)}return!1}if("update-options"==e)ew.updateOptions.call(this);else if("autofill"==e)ew.autoFill(this);else{if("search-operator"==e)return ew.searchOperatorChange(this);"language"==e?ew.setLanguage(this):"chart-order"==e&&ew.updateChart(this)}}})).on("keydown","[data-ew-action]:not([data-ew-action=''])",(function(e){let n=Object.assign({},t(this).data());if("change-page"==n.ewAction&&"Enter"==e.key){if(ew.convertToBool(n.ajax)){let e=ew.setLayout(this.dataset.url,!1)+"&"+this.name+"="+ew.parseNumber(this.value);ew.refresh(fetch(e),this.dataset.context)}else ew.currentUrl.searchParams.set(this.name,ew.parseNumber(this.value)),window.location=ew.sanitizeUrl(ew.currentUrl.toString());return!1}})),Cn.on("click",".ew-row-link",(e=>e.stopPropagation())),Cn.on("show.bs.modal",".modal",(function(){var e=1050+t(".modal:visible").length;t(this).css("z-index",e),setTimeout((function(){t(".modal-backdrop").not(".modal-stack").css("z-index",e-1).addClass("modal-stack")}),0)})),Cn.on("hidden.bs.modal",".modal",(function(){t(".modal:visible").length&&t("body").addClass("modal-open")})),t.blueimp.fileupload.prototype.options.processQueue.unshift({action:"cropImage",fileTypes:"@loadImageFileTypes",maxFileSize:"@loadImageMaxFileSize",cropperOptions:"@",cropperCanvasOptions:"@",disabled:"@disableImageCrop"}),t.widget("blueimp.fileupload",t.blueimp.fileupload,{processActions:{cropImage:function(e,n){let a=e.files[e.index];if(n.disabled||t.isNumber(n.maxFileSize)&&a.size>n.maxFileSize||n.fileTypes&&!n.fileTypes.test(a.type))return e;let i=URL.createObjectURL(a),r=t.Deferred(),l=this,o=ew.cropperDialog||t("#ew-cropper-dialog").on("shown.bs.modal",(function(){o.data("cropper",new Cropper(this.querySelector("#ew-crop-image"),n.cropperOptions))})).on("hidden.bs.modal",(function(){var e;null==(e=o.data("cropper"))||e.destroy(),o.removeData("cropper"),o.find("#ew-crop-image").attr("src","data:image/png;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=")}));return ew.cropperDialog=o,o.find("#ew-crop-image").attr("src",i),o.find(".ew-crop-btn").off("click").on("click",(function(){if(o.data("cropper"))try{o.data("cropper").getCroppedCanvas(n.cropperCanvasOptions).toBlob((t=>{e.files[e.index]=new File([t],a.name,{type:a.type}),r.resolveWith(l,[e])}),a.type)}catch(t){ew.alert(t),r.rejectWith(l,[e])}finally{o.modal("hide")}})),o.find(".ew-skip-btn").off("click").on("click",(function(){r.resolveWith(l,[e]),o.modal("hide")})),o.modal("show"),r.promise()}}}),t.extend({isBoolean:function(e){return"boolean"==typeof e},isNumber:function(e){return"number"==typeof e&&isFinite(e)},isObject:function(e){return e&&("object"==typeof e||this.isFunction(e))||!1},isString:function(e){return"string"==typeof e},isUndefined:function(e){return"undefined"==typeof e},isValue:function(e){return this.isObject(e)||this.isString(e)||this.isNumber(e)||this.isBoolean(e)},isDate:function(e){return"date"===this.type(e)&&"Invalid Date"!==e.toString()&&!isNaN(e)},later:function(e,t,n,a,i){e=e||0,t=t||{};var r,l,o=n,s=a;if(this.isString(n)&&(o=t[n]),o)return this.isUndefined(a)||this.isArray(s)||(s=[a]),r=function(){o.apply(t,s||[])},l=i?setInterval(r,e):setTimeout(r,e),{interval:i,cancel:function(){this.interval?clearInterval(l):clearTimeout(l)}}}}),t.fn.fields=function(e){let n,a,i,r={},l=this.attr("id"),o=this[0],s=l.match(/^[xy](\d*)_/);s?(n=ew.getForm(o),a=this.data("table"),i=s[1]):null!=o&&o.htmlForm&&(n=o.$element,a=o.id.replace(new RegExp("^f|"+o.pageId+"$","g"),""),i=o.htmlForm.dataset.rowindex);let d="[data-table"+(a?"="+a:"")+"][data-field"+(e?"=x_"+e:"")+"]"+(t.isValue(i)?"[name^=x"+i+"]":"")+":not(.ew-custom-option)";return n&&d&&t(n).find(d).each((function(){let e=this.dataset.field.substring(2),n=this.getAttribute("name");e=/^y_/.test(n)?"y_"+e:e,r[e]=r[e]?r[e].add(this):t(this)})),e?r[e]:r},t.fn.extend({row:function(){var e;let t=this.closest("#r_"+(null==(e=this.data("field"))?void 0:e.substring(2)));return t[0]||(t=this.closest(".ew-table > tbody > tr")),t},visible:function(e){var t;let n=this.closest("#r_"+(null==(t=this.data("field"))?void 0:t.substring(2)));return n[0]||(n=this.closest("[id^=el]")),"undefined"!=typeof e?(n.toggle(e),this):$el.is(":visible")},readonly:function(e){return"undefined"!=typeof e?(this.prop("readOnly",e),this):this.prop("readOnly")},disabled:function(e){return"undefined"!=typeof e?(this.prop("disabled",e),this):this.prop("disabled")},value:function(e){return"undefined"!=typeof e?(ew.selectOption(this[0],e),this):ew.getValue(this[0])},toNumber:function(){return ew.parseNumber(this.value())},toDate:function(){var e;let t=this.data(),n=t.table,a=t.field.replace(/^[xy]_/,""),i=null==(e=ew.vars.tables)||null==(e=e[n])||null==(e=e.fields)||null==(e=e[a])?void 0:e.clientFormatPattern;return ew.parseDateTime(this.value(),i)},toJsDate:function(){return this.toDate().toJSDate()}}),bootstrap.Dropdown.prototype.toggle=function(){if(!this._element.classList.contains("ew-dropdown-toggle")){if(this._element.closest("[data-widget]")&&t(this._element).on("click.ew.dropdown",(e=>{bootstrap.Dropdown.clearMenus(e.originalEvent),e.stopPropagation()})),this._menu.closest(".table-responsive")){this._menu.closest(".popover-body, .modal-body, .offcanvas-body, body").appendChild(this._menu);let e=this._menu;function n(t){t.forEach((t=>{if("attributes"===t.type)t.target.classList.contains("show")?e.classList.add("d-block"):e.classList.remove("d-block")}))}this._element.id||(this._element.id="dropdownbtn"+ew.random()),e.setAttribute("aria-labelledby",this._element.id),new MutationObserver(n).observe(this._parent,{attributeFilter:["class"],attributeOldValue:!1,subtree:!1})}this._element.classList.add("ew-dropdown-toggle")}return this._isShown()?this.hide():this.show()},loadjs.ready(["wrapper","head"],(function(){let e=t(".chat-wrapper"),n=e.find("#chat-check"),a=e.find(".chat-btn").addClass("show"),i=a.find(".close"),r=a.find(".comment"),l=e.find(".direct-chat"),o=l.find(".card-header"),s=o.find(".card-collapse"),d=l.find(".card-body"),c=d.find("iframe");n.on("click",(()=>{var e;if(null!=(e=Pace)&&e.running)return;const t=n.prop("checked");i.toggle(t),r.toggle(!t),l.toggle(t);let a=c[0];t&&!a.src&&(a.src=a.dataset.src)})),l.on("removed.lte.cardwidget",(()=>n.prop("checked",!1).triggerHandler("click"))),l.on("maximized.lte.cardwidget",(()=>{e.after(l),s.hide(),l.delay(150).queue((function(){let e=l.height()-o.outerHeight();d.height(e),c.addClass("w-100").height(e-parseInt(l.css("border-radius"),10)),l.dequeue()})),c[0].contentDocument.location.reload(!0)})).on("minimized.lte.cardwidget",(()=>{e.append(l),s.show(),l.toggle(n.prop("checked")),l.queue((function(){d.height("auto"),c.removeClass("w-100").height("auto"),l.dequeue()})),c[0].contentDocument.location.reload(!0)}))}));var Pn=e=>null==e,Nn=e=>"function"==typeof e,Rn=e=>"number"==typeof e&&isNaN(e),Ln=e=>"number"==typeof e&&isFinite(e);var Fn=(e,t)=>{if(!Ln(e))return NaN;const n=""+e,a=n.indexOf("e");return-1===a?+(n+"e"+t):+(n.slice(0,a)+"e"+(+n.slice(a+1)+t))};var kn=e=>Math.round(Math.log(e)*Math.LOG10E);var Dn=(e,t)=>{const n={};for(let a=0;a<e.length;++a)if(a in e){const[i,r]=t(e[a],a);n[i]=r}return n};var Mn=e=>e.replace(/[.*+?^${}()|[\]\\]/g,(e=>`\\${e}`));var jn=e=>{const t={};return function(...n){const a=n.length>1?n.join("-(:-:)-"):n[0];if(a in t)return t[a];const i=e.apply(this,n);return t[a]=i,i}};const $n=(()=>{const e={};let t,n="";for(;t!==1/0;)t=+("1"+n),e[t]=!0,n+="0";for(n="",t=void 0;0!==t;)t=+("0."+n+"1"),e[t]=!0,n+="0";return e})();var Un=e=>!!$n[e];const Bn=(e,t,n)=>{if(!Ln(e)||t===n.base)return e;if(!(t in n.scale))return NaN;const a=n.scale[t]||1;return Un(a)?Fn(e,kn(a)):e*a},Kn=(e,t,n,a)=>{if(!Ln(e)||t===n)return e;const i=Bn(e,t,a),r=Object.assign(Object.assign({},a.scale),{[a.base]:1});if(isNaN(i)||!(t in r)||!(n in r))return NaN;const l=a.scale[n]||1;return Un(l)?Fn(i,-kn(l)):i/l},Vn=e=>({toBase:(t,n)=>Bn(t,n,e),convert:(t,n,a)=>Kn(t,n,a,e),toBest:(t,n,a)=>((e,t,n,a)=>{const i=Object.assign({exclude:[],cutOffNumber:1},a);let r=null;const l=n.scale;return Object.keys(l).sort(((e,t)=>l[e]-l[t])).forEach((a=>{if(-1!==i.exclude.indexOf(a))return;const l=Kn(e,t,a,n),o=Math.abs(l);(!r||o>=i.cutOffNumber&&o<Math.abs(r[0]))&&(r=[l,a])})),r||[e,t]})(t,n,e,a),scaleDefinition:e});var qn=(e,t)=>{if(t<1)return"";let n="",a=e;for(;t>1;)1&t&&(n+=a),t>>>=1,a+=a;return n+a};var Hn=jn((e=>{if(!e)return Vn({base:"",scale:{}});const t=e.split("|"),n={"":1};return t.forEach(((e,t)=>{e&&(n[e]=+(1+qn("0",t)))})),Vn({base:"",scale:n})}));var Gn=(e,t)=>{var n;const a=t.locale,i=e;let r;const l=((e,t)=>{if(!t||10!==t.length)return e;const n=e.length,a=Dn(t,((e,t)=>[e.replace(/\u200e/g,""),""+t]));let i="";for(let t=0;t<n;t++){const n=e[t];i+=a[n]||n}return i})(e,null===(n=t.locale)||void 0===n?void 0:n.numeralSystem);if(t.zeroFormat&&l===t.zeroFormat)r=0;else if(t.nullFormat&&l===t.nullFormat||!l.replace(/[^0-9]+/g,"").length)r=null;else{const e=a.delimiters.decimal,n="."===e?l:l.replace(/\./g,"").replace(e,"."),o=((e,t)=>{var n;const a=Hn(null===(n=t.locale)||void 0===n?void 0:n.abbreviations),i=Object.keys(a.scaleDefinition.scale).sort(((e,t)=>t.length-e.length));let r=1;for(const t of i){const n=Mn(t),i=new RegExp(`[^a-zA-Z](${n})|(${n.replace(/\u200e/g,"")})(?:\\)(?:\\))?)?$`);if(e.match(i)){r=a.toBase(r,t);break}}return r})(i,t),s=(n.split("-").length+Math.min(n.split("(").length-1,n.split(")").length-1))%2?1:-1,d=n.replace(/[^0-9.]+/g,"");r=s*Fn(+d,kn(o))}return r};var Wn={code:"en",delimiters:{thousands:",",decimal:"."},abbreviations:"|||K|||M|||B|||T",ordinal:e=>{const t=e%10;return 1===Math.floor(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"}};function Yn(...e){const t={},n=e.length;for(let a=0;a<n;a++)for(const n in e[a])t[n]=e[a][n];return t}var zn=e=>"object"==typeof e&&null!==e,Jn=e=>"string"==typeof e;var Xn=e=>e<0?Math.ceil(e):Math.floor(e);const Zn=e=>{let t=!1,n="";const a=[];for(let i=0;i<e.length;i++){const r=e.charAt(i);"'"!==r||t?"'"===r&&t&&"\\"!==e.charAt(i-1)?(t=!1,a.push({escaped:!0,value:n})):t?n+=r:a.length&&!a[a.length-1].escaped?a[a.length-1].value+=r:a.push({escaped:!1,value:r}):(t=!0,n="")}return a},Qn=(e,t)=>-1!==ta(e).indexOf(t),ea=(e,t,n)=>Zn(e).map((e=>e.escaped?`'${e.value}'`:e.value.replace(t,(e=>n)))).join(""),ta=e=>Zn(e).filter((e=>!e.escaped)).map((e=>e.value)).join("");var na=(e,t)=>-1!==e.indexOf(t);var aa=e=>{const t=ta(e),n=na(t,"(")&&na(t,")"),a=!n&&na(t,"+");let i=e;return i=ea(i,"(","'ɵnps'"),i=ea(i,")","'ɵnpe'"),i=ea(i,/(-|\+)/,"'ɵs'"),[i,{negativeParentheses:n,forceSign:a}]};var ia=e=>{let t=null,n=!1;if(Qn(e,"a")){n=!0;const a=ta(e).match(/a(k|m|b|t)?/);t=a?a[1]:null}let a=e;return a=ea(a,/a(k|m|b|t)?/,"'ɵa'"),[a,{compact:n,compactUnit:t,compactAuto:n&&!t}]};var ra=(e,t)=>{if(!e)return["",""];const n=e.indexOf(t);return-1===n?[e,""]:[e.slice(0,n),e.slice(n+1)]};const la=(e,t)=>e?e.split("").filter((e=>e===t)).length:0;var oa=e=>{const t=ta(e),n=ra(t,".")[1];let a=0,i=0;if(n){const e=n.trim();if(na(e,"[")){const t=e.replace("]",""),n=ra(t,"[");a=la(n[0],"0"),i=a+la(n[1],"0")}else if(na(e,"#"))a=la(e.split("#")[0],"0"),i=e.length;else if(na(e,"X"))a=la(e.split("X")[0],"0"),i=500;else{const t=la(e.split(" ")[0],"0");a=t,i=t}}return{minimumFractionDigits:a,maximumFractionDigits:i}};var sa=e=>{let t=!1,n=e;return Qn(e,"[.]")&&(t=!0,n=ea(n,"[.]",".")),[n,{optionalFractionDigits:t}]};var da=jn((e=>{const t=Jn(e)&&e||"0,0.##########",[n,a]=aa(t),[i,r]=ia(n),[l,o]=sa(i),s=l,d=ta(s),c=oa(s),u=(e=>{const t=ta(e).split(".")[0].split(",")[0];return/#/g.test(t)?0:(t.match(/0/g)||[]).length})(s),p=d.indexOf(",")>-1,f=(e=>ea(e,/((((0|#)+,)?(0|#)+(\.([0#X]|\[0+\])+)?){1})/,"'ɵn'"))(s),h=(e=>na(e,"'ɵs'")||na(e,"'ɵnps'")?e:e.replace("'ɵn'",(e=>"'ɵs''ɵn'")))(f),g=h;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},a),r),o),c),{grouping:p,minimumIntegerDigits:u,patternMask:g})}));var ca=e=>"-"===e[0]?e.slice(1):e;var ua=(e,t,n,a)=>{const{compact:i,compactAuto:r}=n,{abbreviations:l}=a.locale;if(!i||!r)return[e,t];const o=Hn(l),[s,d]=o.toBest(e,t||"");return[s,d]};var pa=(e,t,n)=>{const{compact:a,compactUnit:i}=t,{abbreviations:r}=n.locale;if(!a)return[e,null];if(i)return((e,t,n)=>{const a={k:3,m:6,b:9,t:12}[e],i=(null==t?void 0:t.split("|"))||[];let r=null;for(let e=0;e<i.length;e++)if(i[a-e]){r=a-e;break}return null===r?[n,null]:[Fn(n,-r),i[r]]})(i,r,e);const l=Hn(r),[o,s]=l.toBest(e,"");return[o,s||null]};var fa=(e,t,n)=>{const a=t||0,i=(n||Math.round)(Fn(e,a));return Fn(i,-a)};var ha=e=>{const t=(e||0).toString();if(!(t.indexOf("e")>=0))return t;const[n,a]=ra(t,"e"),i=+a;return i>=0?(e=>{const[t,n]=ra(e,"e"),a=+n;if(a<0)return e;const[i,r]=ra(t,"."),l=a-r.length;return`${i}${r}${qn("0",l)}`})(t):((e,t,n)=>{const a=Math.abs(t),[i,r]=ra(n,".");let l="-"===i[0]?i.slice(1):i,o=r;for(let e=0;e<a;e+=1){const e=l[0]||"";l=l.slice(0,l.length-1),o=(e||"0")+o}return`${e<0?"-":""}${l||0}.${o}`})(e,i,n)};var ga=(e,t,n,a)=>{const i=ha(e),r=t-(a||0),l=ra(i,".")[1],o=l?Math.min(Math.max(l.length,r),t):r,s=fa(e,o,n);let d=ha(s);return r&&(d=((e,t)=>{const[n,a]=ra(e,".");return`${n}.${a+qn("0",t-a.length)}`})(d,r)),d};var ma=(e,t,n)=>{const{rounding:a}=n,{minimumFractionDigits:i,maximumFractionDigits:r}=t,l=a||Math.round;if(i>0||r>0){return ga(e,r,l,r-i)}return ga(e,0,l)};var wa=(e,t)=>{if(!t||10!==t.length)return e;const n=e.length;let a="";for(let i=0;i<n;i++){const n=e[i];a+=t[n]||n}return a};var va=(e,t)=>{const{minimumIntegerDigits:n}=t;return 0===n&&+e<1&&+e>-1?"":e.length>=n?e:`${qn("0",n-e.length)}${e}`};var ba=(e,t,n,a)=>{const{negativeParentheses:i,forceSign:r}=a;let l=e;return i&&t?l=l.replace(/'ɵ(nps|npe)'/g,(e=>"'ɵnps'"===e?"(":")")):r?l=l.replace("'ɵs'",t?"-":n?"":"+"):t&&(l=l.replace("'ɵs'","-")),l};var ya=(e,t)=>{const{optionalFractionDigits:n}=t,[a,i]=ra(e,".");return n&&0===Number(i)?[a,""]:[a,i]};var _a=(e,t,n)=>{const{delimiters:a,digitGroupingStyle:i}=n.locale,{grouping:r}=t;if(!r||!a.thousands)return e;const l=e,o=a.thousands,s=[...(null==i?void 0:i.length)?i:[3]];let d="",c=1;for(let e=l.length-1;e>=0;e--)c===s[0]&&0!==e?(d=o+l[e]+d,s.length>1&&s.shift(),c=1):(d=l[e]+d,c+=1);return d};var Ea=(e,t,n)=>n?t?e.replace("'ɵa'",(e=>`'${t.replace(/'/g,(e=>"\\'"))}'`)):e.match(/'ɵn'\s*'ɵa'/)?e.replace(/\s*'ɵa'/,""):e.replace(/'ɵa'\s*/,""):e;var Aa=(e,t,n)=>{var a;const i=da(t),r=Ln(e)?e:0,[l,o]=((e,t,n)=>{if(!t.compact)return[ma(e,t,n),null];const[a,i]=pa(e,t,n),r=+ma(a,t,n),[l,o]=ua(+r,i,t,n);return[ma(l,t,n),o]})(r,i,n);if("NaN"===l)return"";const s=n.signedZero?e<0:+l<0,d=n.signedZero?0===e:0==+l,c=ca(l),[u,p]=ya(c,i),f=va(u,i),h=_a(f,i,n),g=n.locale.numeralSystem,m=wa(h,g),w=wa(p,g),v=m+(w?((null===(a=n.locale.delimiters)||void 0===a?void 0:a.decimal)||".")+w:""),b=Ea(i.patternMask,o,i.compact).replace("'ɵn'",(e=>`'${v.replace(/'/g,"\\'")}'`)),y=ba(b,s,d,i).replace(/'ɵ(nps|npe|s|a|n)'/g,"");return Zn(y).map((e=>e.escaped?e.value.replace(/\\'/g,"'"):e.value)).join("")};var Sa={name:"bps",regexps:{format:/BPS/,unformat:/BPS/},format:(e,t,n)=>{const a=Fn(e,4),i=ea(t,/BPS/,"'ɵBPSɵ'");return Aa(a,i,n).replace("ɵBPSɵ","BPS")},unformat:(e,t)=>{const n=Gn(e.replace(/\s?BPS/,""),t);return Ln(n)?Fn(n,-4):n}};var Ta={name:"time",regexps:{format:/([0-9]{1,2}:[0-9]{2}) *$/,unformat:/([0-9]{1,2}:[0-9]{2}) *$/},format:e=>{const t=Math.abs(e),n=e<0?"-":"",a=Xn(t/3600),i=Xn((t-3600*a)/60),r=Xn(t-3600*a-60*i);return`${n}${a}:${(i<10?"0":"")+i}:${(r<10?"0":"")+r}`},unformat:e=>{const t=/^ *-/.test(e),n=e.replace(/^ *-/,"").split(":").reverse();let a=0;return a+=+n[0],a+=60*+n[1],a+=3600*(+n[2]||0),t&&0!==a?-a:a}};const Oa=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],xa=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],Ia=`(${Oa.concat(xa.slice(1)).join("|").replace(/B/g,"B(?!PS)")})`,Ca=Vn({base:"B",scale:Dn(Oa,((e,t)=>[e,Math.pow(1e3,t)]))}),Pa=Vn({base:"B",scale:Dn(xa,((e,t)=>[e,Math.pow(1024,t)]))});const Na={EUR:"€",USD:"$",XCD:"EC$",AUD:"A$",INR:"₹",BRL:"R$",CAD:"CA$",XAF:"FCFA",CNY:"CN¥",NZD:"NZ$",XPF:"CFPF",GBP:"£",HKD:"HK$",ILS:"₪",JPY:"¥",KRW:"₩",XOF:"CFA",MXN:"MX$",TWD:"NT$",VND:"₫"};var Ra=[{name:"percentage",regexps:{format:/%!?/,unformat:/%/},format:(e,t,n)=>{const a=Qn(t,"%!"),i=n.scalePercentage&&!a?Fn(e,2):e,r=ea(t,/%!?/,"'ɵ%ɵ'");return Aa(i,r,n).replace("ɵ%ɵ","%")},unformat:(e,t)=>{const n=Gn(e.replace(/\s?%/,""),t);return n&&t.scalePercentage?Fn(n,-2):n}},{name:"currency",regexps:{format:/(\$)/},format:(e,t,n)=>{var a;const i=null===(a=n.currency)||void 0===a?void 0:a.toUpperCase(),r=Na[i]||i||"",l=ea(t,/\$/,"'ɵcurrencyɵ'");return Aa(e,l,n).replace("ɵcurrencyɵ",(e=>r))}},{name:"ordinal",regexps:{format:/o/},format:(e,t,n)=>{var a,i;const r=(null===(i=(a=n.locale).ordinal)||void 0===i?void 0:i.call(a,e))||"",l=ea(t,/o/,"'ɵordɵ'");return Aa(e,l,n).replace("ɵordɵ",(e=>r))}},Ta,{name:"bytes",regexps:{format:/([0\s]b[bd])|(b[bd][0\s])/,unformat:(e,t)=>"bytes"===t.type&&new RegExp(Ia).test(e)},format:(e,t,n)=>{const a=Qn(t,"bb")?Pa:Ca,[i,r]=a.toBest(e,"B"),l=ea(t,/b[bd]/,"'ɵbytesɵ'");return Aa(i,l,n).replace("ɵbytesɵ",r||"")},unformat:(e,t)=>{var n;const a=Gn(e.replace(new RegExp(Ia),""),t),i=(null===(n=e.match(Ia))||void 0===n?void 0:n[0])||"",r=Pa.scaleDefinition.scale[i]?Pa:Ca;return a?r.toBase(a,i):a}},{name:"exponential",regexps:{format:/[eE][+-][0-9]+/,unformat:/[eE][+-][0-9]+/},format:(e,t,n)=>{const a="number"!=typeof e||Rn(e)?"0e+0":e.toExponential(),i=ra(a,"e"),r=ea(t,/e[+|-]{1}0/i,"");return Aa(+i[0],r,n)+"e"+i[1]},unformat:(e,t)=>{var n;const a=Gn(e.replace(/e[+-]{1}[0-9]{1,3}/i,""),t),i=+((null===(n=e.match(/e([+-]{1}[0-9]{1,3})/i))||void 0===n?void 0:n[1])||"0");return Ln(a)?Fn(a,i):a}},Sa];var La=e=>e>=0?Math.round(e):e%.5==0?Math.floor(e):Math.round(e);var Fa=e=>{var t,n,a;const i=e||{},r=(e=>{switch(e){case"ceil":return Math.ceil;case"floor":return Math.floor;case"truncate":return Xn;case"half-up":return Math.round;case"half-away-from-zero":return La;default:return Nn(e)?e:La}})(i.rounding),l=(e=>{const t=Wn;return zn(e)?Yn(e,{delimiters:(n=e.delimiters,(null==n?void 0:n.decimal)&&Jn(null==n?void 0:n.thousands)&&n.decimal!==n.thousands?e.delimiters:t.delimiters),abbreviations:e.abbreviations||t.abbreviations,ordinal:e.ordinal||t.ordinal}):t;var n})(i.locale),o=(s=i.formatters)?Nn(s)?s(Ra):[...s,...Ra]:Ra;var s;return{defaultPattern:i.defaultPattern||"0,0.##########",nullFormat:i.nullFormat||"",nanFormat:i.nanFormat,zeroFormat:i.zeroFormat,locale:l,rounding:r,type:i.type,scalePercentage:null===(t=i.scalePercentage)||void 0===t||t,trim:null===(n=i.trim)||void 0===n||n,formatters:o,currency:i.currency,signedZero:!!i.signedZero,nonBreakingSpace:null!==(a=i.nonBreakingSpace)&&void 0!==a&&a}};var ka=(e,t)=>{const n=Fa(t);let a;if(Pn(e)||Rn(e))a=null;else if("number"==typeof e)a=0===e?0:e;else if("string"==typeof e)if(n.zeroFormat&&e===n.zeroFormat)a=0;else if(n.nullFormat&&e===n.nullFormat)a=null;else{const t=e.replace(/\u00A0/," "),i=((e,t)=>{for(const n of t.formatters){const a=n.regexps.unformat;if(a&&(Nn(a)?a(e,t):e.match(a)))return n.unformat}})(t,n);a=(i||Gn)(t,n)}else{const t=+e;a=0===t?t:t||null}return a};var Da=(e,t)=>ka(e,t);var Ma=(e,t,n)=>fa(e,t,n);var ja=(e,t,n)=>{var a;try{const a=Jn(e)?parseFloat(e):e,i=Fa(n),r=t||i.defaultPattern;let l;if(a===1/0||a===-1/0)l=a>0?"∞":"-∞";else{if(Rn(a))return Jn(i.nanFormat)?i.nanFormat:Jn(i.nullFormat)?i.nullFormat:"";if(Pn(a))l=Jn(i.nullFormat)?i.nullFormat:"";else if(0===a&&Jn(i.zeroFormat))l=i.zeroFormat;else{const e=a||0,t=((e,t)=>{const n=ta(e);for(const a of t.formatters){const i=a.regexps.format;if(i&&(Nn(i)?i(e,t):n.match(i)))return a.format}})(r,i);l=(t||Aa)(e,r,i)}}return l=Jn(l)?l:"",l=i.nonBreakingSpace?l.replace(/ /g,(e=>" ")):l,l=i.trim?l.trim():l,l}catch(e){return(null===(a=n)||void 0===a?void 0:a._errorFormat)||""}};function $a(e,t,n){const a=Jn(t)?t:null,i=zn(t)?t:zn(n)?n:{};return ja(e,a,i)}$a.withOptions=e=>{const t=Yn(e,{locale:Nn(e.locale)?e.locale():e.locale});return(e,n,a)=>{const i=Jn(n)?n:null,r=zn(n)?n:zn(a)?a:{};return ja(e,i,Yn(t,r))}};var Ua=e=>e?e.filter(((e,t,n)=>n.indexOf(e)===t)):[];const Ba="֑-߿‏‫‮יִ-﷽ﹰ-ﻼ",Ka=new RegExp("^[^"+Ba+"]*?["+Ba+"]"),Va=e=>(e=>Ka.test(e))(e)?e+"‎":e,qa=[],Ha=(e,t,n)=>{try{if("object"!=typeof Intl||!Intl||"function"!=typeof Intl.NumberFormat)return null;const a={notation:"compact",useGrouping:!1,compactDisplay:n},[i,r,l]=t.split("");let o="";for(let t=1;t<50;t++){const s=(+(1+qn("0",t))).toLocaleString(e,a);if(new RegExp(`^${r}[^${i}]+$`).test(s))if("long"===n){const n=(+(2+qn("0",t))).toLocaleString(e,a),i=s.replace(new RegExp(`${r}`,"g"),"").trim(),d=n.replace(new RegExp(`${l}`,"g"),"").trim();o+="|"+Va(i)+":::"+Va(d)}else{const e=s.replace(new RegExp(`${r}`,"g"),"").trim();o+="|"+Va(e)}else o+="|"}let s=o,d=s.length;for(;d--&&"|"===s[d];)s=s.slice(0,-1);return s}catch(e){return null}};var Ga=jn((e=>{const t=e||"en",n=(e=>{try{const t=1234567890..toLocaleString(e,{useGrouping:!1}),n={},a=t.split("").find((e=>{if(n[e])return!0;n[e]=!0})),i=(a?t.replace(new RegExp(Mn(a||""),"g"),""):t).split("");return[i[i.length-1],...i.slice(0,-1)].join("")}catch(e){return null}})(t),a=n||"0123456789",i=((e,t)=>{try{const n=12345678.123.toLocaleString(e).replace(new RegExp(`[${Mn(t)}]`,"g"),""),[a=",",i="."]=Ua(n.split(""));return[a,i]}catch(e){return null}})(t,a),[r,l]=i&&i.length>=2?i:[",","."],o=((e,t)=>{if(qa.some((t=>0===e.indexOf(t))))return[4];try{const n=[];let a=0;1e11.toLocaleString(e).split("").reverse().forEach((e=>{e===t?(n.push(a),a=0):a+=1}));let i=n.length;for(;i--&&n[i]===n[i-1];)n.pop();return n}catch(e){return null}})(t,r),s=Ha(t,a,"short");return{_abbreviationsLong:Ha(t,a,"long")||Wn.abbreviations,code:t,delimiters:{thousands:r,decimal:l},abbreviations:s||Wn.abbreviations,digitGroupingStyle:(null==o?void 0:o.length)?o:void 0,numeralSystem:"0123456789"!==n?null==n?void 0:n.split("").map(Va):void 0,ordinal:Wn.ordinal}}));var Wa={__proto__:null,format:$a,getLocaleFromPlatform:e=>Ga(e),parse:Da,round:Ma};Object.assign(e,Wa)}(ew,jQuery,luxon);
//# sourceMappingURL=ew.min.js.map